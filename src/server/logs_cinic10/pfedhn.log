i9Setting up a new session...
==================== ALGORITHM: pFedHN ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cinic10',                                                      
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'version': 'pfedhn',                                                       
    'embed_dim': -1,                                                           
    'hn_lr': 0.01,                                                             
    'embed_lr': None,                                                          
    'hn_momentum': 0.9,                                                        
    'hn_weight_decay': 0.001,                                                  
    'hidden_dim': 100,                                                         
    'hidden_num': 3,                                                           
    'norm_clip': 50,                                                           
    'dataset_args': {                                                          
        'dataset': 'cinic10',                                                  
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.2523 -> 0.7495   acc: 18.19% -> 70.04%             
client [81] (test)  loss: 1.9360 -> 0.1897   acc: 83.87% -> 92.84%             
client [21] (test)  loss: 2.2213 -> 1.4849   acc: 10.20% -> 37.85%             
client [68] (test)  loss: 2.2909 -> 0.5632   acc: 6.58% -> 77.89%              
client [93] (test)  loss: 2.7743 -> 0.8169   acc: 0.16% -> 67.87%              
client [31] (test)  loss: 2.4920 -> 1.5672   acc: 0.00% -> 48.15%              
client [20] (test)  loss: 2.0727 -> 0.5967   acc: 30.21% -> 78.24%             
client [59] (test)  loss: 2.4405 -> 1.3053   acc: 9.73% -> 49.30%              
client [48] (test)  loss: 2.6481 -> 2.2761   acc: 0.00% -> 48.15%              
client [34] (test)  loss: 2.0454 -> 0.0538   acc: 22.89% -> 99.18%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 8.6392 -> 2.1652   acc: 21.84% -> 36.78%             
client [99] (test)  loss: 12.4157 -> 0.3380   acc: 0.15% -> 89.68%             
client [67] (test)  loss: 1.7371 -> 0.4781   acc: 24.05% -> 84.10%             
client [0] (test)  loss: 4.1448 -> 0.6160   acc: 0.10% -> 77.90%               
client [76] (test)  loss: 2.7318 -> 1.2403   acc: 6.06% -> 53.91%              
client [41] (test)  loss: 11.3830 -> 1.4842   acc: 2.44% -> 31.17%             
client [62] (test)  loss: 188.8525 -> 0.3575   acc: 0.32% -> 87.01%            
client [2] (test)  loss: 14.5766 -> 0.8135   acc: 20.00% -> 96.67%             
client [14] (test)  loss: 3.1721 -> 1.5262   acc: 21.45% -> 43.80%             
client [46] (test)  loss: 2.6037 -> 0.0148   acc: 6.37% -> 99.78%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 2.9235 -> 0.8463   acc: 8.56% -> 54.50%              
client [68] (test)  loss: 1.1794 -> 0.5939   acc: 75.39% -> 78.68%             
client [57] (test)  loss: 2.2503 -> 1.3006   acc: 10.00% -> 50.00%             
client [17] (test)  loss: 2.4628 -> 0.7276   acc: 9.22% -> 83.86%              
client [54] (test)  loss: 1.8357 -> 0.5444   acc: 42.08% -> 81.89%             
client [23] (test)  loss: 48.8930 -> 0.1113   acc: 0.25% -> 97.48%             
client [35] (test)  loss: 2.6925 -> 0.9027   acc: 11.14% -> 68.20%             
client [59] (test)  loss: 2.5857 -> 1.3670   acc: 9.33% -> 45.10%              
client [31] (test)  loss: 2.2232 -> 0.8081   acc: 32.10% -> 70.37%             
client [9] (test)  loss: 3.2715 -> 0.3503   acc: 3.73% -> 84.09%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.9077 -> 0.9777   acc: 18.01% -> 61.96%             
client [33] (test)  loss: 0.6163 -> 0.0008   acc: 85.42% -> 100.00%            
client [16] (test)  loss: 2.5916 -> 1.0337   acc: 8.13% -> 53.66%              
client [44] (test)  loss: 3.8804 -> 1.2411   acc: 65.16% -> 67.64%             
client [8] (test)  loss: 3.3727 -> 0.2271   acc: 0.00% -> 92.48%               
client [31] (test)  loss: 3.1978 -> 0.9114   acc: 1.23% -> 74.07%              
client [47] (test)  loss: 3.2728 -> 0.7268   acc: 2.00% -> 75.83%              
client [36] (test)  loss: 2.0411 -> 1.6404   acc: 20.67% -> 50.00%             
client [20] (test)  loss: 1.9832 -> 0.4540   acc: 26.94% -> 85.17%             
client [56] (test)  loss: 2.1931 -> 0.9266   acc: 2.52% -> 53.71%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 3.4748 -> 0.6244   acc: 0.00% -> 79.40%               
client [60] (test)  loss: 3.3201 -> 0.8650   acc: 13.16% -> 66.93%             
client [28] (test)  loss: 2.5482 -> 0.0002   acc: 42.40% -> 100.00%            
client [25] (test)  loss: 8.5860 -> 0.7670   acc: 0.21% -> 77.21%              
client [58] (test)  loss: 3.4366 -> 1.1399   acc: 14.41% -> 51.28%             
client [44] (test)  loss: 3.0892 -> 1.3025   acc: 55.74% -> 67.70%             
client [39] (test)  loss: 1.7883 -> 0.3966   acc: 28.38% -> 85.33%             
client [29] (test)  loss: 6.3689 -> 0.0246   acc: 0.14% -> 99.78%              
client [3] (test)  loss: 3.3116 -> 0.7481   acc: 4.67% -> 62.23%               
client [84] (test)  loss: 3.7449 -> 0.6191   acc: 4.47% -> 83.80%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.2546 -> 0.5403   acc: 61.48% -> 83.62%             
client [84] (test)  loss: 2.8747 -> 0.5978   acc: 5.08% -> 83.92%              
client [10] (test)  loss: 2.9877 -> 0.5750   acc: 10.50% -> 79.67%             
client [36] (test)  loss: 2.4656 -> 1.0390   acc: 6.10% -> 62.40%              
client [65] (test)  loss: 3.2520 -> 0.0006   acc: 9.65% -> 100.00%             
client [81] (test)  loss: 3.3437 -> 0.1270   acc: 1.86% -> 95.74%              
client [79] (test)  loss: 2.2962 -> 0.6700   acc: 13.62% -> 77.43%             
client [42] (test)  loss: 4.4753 -> 0.7460   acc: 15.30% -> 71.17%             
client [11] (test)  loss: 6.2414 -> 0.2336   acc: 0.27% -> 91.15%              
client [96] (test)  loss: 2.8975 -> 0.7554   acc: 8.81% -> 74.17%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 2.8485 -> 0.2088   acc: 3.52% -> 93.45%               
client [53] (test)  loss: 1.4408 -> 0.2796   acc: 35.17% -> 91.79%             
client [52] (test)  loss: 2.1573 -> 1.4174   acc: 22.25% -> 45.55%             
client [42] (test)  loss: 4.4979 -> 0.6604   acc: 21.71% -> 78.29%             
client [69] (test)  loss: 2.8808 -> 1.2155   acc: 16.09% -> 62.07%             
client [59] (test)  loss: 2.1224 -> 1.2040   acc: 26.98% -> 52.50%             
client [7] (test)  loss: 1.5551 -> 0.0003   acc: 56.71% -> 100.00%             
client [26] (test)  loss: 2.4923 -> 0.6990   acc: 14.13% -> 73.03%             
client [49] (test)  loss: 2.8836 -> 0.8176   acc: 5.92% -> 65.18%              
client [98] (test)  loss: 2.0905 -> 0.6257   acc: 29.44% -> 70.18%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.6742 -> 0.6268   acc: 8.12% -> 70.94%              
client [47] (test)  loss: 3.4995 -> 0.7325   acc: 2.88% -> 74.28%              
client [21] (test)  loss: 1.7512 -> 0.6213   acc: 23.89% -> 78.93%             
client [77] (test)  loss: 1.6521 -> 0.5382   acc: 58.42% -> 78.82%             
client [95] (test)  loss: 2.8335 -> 0.3011   acc: 2.78% -> 93.02%              
client [91] (test)  loss: 1.9955 -> 1.0033   acc: 33.28% -> 63.30%             
client [14] (test)  loss: 2.6522 -> 1.3683   acc: 19.41% -> 51.14%             
client [99] (test)  loss: 2.0277 -> 0.2902   acc: 16.87% -> 90.29%             
client [20] (test)  loss: 2.2132 -> 0.3084   acc: 21.65% -> 88.90%             
client [39] (test)  loss: 1.6576 -> 0.3746   acc: 33.55% -> 85.58%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.6054 -> 1.2575   acc: 43.97% -> 52.30%             
client [62] (test)  loss: 1.7548 -> 0.8745   acc: 18.13% -> 71.23%             
client [71] (test)  loss: 1.5881 -> 1.1218   acc: 46.11% -> 48.54%             
client [97] (test)  loss: 6.3732 -> 0.9296   acc: 2.26% -> 55.81%              
client [30] (test)  loss: 2.6100 -> 0.4816   acc: 19.68% -> 79.92%             
client [88] (test)  loss: 1.3566 -> 0.4688   acc: 39.55% -> 84.03%             
client [60] (test)  loss: 2.3721 -> 0.8321   acc: 21.80% -> 69.57%             
client [82] (test)  loss: 1.1919 -> 1.3694   acc: 59.54% -> 51.18%             
client [91] (test)  loss: 2.2245 -> 0.9442   acc: 41.52% -> 64.93%             
client [57] (test)  loss: 1.9650 -> 0.6541   acc: 45.00% -> 80.00%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.8998 -> 0.7491   acc: 7.41% -> 75.31%              
client [15] (test)  loss: 2.4599 -> 0.4110   acc: 6.91% -> 89.10%              
client [71] (test)  loss: 2.5079 -> 1.1068   acc: 19.34% -> 49.46%             
client [97] (test)  loss: 2.5917 -> 0.9664   acc: 23.55% -> 53.23%             
client [53] (test)  loss: 1.7470 -> 0.2536   acc: 28.46% -> 92.27%             
client [77] (test)  loss: 1.3341 -> 0.5388   acc: 53.50% -> 79.03%             
client [76] (test)  loss: 2.0016 -> 0.8993   acc: 28.91% -> 65.43%             
client [79] (test)  loss: 1.1516 -> 0.6358   acc: 45.34% -> 78.54%             
client [28] (test)  loss: 0.2209 -> 0.0002   acc: 95.95% -> 100.00%            
client [99] (test)  loss: 2.0966 -> 0.2906   acc: 15.33% -> 90.45%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.9029 -> 0.9765   acc: 16.77% -> 54.19%             
client [86] (test)  loss: 3.1142 -> 0.3752   acc: 6.00% -> 90.00%              
client [34] (test)  loss: 0.7711 -> 0.0396   acc: 81.02% -> 99.18%             
client [73] (test)  loss: 1.3159 -> 0.3735   acc: 50.07% -> 87.78%             
client [5] (test)  loss: 3.1998 -> 0.4345   acc: 9.11% -> 85.94%               
client [96] (test)  loss: 2.9428 -> 0.6880   acc: 24.04% -> 75.23%             
client [22] (test)  loss: 1.7575 -> 0.7209   acc: 40.76% -> 77.57%             
client [60] (test)  loss: 2.0321 -> 0.8669   acc: 22.20% -> 68.88%             
client [66] (test)  loss: 2.1955 -> 1.0399   acc: 17.60% -> 53.95%             
client [83] (test)  loss: 0.4936 -> 0.0010   acc: 91.70% -> 100.00%            
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.9843 -> 0.8961   acc: 21.56% -> 65.84%             
client [65] (test)  loss: 2.5182 -> 0.0004   acc: 27.89% -> 100.00%            
client [95] (test)  loss: 4.4074 -> 0.2991   acc: 0.89% -> 93.02%              
client [17] (test)  loss: 3.3183 -> 0.5009   acc: 4.67% -> 85.40%              
client [8] (test)  loss: 4.0163 -> 0.2057   acc: 1.94% -> 93.58%               
client [35] (test)  loss: 2.2500 -> 0.8328   acc: 23.73% -> 69.36%             
client [98] (test)  loss: 2.2584 -> 0.6235   acc: 22.46% -> 70.94%             
client [53] (test)  loss: 2.1562 -> 0.2596   acc: 14.62% -> 92.33%             
client [43] (test)  loss: 2.0021 -> 0.7237   acc: 20.77% -> 73.02%             
client [64] (test)  loss: 2.0234 -> 0.9131   acc: 39.42% -> 65.99%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.3195 -> 0.5228   acc: 64.43% -> 82.15%             
client [88] (test)  loss: 1.3299 -> 0.4696   acc: 61.10% -> 83.75%             
client [38] (test)  loss: 1.3366 -> 0.1921   acc: 41.74% -> 95.16%             
client [3] (test)  loss: 2.1531 -> 0.7172   acc: 17.79% -> 66.84%              
client [5] (test)  loss: 2.5722 -> 0.4593   acc: 13.93% -> 85.35%              
client [41] (test)  loss: 2.7594 -> 1.3014   acc: 4.71% -> 42.05%              
client [7] (test)  loss: 0.5871 -> 0.0003   acc: 80.46% -> 100.00%             
client [37] (test)  loss: 2.3721 -> 0.3143   acc: 24.69% -> 90.38%             
client [45] (test)  loss: 2.1725 -> 0.7200   acc: 26.26% -> 67.88%             
client [47] (test)  loss: 1.8827 -> 0.7833   acc: 20.40% -> 73.84%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.1672 -> 0.8084   acc: 29.27% -> 70.73%             
client [11] (test)  loss: 1.8968 -> 0.2367   acc: 24.35% -> 91.62%             
client [37] (test)  loss: 2.8474 -> 0.3100   acc: 8.37% -> 90.79%              
client [41] (test)  loss: 3.1705 -> 1.2673   acc: 10.39% -> 43.99%             
client [95] (test)  loss: 3.9024 -> 0.2955   acc: 0.41% -> 93.08%              
client [53] (test)  loss: 2.0911 -> 0.2466   acc: 23.49% -> 92.81%             
client [22] (test)  loss: 1.6195 -> 0.6745   acc: 41.47% -> 79.69%             
client [25] (test)  loss: 1.6359 -> 0.6755   acc: 44.42% -> 78.48%             
client [69] (test)  loss: 3.3406 -> 1.2893   acc: 13.79% -> 56.32%             
client [46] (test)  loss: 0.6039 -> 0.0112   acc: 83.20% -> 99.78%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.7895 -> 0.7207   acc: 29.93% -> 75.61%             
client [69] (test)  loss: 2.6322 -> 1.2364   acc: 19.54% -> 58.62%             
client [82] (test)  loss: 1.7564 -> 1.5198   acc: 39.60% -> 49.89%             
client [45] (test)  loss: 2.7354 -> 0.7206   acc: 29.33% -> 68.16%             
client [7] (test)  loss: 0.5123 -> 0.0002   acc: 85.18% -> 100.00%             
client [50] (test)  loss: 3.3174 -> 0.9969   acc: 20.00% -> 60.00%             
client [35] (test)  loss: 3.7634 -> 0.8166   acc: 12.87% -> 69.07%             
client [24] (test)  loss: 1.7592 -> 0.7531   acc: 41.89% -> 61.71%             
client [15] (test)  loss: 2.5487 -> 0.3851   acc: 7.71% -> 89.10%              
client [58] (test)  loss: 1.4562 -> 1.2262   acc: 43.45% -> 53.91%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.7812 -> 1.2382   acc: 7.41% -> 55.56%              
client [76] (test)  loss: 1.5134 -> 0.9064   acc: 44.95% -> 65.90%             
client [67] (test)  loss: 1.1745 -> 0.3996   acc: 60.59% -> 86.20%             
client [37] (test)  loss: 1.9158 -> 0.3035   acc: 33.05% -> 90.38%             
client [58] (test)  loss: 1.2369 -> 1.2379   acc: 52.59% -> 54.45%             
client [64] (test)  loss: 2.2250 -> 0.9081   acc: 34.01% -> 66.25%             
client [77] (test)  loss: 1.2910 -> 0.4862   acc: 63.91% -> 80.46%             
client [55] (test)  loss: 0.7564 -> 0.3317   acc: 79.07% -> 90.10%             
client [12] (test)  loss: 1.3957 -> 0.8565   acc: 54.15% -> 68.40%             
client [89] (test)  loss: 1.2523 -> 0.7310   acc: 53.37% -> 71.89%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.0162 -> 0.5375   acc: 14.63% -> 84.89%             
client [51] (test)  loss: 2.9612 -> 0.1122   acc: 3.65% -> 96.72%              
client [8] (test)  loss: 3.7566 -> 0.2075   acc: 0.61% -> 94.18%               
client [18] (test)  loss: 2.9428 -> 0.0930   acc: 6.95% -> 97.40%              
client [94] (test)  loss: 2.6756 -> 1.0819   acc: 11.65% -> 66.99%             
client [81] (test)  loss: 4.1557 -> 0.1543   acc: 1.81% -> 95.54%              
client [3] (test)  loss: 1.7239 -> 0.7150   acc: 35.87% -> 66.08%              
client [11] (test)  loss: 3.2986 -> 0.1869   acc: 3.06% -> 93.88%              
client [95] (test)  loss: 5.8239 -> 0.2948   acc: 0.89% -> 92.90%              
client [67] (test)  loss: 1.2992 -> 0.4008   acc: 50.16% -> 86.42%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1393 -> 0.4660   acc: 65.37% -> 85.91%             
client [79] (test)  loss: 1.8340 -> 0.6519   acc: 30.04% -> 79.48%             
client [58] (test)  loss: 1.3418 -> 1.2819   acc: 51.28% -> 54.22%             
client [88] (test)  loss: 1.2358 -> 0.4700   acc: 50.32% -> 83.29%             
client [46] (test)  loss: 0.7042 -> 0.0109   acc: 78.78% -> 99.71%             
client [11] (test)  loss: 2.5399 -> 0.1864   acc: 4.92% -> 93.55%              
client [55] (test)  loss: 0.8490 -> 0.3342   acc: 71.03% -> 90.01%             
client [13] (test)  loss: 2.2513 -> 0.4561   acc: 34.41% -> 84.13%             
client [31] (test)  loss: 3.5224 -> 0.7990   acc: 2.47% -> 75.31%              
client [75] (test)  loss: 1.8385 -> 1.1102   acc: 38.78% -> 59.41%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.5413 -> 0.6078   acc: 8.93% -> 75.64%              
client [7] (test)  loss: 0.2181 -> 0.0002   acc: 94.98% -> 100.00%             
client [57] (test)  loss: 2.0881 -> 0.7792   acc: 25.00% -> 80.00%             
client [13] (test)  loss: 2.7751 -> 0.4754   acc: 25.25% -> 83.63%             
client [43] (test)  loss: 1.8866 -> 0.6795   acc: 35.55% -> 75.80%             
client [91] (test)  loss: 1.6165 -> 0.7935   acc: 40.13% -> 70.31%             
client [10] (test)  loss: 1.8936 -> 0.4594   acc: 41.58% -> 84.28%             
client [64] (test)  loss: 2.4224 -> 0.8737   acc: 30.86% -> 68.89%             
client [82] (test)  loss: 1.4473 -> 1.5223   acc: 52.32% -> 51.04%             
client [22] (test)  loss: 1.1954 -> 0.7161   acc: 58.82% -> 78.14%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.1734 -> 0.3590   acc: 64.32% -> 87.54%             
client [23] (test)  loss: 6.1818 -> 0.0915   acc: 1.34% -> 97.82%              
client [88] (test)  loss: 1.0389 -> 0.4816   acc: 68.80% -> 82.92%             
client [98] (test)  loss: 3.2797 -> 0.6244   acc: 10.28% -> 70.81%             
client [79] (test)  loss: 1.8784 -> 0.6484   acc: 26.31% -> 79.66%             
client [21] (test)  loss: 1.1872 -> 0.4699   acc: 64.56% -> 86.17%             
client [92] (test)  loss: 2.4189 -> 0.6157   acc: 29.74% -> 81.64%             
client [56] (test)  loss: 2.3265 -> 0.9622   acc: 23.37% -> 52.57%             
client [5] (test)  loss: 2.4561 -> 0.4430   acc: 13.86% -> 85.74%              
client [52] (test)  loss: 1.4508 -> 0.8730   acc: 48.33% -> 65.89%             
Training... ---------------------------------------- 100% 0:30:20
==================== pFedHN TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '2.1884 -> 0.0000', 'accuracy': '29.39% -> 0.00%'},          
    200: {'loss': '1.9317 -> 0.0000', 'accuracy': '38.96% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedHN achieved 10.0%(13.80%) at epoch: 3                                      
pFedHN achieved 30.0%(33.38%) at epoch: 7                                      
pFedHN achieved 50.0%(53.41%) at epoch: 23                                     
pFedHN achieved 60.0%(60.07%) at epoch: 159                                    
Convergence (test_after):                                                      
pFedHN achieved 70.0%(77.63%) at epoch: 0                                      
pFedHN achieved 80.0%(83.14%) at epoch: 5                                      
pFedHN achieved 90.0%(90.46%) at epoch: 24                                     
