Setting up a new session...
==================== ALGORITHM: FedLC ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'tau': 1.0,                                                                
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 5.2629 -> 4.1486   acc: 0.52% -> 17.18%              
client [81] (test)  loss: 5.1010 -> 4.1572   acc: 2.31% -> 18.33%              
client [21] (test)  loss: 5.2183 -> 4.0620   acc: 1.80% -> 26.20%              
client [68] (test)  loss: 5.4135 -> 4.0881   acc: 0.65% -> 18.86%              
client [93] (test)  loss: 5.3836 -> 3.9973   acc: 0.92% -> 20.96%              
client [31] (test)  loss: 5.4567 -> 3.5049   acc: 1.22% -> 37.11%              
client [20] (test)  loss: 5.0131 -> 3.9654   acc: 6.40% -> 19.03%              
client [59] (test)  loss: 5.2949 -> 3.9838   acc: 0.35% -> 18.49%              
client [48] (test)  loss: 5.2239 -> 3.5785   acc: 3.72% -> 31.29%              
client [34] (test)  loss: 4.9854 -> 4.0565   acc: 1.39% -> 20.19%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 6.0483 -> 4.3757   acc: 0.53% -> 14.89%              
client [99] (test)  loss: 5.1408 -> 3.8582   acc: 2.45% -> 18.00%              
client [67] (test)  loss: 5.2058 -> 3.8608   acc: 0.71% -> 20.11%              
client [0] (test)  loss: 4.8569 -> 4.0751   acc: 4.66% -> 18.82%               
client [76] (test)  loss: 4.8436 -> 3.8844   acc: 2.91% -> 20.55%              
client [41] (test)  loss: 5.2608 -> 4.0839   acc: 1.25% -> 23.13%              
client [62] (test)  loss: 5.1458 -> 4.0550   acc: 1.20% -> 12.65%              
client [2] (test)  loss: 5.1096 -> 3.9267   acc: 1.30% -> 22.17%               
client [14] (test)  loss: 4.9547 -> 3.7215   acc: 0.89% -> 29.18%              
client [46] (test)  loss: 5.1847 -> 4.1338   acc: 1.08% -> 14.95%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.7342 -> 3.6412   acc: 3.01% -> 25.75%              
client [68] (test)  loss: 4.6454 -> 3.5670   acc: 9.59% -> 28.94%              
client [57] (test)  loss: 4.6801 -> 3.6412   acc: 7.45% -> 24.18%              
client [17] (test)  loss: 6.6042 -> 3.4422   acc: 0.32% -> 25.75%              
client [54] (test)  loss: 4.9551 -> 3.5466   acc: 3.24% -> 27.16%              
client [23] (test)  loss: 5.0820 -> 3.4542   acc: 2.48% -> 33.63%              
client [35] (test)  loss: 4.9876 -> 3.8252   acc: 2.61% -> 20.88%              
client [59] (test)  loss: 4.8800 -> 3.5964   acc: 3.52% -> 23.59%              
client [31] (test)  loss: 4.1255 -> 2.9901   acc: 17.07% -> 39.72%             
client [9] (test)  loss: 4.6558 -> 3.9041   acc: 7.27% -> 20.18%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 5.0870 -> 3.2278   acc: 6.44% -> 33.50%              
client [33] (test)  loss: 4.4822 -> 3.7364   acc: 7.50% -> 24.09%              
client [16] (test)  loss: 4.8295 -> 3.7892   acc: 5.46% -> 21.86%              
client [44] (test)  loss: 10.8116 -> 3.4866   acc: 1.61% -> 25.76%             
client [8] (test)  loss: 4.7613 -> 3.3624   acc: 7.31% -> 31.32%               
client [31] (test)  loss: 4.1905 -> 2.9425   acc: 11.15% -> 38.15%             
client [47] (test)  loss: 5.2492 -> 2.8941   acc: 3.25% -> 41.59%              
client [36] (test)  loss: 4.3448 -> 3.3915   acc: 17.75% -> 33.15%             
client [20] (test)  loss: 4.3336 -> 3.5609   acc: 13.15% -> 25.95%             
client [56] (test)  loss: 5.0466 -> 4.0445   acc: 5.87% -> 15.12%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.8113 -> 3.7493   acc: 5.06% -> 22.97%               
client [60] (test)  loss: 5.6647 -> 3.3147   acc: 2.55% -> 28.55%              
client [28] (test)  loss: 4.8163 -> 3.4042   acc: 7.41% -> 28.21%              
client [25] (test)  loss: 6.0830 -> 3.5920   acc: 2.61% -> 25.91%              
client [58] (test)  loss: 4.6751 -> 3.5609   acc: 4.77% -> 24.03%              
client [44] (test)  loss: 4.7253 -> 3.3627   acc: 7.73% -> 27.05%              
client [39] (test)  loss: 4.8407 -> 3.7031   acc: 3.96% -> 23.10%              
client [29] (test)  loss: 4.9613 -> 3.3827   acc: 13.44% -> 28.40%             
client [3] (test)  loss: 4.6960 -> 3.7235   acc: 6.05% -> 22.22%               
client [84] (test)  loss: 4.6177 -> 3.5157   acc: 9.93% -> 28.90%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.1542 -> 3.5380   acc: 6.20% -> 27.00%              
client [84] (test)  loss: 4.3334 -> 3.5005   acc: 13.65% -> 29.79%             
client [10] (test)  loss: 4.7696 -> 3.5265   acc: 8.02% -> 25.37%              
client [36] (test)  loss: 4.1804 -> 3.1574   acc: 12.14% -> 32.97%             
client [65] (test)  loss: 4.2993 -> 3.9332   acc: 9.14% -> 17.92%              
client [81] (test)  loss: 4.6585 -> 3.4643   acc: 8.90% -> 27.22%              
client [79] (test)  loss: 4.8864 -> 3.8231   acc: 3.63% -> 14.74%              
client [42] (test)  loss: 4.1752 -> 3.6139   acc: 10.91% -> 23.79%             
client [11] (test)  loss: 4.4710 -> 3.6503   acc: 6.40% -> 22.32%              
client [96] (test)  loss: 4.9366 -> 3.1634   acc: 6.47% -> 30.04%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.8426 -> 3.3637   acc: 6.04% -> 30.37%               
client [53] (test)  loss: 4.3330 -> 3.3404   acc: 12.79% -> 31.59%             
client [52] (test)  loss: 4.5746 -> 3.7433   acc: 12.23% -> 25.18%             
client [42] (test)  loss: 4.4397 -> 3.7219   acc: 9.30% -> 22.36%              
client [69] (test)  loss: 4.6508 -> 4.1198   acc: 6.65% -> 18.09%              
client [59] (test)  loss: 4.5707 -> 3.5992   acc: 9.51% -> 25.00%              
client [7] (test)  loss: 5.6017 -> 3.6696   acc: 4.85% -> 25.67%               
client [26] (test)  loss: 4.6409 -> 3.5944   acc: 12.48% -> 26.31%             
client [49] (test)  loss: 4.2550 -> 3.6427   acc: 13.11% -> 27.97%             
client [98] (test)  loss: 4.4658 -> 3.5376   acc: 10.96% -> 31.57%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.4794 -> 3.5652   acc: 11.15% -> 30.43%             
client [47] (test)  loss: 5.7890 -> 2.9831   acc: 5.61% -> 37.61%              
client [21] (test)  loss: 4.8082 -> 3.5943   acc: 7.20% -> 25.60%              
client [77] (test)  loss: 4.5170 -> 3.7142   acc: 6.36% -> 22.85%              
client [95] (test)  loss: 4.7192 -> 3.3125   acc: 9.89% -> 33.89%              
client [91] (test)  loss: 4.5519 -> 3.3023   acc: 11.17% -> 31.30%             
client [14] (test)  loss: 4.4744 -> 3.7169   acc: 10.85% -> 26.33%             
client [99] (test)  loss: 4.5142 -> 3.5589   acc: 8.59% -> 25.77%              
client [20] (test)  loss: 4.5421 -> 3.8873   acc: 13.32% -> 21.28%             
client [39] (test)  loss: 4.9791 -> 3.7455   acc: 5.28% -> 24.09%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.4397 -> 3.8099   acc: 15.07% -> 25.35%             
client [62] (test)  loss: 4.7431 -> 3.8757   acc: 9.57% -> 20.51%              
client [71] (test)  loss: 4.3774 -> 3.9751   acc: 10.63% -> 22.95%             
client [97] (test)  loss: 4.5018 -> 3.6360   acc: 9.92% -> 25.95%              
client [30] (test)  loss: 4.1120 -> 3.7805   acc: 13.69% -> 22.04%             
client [88] (test)  loss: 4.9936 -> 3.7653   acc: 8.53% -> 25.26%              
client [60] (test)  loss: 5.0724 -> 3.1702   acc: 8.00% -> 34.00%              
client [82] (test)  loss: 4.6420 -> 3.4963   acc: 8.44% -> 26.30%              
client [91] (test)  loss: 4.7152 -> 3.3054   acc: 12.86% -> 32.99%             
client [57] (test)  loss: 4.5022 -> 3.6549   acc: 13.45% -> 23.27%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 4.0073 -> 3.0184   acc: 14.46% -> 42.68%             
client [15] (test)  loss: 4.6013 -> 3.7468   acc: 12.59% -> 23.43%             
client [71] (test)  loss: 4.4858 -> 4.0821   acc: 13.04% -> 22.46%             
client [97] (test)  loss: 4.5210 -> 3.7580   acc: 10.31% -> 24.24%             
client [53] (test)  loss: 4.7514 -> 3.6985   acc: 10.27% -> 28.29%             
client [77] (test)  loss: 4.9531 -> 3.8937   acc: 6.87% -> 19.24%              
client [76] (test)  loss: 4.5917 -> 3.7701   acc: 10.18% -> 25.64%             
client [79] (test)  loss: 5.1371 -> 4.0825   acc: 6.41% -> 14.53%              
client [28] (test)  loss: 4.4848 -> 3.8354   acc: 13.56% -> 24.05%             
client [99] (test)  loss: 4.8206 -> 3.7425   acc: 7.57% -> 25.15%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 4.6328 -> 3.8385   acc: 11.45% -> 23.28%             
client [86] (test)  loss: 4.7563 -> 3.7229   acc: 10.34% -> 27.30%             
client [34] (test)  loss: 5.1514 -> 3.9779   acc: 9.98% -> 22.97%              
client [73] (test)  loss: 4.8350 -> 3.4792   acc: 10.65% -> 33.23%             
client [5] (test)  loss: 4.9059 -> 3.8470   acc: 9.55% -> 20.90%               
client [96] (test)  loss: 4.6551 -> 3.4485   acc: 12.77% -> 28.60%             
client [22] (test)  loss: 4.7634 -> 3.8278   acc: 10.06% -> 25.44%             
client [60] (test)  loss: 5.1557 -> 3.2971   acc: 7.82% -> 31.27%              
client [66] (test)  loss: 5.5428 -> 3.9931   acc: 4.81% -> 19.96%              
client [83] (test)  loss: 5.0545 -> 4.0533   acc: 8.35% -> 18.60%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.8428 -> 3.9066   acc: 9.82% -> 24.18%              
client [65] (test)  loss: 4.7519 -> 4.3358   acc: 10.22% -> 16.13%             
client [95] (test)  loss: 5.9230 -> 3.5841   acc: 5.68% -> 32.21%              
client [17] (test)  loss: 5.3314 -> 3.4961   acc: 11.37% -> 29.54%             
client [8] (test)  loss: 5.1500 -> 3.5467   acc: 8.90% -> 31.16%               
client [35] (test)  loss: 4.7781 -> 3.9780   acc: 7.83% -> 22.49%              
client [98] (test)  loss: 5.1117 -> 3.7676   acc: 9.45% -> 25.52%              
client [53] (test)  loss: 4.7505 -> 3.8164   acc: 10.47% -> 26.36%             
client [43] (test)  loss: 5.3596 -> 4.0255   acc: 6.07% -> 23.64%              
client [64] (test)  loss: 4.7267 -> 3.6538   acc: 6.11% -> 33.33%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.1024 -> 3.9104   acc: 7.00% -> 24.20%              
client [88] (test)  loss: 5.3446 -> 4.2414   acc: 8.87% -> 24.40%              
client [38] (test)  loss: 4.8876 -> 4.1848   acc: 8.01% -> 21.08%              
client [3] (test)  loss: 5.3818 -> 4.3365   acc: 6.37% -> 18.79%               
client [5] (test)  loss: 5.4637 -> 4.0453   acc: 7.57% -> 20.36%               
client [41] (test)  loss: 5.3025 -> 4.2788   acc: 4.98% -> 19.40%              
client [7] (test)  loss: 5.5008 -> 4.1318   acc: 7.54% -> 21.54%               
client [37] (test)  loss: 5.0621 -> 3.7641   acc: 7.31% -> 23.86%              
client [45] (test)  loss: 5.6369 -> 3.9162   acc: 9.13% -> 21.70%              
client [47] (test)  loss: 6.0240 -> 3.3992   acc: 3.98% -> 30.02%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 5.5599 -> 4.2550   acc: 8.93% -> 20.77%              
client [11] (test)  loss: 4.9660 -> 4.2850   acc: 10.03% -> 22.32%             
client [37] (test)  loss: 5.1805 -> 3.8948   acc: 7.31% -> 24.03%              
client [41] (test)  loss: 5.6709 -> 4.3351   acc: 6.23% -> 17.62%              
client [95] (test)  loss: 6.3201 -> 3.7884   acc: 5.26% -> 31.16%              
client [53] (test)  loss: 5.2288 -> 3.9762   acc: 10.27% -> 25.00%             
client [22] (test)  loss: 4.7532 -> 4.0001   acc: 13.02% -> 23.87%             
client [25] (test)  loss: 5.3720 -> 4.4790   acc: 9.22% -> 20.70%              
client [69] (test)  loss: 5.4236 -> 4.9640   acc: 7.45% -> 16.49%              
client [46] (test)  loss: 4.7035 -> 4.1535   acc: 12.43% -> 22.52%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 5.3212 -> 3.5191   acc: 6.15% -> 30.02%              
client [69] (test)  loss: 5.5885 -> 5.1115   acc: 7.18% -> 14.89%              
client [82] (test)  loss: 4.9135 -> 3.8731   acc: 12.34% -> 26.79%             
client [45] (test)  loss: 5.4586 -> 4.0859   acc: 9.94% -> 21.50%              
client [7] (test)  loss: 5.7518 -> 4.3455   acc: 7.00% -> 21.18%               
client [50] (test)  loss: 5.0381 -> 4.0510   acc: 11.23% -> 23.32%             
client [35] (test)  loss: 4.8726 -> 4.1765   acc: 9.24% -> 20.28%              
client [24] (test)  loss: 5.7725 -> 4.0449   acc: 7.67% -> 24.38%              
client [15] (test)  loss: 5.1788 -> 4.0412   acc: 10.66% -> 25.35%             
client [58] (test)  loss: 5.6959 -> 4.3650   acc: 7.60% -> 21.55%              
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.5438 -> 3.5401   acc: 15.75% -> 34.79%             
client [76] (test)  loss: 5.3246 -> 4.2089   acc: 11.09% -> 25.82%             
client [67] (test)  loss: 5.4262 -> 4.3709   acc: 8.11% -> 19.75%              
client [37] (test)  loss: 5.6970 -> 4.0957   acc: 8.12% -> 23.70%              
client [58] (test)  loss: 5.6172 -> 4.4672   acc: 7.95% -> 21.20%              
client [64] (test)  loss: 5.0733 -> 3.9360   acc: 8.58% -> 29.54%              
client [77] (test)  loss: 5.2990 -> 4.5000   acc: 9.62% -> 17.70%              
client [55] (test)  loss: 5.4599 -> 4.2038   acc: 10.40% -> 22.08%             
client [12] (test)  loss: 5.9280 -> 3.7392   acc: 7.65% -> 32.57%              
client [89] (test)  loss: 5.5324 -> 4.1476   acc: 6.69% -> 24.23%              
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 5.0301 -> 4.4985   acc: 12.59% -> 22.34%             
client [51] (test)  loss: 5.7103 -> 3.7602   acc: 13.45% -> 28.91%             
client [8] (test)  loss: 5.2281 -> 3.8945   acc: 9.06% -> 28.30%               
client [18] (test)  loss: 5.2405 -> 4.8801   acc: 10.55% -> 17.89%             
client [94] (test)  loss: 5.3297 -> 4.0559   acc: 14.57% -> 28.96%             
client [81] (test)  loss: 5.4223 -> 4.0550   acc: 12.81% -> 27.22%             
client [3] (test)  loss: 5.6935 -> 4.5936   acc: 7.68% -> 20.10%               
client [11] (test)  loss: 5.0893 -> 4.6246   acc: 11.94% -> 20.07%             
client [95] (test)  loss: 6.6462 -> 4.1731   acc: 6.53% -> 26.95%              
client [67] (test)  loss: 5.6354 -> 4.5052   acc: 6.88% -> 18.52%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 5.8000 -> 4.0930   acc: 7.40% -> 24.00%              
client [79] (test)  loss: 6.2483 -> 4.8158   acc: 4.91% -> 13.68%              
client [58] (test)  loss: 5.6867 -> 4.7260   acc: 9.89% -> 20.32%              
client [88] (test)  loss: 5.8972 -> 4.6551   acc: 8.70% -> 22.18%              
client [46] (test)  loss: 5.4670 -> 4.4816   acc: 10.99% -> 21.98%             
client [11] (test)  loss: 5.1664 -> 4.7282   acc: 11.07% -> 20.42%             
client [55] (test)  loss: 5.1454 -> 4.4047   acc: 12.96% -> 21.72%             
client [13] (test)  loss: 5.5654 -> 4.5406   acc: 12.63% -> 27.13%             
client [31] (test)  loss: 4.7980 -> 3.3671   acc: 15.33% -> 39.20%             
client [75] (test)  loss: 5.6327 -> 4.2793   acc: 11.13% -> 24.17%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 5.1791 -> 4.7025   acc: 14.03% -> 23.38%             
client [7] (test)  loss: 5.6104 -> 4.6589   acc: 8.98% -> 19.75%               
client [57] (test)  loss: 5.3814 -> 4.4565   acc: 11.64% -> 21.09%             
client [13] (test)  loss: 5.8935 -> 4.6367   acc: 10.58% -> 26.28%             
client [43] (test)  loss: 5.9954 -> 4.7360   acc: 5.27% -> 19.65%              
client [91] (test)  loss: 5.4482 -> 3.7763   acc: 11.84% -> 32.49%             
client [10] (test)  loss: 5.4001 -> 4.2954   acc: 13.25% -> 23.88%             
client [64] (test)  loss: 4.9386 -> 4.2040   acc: 10.89% -> 28.88%             
client [82] (test)  loss: 5.0213 -> 4.1717   acc: 14.61% -> 27.11%             
client [22] (test)  loss: 5.3851 -> 4.3845   acc: 11.44% -> 25.44%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.7671 -> 4.5279   acc: 12.63% -> 20.59%             
client [23] (test)  loss: 6.0210 -> 4.3994   acc: 7.61% -> 24.42%              
client [88] (test)  loss: 6.3355 -> 4.8855   acc: 9.04% -> 22.70%              
client [98] (test)  loss: 5.4625 -> 4.3428   acc: 11.72% -> 28.17%             
client [79] (test)  loss: 6.2868 -> 5.0703   acc: 4.91% -> 14.32%              
client [21] (test)  loss: 6.0506 -> 4.3179   acc: 8.00% -> 21.00%              
client [92] (test)  loss: 5.5876 -> 4.0219   acc: 9.86% -> 27.16%              
client [56] (test)  loss: 6.5871 -> 5.1706   acc: 8.36% -> 15.30%              
client [5] (test)  loss: 6.1030 -> 4.7612   acc: 8.47% -> 15.32%               
client [52] (test)  loss: 5.8140 -> 4.7139   acc: 9.75% -> 24.29%              
Training... ---------------------------------------- 100% 0:25:43
==================== FedLC TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '4.8383 -> 0.0000', 'accuracy': '9.55% -> 0.00%'},           
    200: {'loss': '5.9462 -> 0.0000', 'accuracy': '9.19% -> 0.00%'}            
}                                                                              
Convergence (test_before):                                                     
FedLC achieved 10.0%(10.79%) at epoch: 48                                      
Convergence (test_after):                                                      
FedLC achieved 10.0%(19.19%) at epoch: 0                                       
FedLC achieved 20.0%(21.96%) at epoch: 5                                       
