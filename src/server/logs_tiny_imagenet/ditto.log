Setting up a new session...
==================== ALGORITHM: Ditto ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'tiny_imagenet',                                                
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'pers_epoch': 1,                                                           
    'lamda': 1,                                                                
    'dataset_args': {                                                          
        'dataset': 'tiny_imagenet',                                            
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.6550 -> 4.2155   acc: 7.39% -> 7.39%               
client [81] (test)  loss: 5.0971 -> 4.1781   acc: 19.93% -> 19.93%             
client [21] (test)  loss: 5.2926 -> 5.2495   acc: 0.40% -> 6.40%               
client [68] (test)  loss: 5.2817 -> 5.0970   acc: 0.49% -> 13.82%              
client [93] (test)  loss: 5.2790 -> 5.1803   acc: 0.00% -> 5.33%               
client [31] (test)  loss: 5.2097 -> 4.4213   acc: 18.12% -> 21.78%             
client [20] (test)  loss: 4.8643 -> 4.4919   acc: 8.82% -> 3.63%               
client [59] (test)  loss: 5.3025 -> 5.2445   acc: 0.18% -> 4.58%               
client [48] (test)  loss: 3.8469 -> 3.6351   acc: 27.13% -> 27.57%             
client [34] (test)  loss: 5.2410 -> 5.0431   acc: 13.69% -> 13.46%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.2842 -> 5.2475   acc: 0.27% -> 1.60%               
client [99] (test)  loss: 5.2606 -> 5.1273   acc: 1.43% -> 2.04%               
client [67] (test)  loss: 5.2489 -> 4.7898   acc: 9.35% -> 11.46%              
client [0] (test)  loss: 4.9212 -> 4.1368   acc: 10.57% -> 10.75%              
client [76] (test)  loss: 5.0953 -> 4.4151   acc: 5.27% -> 5.27%               
client [41] (test)  loss: 5.2104 -> 4.8320   acc: 9.25% -> 20.82%              
client [62] (test)  loss: 5.2985 -> 5.2373   acc: 0.17% -> 1.71%               
client [2] (test)  loss: 5.2821 -> 5.2032   acc: 0.87% -> 3.04%                
client [14] (test)  loss: 3.7820 -> 3.5203   acc: 14.41% -> 14.41%             
client [46] (test)  loss: 4.7719 -> 4.2940   acc: 8.65% -> 4.68%               
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.3171 -> 3.8912   acc: 14.79% -> 15.89%             
client [68] (test)  loss: 4.0860 -> 4.0727   acc: 7.80% -> 8.13%               
client [57] (test)  loss: 4.9042 -> 4.5300   acc: 9.64% -> 10.18%              
client [17] (test)  loss: 4.4394 -> 3.6469   acc: 14.38% -> 14.22%             
client [54] (test)  loss: 3.5539 -> 3.4720   acc: 17.44% -> 19.44%             
client [23] (test)  loss: 5.2821 -> 5.2197   acc: 0.18% -> 6.55%               
client [35] (test)  loss: 3.6587 -> 3.5272   acc: 12.05% -> 7.63%              
client [59] (test)  loss: 4.2899 -> 4.0805   acc: 7.57% -> 7.57%               
client [31] (test)  loss: 3.4597 -> 3.2502   acc: 21.78% -> 21.95%             
client [9] (test)  loss: 6.3989 -> 6.3237   acc: 7.09% -> 7.09%                
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 3.6213 -> 3.5464   acc: 16.17% -> 16.34%             
client [33] (test)  loss: 3.7241 -> 3.6109   acc: 11.59% -> 14.32%             
client [16] (test)  loss: 4.3821 -> 4.6588   acc: 6.19% -> 6.19%               
client [44] (test)  loss: 5.2196 -> 4.8045   acc: 3.70% -> 13.37%              
client [8] (test)  loss: 3.2742 -> 3.1772   acc: 24.80% -> 25.60%              
client [31] (test)  loss: 3.1128 -> 3.0294   acc: 24.22% -> 26.83%             
client [47] (test)  loss: 3.8164 -> 3.9164   acc: 25.32% -> 25.32%             
client [36] (test)  loss: 5.2061 -> 4.4804   acc: 3.44% -> 15.58%              
client [20] (test)  loss: 4.8707 -> 4.6960   acc: 3.98% -> 7.09%               
client [56] (test)  loss: 5.1465 -> 4.4789   acc: 9.43% -> 9.43%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.9009 -> 4.9895   acc: 18.99% -> 18.99%              
client [60] (test)  loss: 3.9539 -> 3.5806   acc: 20.55% -> 20.55%             
client [28] (test)  loss: 3.5752 -> 3.4933   acc: 23.33% -> 24.23%             
client [25] (test)  loss: 4.3193 -> 3.9907   acc: 6.78% -> 9.22%               
client [58] (test)  loss: 3.5679 -> 3.4594   acc: 12.37% -> 17.14%             
client [44] (test)  loss: 4.8045 -> 3.9936   acc: 13.37% -> 4.51%              
client [39] (test)  loss: 5.1833 -> 4.9830   acc: 15.84% -> 15.84%             
client [29] (test)  loss: 3.5608 -> 3.4414   acc: 7.82% -> 7.65%               
client [3] (test)  loss: 4.1863 -> 4.1229   acc: 1.80% -> 3.92%                
client [84] (test)  loss: 3.7480 -> 3.6228   acc: 12.41% -> 15.96%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 4.2720 -> 3.8749   acc: 12.40% -> 14.40%             
client [84] (test)  loss: 3.5512 -> 3.6286   acc: 16.84% -> 17.55%             
client [10] (test)  loss: 3.7094 -> 3.6139   acc: 8.21% -> 8.21%               
client [36] (test)  loss: 4.2569 -> 3.6153   acc: 6.88% -> 13.04%              
client [65] (test)  loss: 3.8408 -> 3.8810   acc: 6.27% -> 6.27%               
client [81] (test)  loss: 3.6578 -> 3.5353   acc: 9.07% -> 11.74%              
client [79] (test)  loss: 3.8553 -> 3.7499   acc: 12.39% -> 14.10%             
client [42] (test)  loss: 3.5114 -> 3.4609   acc: 15.38% -> 17.35%             
client [11] (test)  loss: 5.7372 -> 5.6819   acc: 5.36% -> 5.19%               
client [96] (test)  loss: 3.4122 -> 3.3621   acc: 10.79% -> 11.51%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 3.2689 -> 3.4480   acc: 21.46% -> 22.26%              
client [53] (test)  loss: 5.2734 -> 5.2678   acc: 1.55% -> 2.91%               
client [52] (test)  loss: 3.9391 -> 3.9541   acc: 11.35% -> 13.48%             
client [42] (test)  loss: 3.5687 -> 3.5523   acc: 16.46% -> 17.89%             
client [69] (test)  loss: 3.9108 -> 3.8455   acc: 7.45% -> 7.45%               
client [59] (test)  loss: 3.7010 -> 3.5769   acc: 11.62% -> 13.03%             
client [7] (test)  loss: 3.8427 -> 3.8817   acc: 9.34% -> 10.95%               
client [26] (test)  loss: 3.4633 -> 3.3179   acc: 19.56% -> 20.07%             
client [49] (test)  loss: 3.7594 -> 3.6116   acc: 14.16% -> 16.78%             
client [98] (test)  loss: 3.3834 -> 3.2753   acc: 14.18% -> 16.45%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 3.2753 -> 3.3804   acc: 16.45% -> 17.77%             
client [47] (test)  loss: 3.7504 -> 3.1625   acc: 25.32% -> 28.21%             
client [21] (test)  loss: 3.7831 -> 3.6721   acc: 10.80% -> 13.80%             
client [77] (test)  loss: 4.0760 -> 4.1534   acc: 9.62% -> 12.54%              
client [95] (test)  loss: 3.3385 -> 3.1685   acc: 23.79% -> 27.58%             
client [91] (test)  loss: 2.9477 -> 3.0179   acc: 27.41% -> 25.38%             
client [14] (test)  loss: 2.7878 -> 2.6929   acc: 31.49% -> 31.49%             
client [99] (test)  loss: 4.2621 -> 4.0215   acc: 8.38% -> 14.31%              
client [20] (test)  loss: 3.5723 -> 3.3634   acc: 13.32% -> 16.44%             
client [39] (test)  loss: 4.2163 -> 4.1091   acc: 15.51% -> 12.54%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 3.9541 -> 3.9578   acc: 13.48% -> 16.31%             
client [62] (test)  loss: 4.5165 -> 4.2953   acc: 8.38% -> 12.48%              
client [71] (test)  loss: 3.8345 -> 3.7541   acc: 11.11% -> 13.04%             
client [97] (test)  loss: 3.6794 -> 3.7364   acc: 9.35% -> 9.54%               
client [30] (test)  loss: 3.8920 -> 3.8608   acc: 14.62% -> 16.24%             
client [88] (test)  loss: 3.7875 -> 3.6320   acc: 13.65% -> 16.55%             
client [60] (test)  loss: 3.1689 -> 3.5018   acc: 26.55% -> 23.64%             
client [82] (test)  loss: 3.8871 -> 3.6246   acc: 10.06% -> 15.10%             
client [91] (test)  loss: 2.9252 -> 2.9203   acc: 26.57% -> 28.43%             
client [57] (test)  loss: 4.0711 -> 4.0085   acc: 12.36% -> 15.09%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.6790 -> 2.8376   acc: 39.20% -> 36.24%             
client [15] (test)  loss: 3.4384 -> 3.5472   acc: 19.76% -> 19.23%             
client [71] (test)  loss: 3.7541 -> 3.6389   acc: 13.04% -> 15.22%             
client [97] (test)  loss: 3.8262 -> 3.4082   acc: 10.50% -> 19.27%             
client [53] (test)  loss: 3.7842 -> 3.3911   acc: 16.67% -> 23.45%             
client [77] (test)  loss: 4.1534 -> 3.7512   acc: 12.54% -> 12.37%             
client [76] (test)  loss: 3.6550 -> 3.4400   acc: 13.27% -> 19.82%             
client [79] (test)  loss: 3.5825 -> 3.5659   acc: 18.38% -> 17.95%             
client [28] (test)  loss: 3.1843 -> 3.2322   acc: 21.70% -> 23.51%             
client [99] (test)  loss: 4.0169 -> 3.9047   acc: 15.75% -> 16.97%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.2264 -> 3.4837   acc: 23.28% -> 24.05%             
client [86] (test)  loss: 3.1899 -> 3.0928   acc: 31.02% -> 30.69%             
client [34] (test)  loss: 3.6145 -> 4.0972   acc: 13.92% -> 16.01%             
client [73] (test)  loss: 2.7822 -> 2.8348   acc: 32.43% -> 31.96%             
client [5] (test)  loss: 3.2059 -> 3.2685   acc: 21.98% -> 21.62%              
client [96] (test)  loss: 3.1569 -> 2.9556   acc: 20.14% -> 26.08%             
client [22] (test)  loss: 3.1540 -> 3.1968   acc: 26.63% -> 24.85%             
client [60] (test)  loss: 3.1371 -> 7.0173   acc: 29.82% -> 20.55%             
client [66] (test)  loss: 3.2723 -> 3.1675   acc: 21.03% -> 24.42%             
client [83] (test)  loss: 4.0692 -> 3.8537   acc: 9.87% -> 11.95%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 3.3993 -> 4.4735   acc: 24.18% -> 16.18%             
client [65] (test)  loss: 4.2492 -> 3.6878   acc: 8.24% -> 17.56%              
client [95] (test)  loss: 3.0666 -> 5.6768   acc: 35.37% -> 21.26%             
client [17] (test)  loss: 3.1481 -> 3.1281   acc: 22.91% -> 24.33%             
client [8] (test)  loss: 3.0615 -> 2.9290   acc: 28.14% -> 29.25%              
client [35] (test)  loss: 3.3098 -> 2.9023   acc: 22.69% -> 25.30%             
client [98] (test)  loss: 2.8386 -> 3.4797   acc: 32.89% -> 23.63%             
client [53] (test)  loss: 3.2335 -> 3.5937   acc: 25.97% -> 23.06%             
client [43] (test)  loss: 3.3212 -> 4.0776   acc: 18.21% -> 14.06%             
client [64] (test)  loss: 2.9519 -> 2.8639   acc: 29.37% -> 30.86%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 3.5710 -> 3.4951   acc: 15.00% -> 21.20%             
client [88] (test)  loss: 3.5934 -> 3.7325   acc: 23.89% -> 24.40%             
client [38] (test)  loss: 3.2462 -> 3.2654   acc: 20.03% -> 20.56%             
client [3] (test)  loss: 3.9270 -> 3.2658   acc: 20.10% -> 24.18%              
client [5] (test)  loss: 3.5087 -> 3.0727   acc: 21.08% -> 25.95%              
client [41] (test)  loss: 2.8533 -> 3.1283   acc: 29.18% -> 25.98%             
client [7] (test)  loss: 4.2021 -> 4.3743   acc: 10.95% -> 11.49%              
client [37] (test)  loss: 2.9863 -> 3.1728   acc: 23.70% -> 25.49%             
client [45] (test)  loss: 3.4448 -> 3.2718   acc: 15.62% -> 20.89%             
client [47] (test)  loss: 2.7125 -> 2.6044   acc: 36.89% -> 39.42%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.0409 -> 3.1115   acc: 29.51% -> 29.51%             
client [11] (test)  loss: 4.0238 -> 3.4106   acc: 14.53% -> 20.76%             
client [37] (test)  loss: 3.0273 -> 3.1394   acc: 29.06% -> 28.08%             
client [41] (test)  loss: 3.1283 -> 3.4182   acc: 25.98% -> 19.04%             
client [95] (test)  loss: 4.7046 -> 4.6092   acc: 26.11% -> 16.21%             
client [53] (test)  loss: 3.5937 -> 2.9985   acc: 23.06% -> 32.95%             
client [22] (test)  loss: 3.4200 -> 3.2286   acc: 25.25% -> 28.99%             
client [25] (test)  loss: 3.3512 -> 3.4498   acc: 24.17% -> 21.39%             
client [69] (test)  loss: 3.8332 -> 4.1241   acc: 14.89% -> 14.89%             
client [46] (test)  loss: 4.3070 -> 3.2006   acc: 12.97% -> 23.24%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.5104 -> 2.3538   acc: 42.50% -> 44.12%             
client [69] (test)  loss: 4.0678 -> 4.2490   acc: 16.22% -> 15.96%             
client [82] (test)  loss: 3.6592 -> 3.1703   acc: 25.49% -> 31.49%             
client [45] (test)  loss: 3.1661 -> 3.3656   acc: 26.37% -> 25.35%             
client [7] (test)  loss: 4.3743 -> 4.6779   acc: 11.49% -> 12.75%              
client [50] (test)  loss: 3.0216 -> 2.8170   acc: 27.46% -> 30.22%             
client [35] (test)  loss: 2.8455 -> 2.9628   acc: 31.33% -> 31.73%             
client [24] (test)  loss: 3.0464 -> 3.7840   acc: 27.67% -> 23.29%             
client [15] (test)  loss: 3.8120 -> 3.3882   acc: 15.38% -> 21.15%             
client [58] (test)  loss: 3.8683 -> 4.7741   acc: 25.62% -> 16.96%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.7116 -> 2.8822   acc: 38.95% -> 37.42%             
client [76] (test)  loss: 3.2671 -> 3.3234   acc: 28.00% -> 29.64%             
client [67] (test)  loss: 3.2480 -> 3.9775   acc: 20.63% -> 19.75%             
client [37] (test)  loss: 3.3197 -> 3.3577   acc: 27.60% -> 27.76%             
client [58] (test)  loss: 4.2612 -> 4.2103   acc: 22.44% -> 24.20%             
client [64] (test)  loss: 3.0444 -> 3.3698   acc: 34.65% -> 34.32%             
client [77] (test)  loss: 3.7704 -> 2.9686   acc: 15.29% -> 27.66%             
client [55] (test)  loss: 3.4838 -> 3.4323   acc: 23.54% -> 27.19%             
client [12] (test)  loss: 3.1435 -> 2.9994   acc: 27.22% -> 35.17%             
client [89] (test)  loss: 4.0124 -> 8.7636   acc: 25.50% -> 13.38%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.9992 -> 4.2668   acc: 28.01% -> 29.79%             
client [51] (test)  loss: 2.7275 -> 2.8567   acc: 35.27% -> 34.73%             
client [8] (test)  loss: 2.9772 -> 3.2532   acc: 35.29% -> 34.34%              
client [18] (test)  loss: 3.9781 -> 4.6961   acc: 20.57% -> 12.52%             
client [94] (test)  loss: 3.1208 -> 3.1353   acc: 30.42% -> 30.78%             
client [81] (test)  loss: 3.2499 -> 3.5888   acc: 27.40% -> 25.80%             
client [3] (test)  loss: 4.4755 -> 4.0462   acc: 18.63% -> 24.84%              
client [11] (test)  loss: 3.7529 -> 7.0328   acc: 22.84% -> 10.21%             
client [95] (test)  loss: 4.9281 -> 3.5911   acc: 9.26% -> 34.74%              
client [67] (test)  loss: 3.9775 -> 3.4784   acc: 19.75% -> 25.04%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 3.2937 -> 3.7778   acc: 26.00% -> 21.40%             
client [79] (test)  loss: 5.6060 -> 4.3848   acc: 14.53% -> 18.80%             
client [58] (test)  loss: 4.4384 -> 4.8543   acc: 28.62% -> 7.60%              
client [88] (test)  loss: 4.0864 -> 4.1732   acc: 23.38% -> 24.06%             
client [46] (test)  loss: 3.1283 -> 3.7980   acc: 27.39% -> 21.08%             
client [11] (test)  loss: 7.0328 -> 4.7768   acc: 10.21% -> 18.34%             
client [55] (test)  loss: 4.0773 -> 7.4679   acc: 23.54% -> 17.15%             
client [13] (test)  loss: 4.4274 -> 3.8930   acc: 26.62% -> 30.03%             
client [31] (test)  loss: 2.7514 -> 2.9579   acc: 43.38% -> 42.68%             
client [75] (test)  loss: 3.8052 -> 3.9799   acc: 26.43% -> 29.04%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 4.1244 -> 4.0405   acc: 27.34% -> 28.42%             
client [7] (test)  loss: 4.0976 -> 3.9908   acc: 22.44% -> 25.49%              
client [57] (test)  loss: 3.9501 -> 3.8829   acc: 18.55% -> 24.55%             
client [13] (test)  loss: 5.7348 -> 4.1836   acc: 16.04% -> 30.20%             
client [43] (test)  loss: 3.9581 -> 3.6862   acc: 22.68% -> 28.27%             
client [91] (test)  loss: 3.0747 -> 3.5199   acc: 32.99% -> 26.23%             
client [10] (test)  loss: 3.4991 -> 3.5390   acc: 27.61% -> 30.60%             
client [64] (test)  loss: 3.5434 -> 3.6523   acc: 34.82% -> 33.99%             
client [82] (test)  loss: 4.6783 -> 3.9951   acc: 27.27% -> 31.49%             
client [22] (test)  loss: 3.4958 -> 3.4447   acc: 31.95% -> 29.59%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 4.8120 -> 3.5687   acc: 15.74% -> 20.76%             
client [23] (test)  loss: 2.6641 -> 3.0410   acc: 35.22% -> 29.73%             
client [88] (test)  loss: 4.1732 -> 3.7797   acc: 24.06% -> 25.94%             
client [98] (test)  loss: 3.4182 -> 3.3840   acc: 36.67% -> 34.97%             
client [79] (test)  loss: 4.6253 -> 4.9645   acc: 21.37% -> 20.30%             
client [21] (test)  loss: 4.0266 -> 4.0252   acc: 20.80% -> 20.00%             
client [92] (test)  loss: 3.3179 -> 3.4095   acc: 29.76% -> 29.58%             
client [56] (test)  loss: 4.6814 -> 4.9301   acc: 17.62% -> 20.82%             
client [5] (test)  loss: 4.0994 -> 4.8166   acc: 18.20% -> 20.90%              
client [52] (test)  loss: 3.9997 -> 4.7554   acc: 25.89% -> 18.62%             
Training... ---------------------------------------- 100% 0:24:36
==================== Ditto TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '3.5494 -> 0.0000', 'accuracy': '19.45% -> 0.00%'},          
    200: {'loss': '3.9829 -> 0.0000', 'accuracy': '26.79% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Ditto achieved 10.0%(10.14%) at epoch: 16                                      
Ditto achieved 20.0%(22.36%) at epoch: 91                                      
Ditto achieved 30.0%(31.80%) at epoch: 162                                     
Convergence (test_after):                                                      
Ditto achieved 10.0%(13.54%) at epoch: 7                                       
Ditto achieved 20.0%(20.40%) at epoch: 79                                      
Ditto achieved 30.0%(31.02%) at epoch: 143                                     
