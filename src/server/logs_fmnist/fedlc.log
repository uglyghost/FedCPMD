Setting up a new session...
==================== ALGORITHM: FedLC ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'fmnist',                                                       
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'tau': 1.0,                                                                
    'dataset_args': {                                                          
        'dataset': 'fmnist',                                                   
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.9134 -> 1.7571   acc: 49.01% -> 52.68%             
client [81] (test)  loss: 2.1552 -> 1.4294   acc: 6.36% -> 47.27%              
client [21] (test)  loss: 24.0592 -> 0.4443   acc: 54.59% -> 87.68%            
client [68] (test)  loss: 0.7799 -> 0.2744   acc: 90.24% -> 95.12%             
client [93] (test)  loss: 2.1701 -> 1.2824   acc: 3.20% -> 66.40%              
client [31] (test)  loss: 1.4739 -> 0.6562   acc: 48.89% -> 91.67%             
client [20] (test)  loss: 2.1892 -> 1.2190   acc: 0.00% -> 66.67%              
client [59] (test)  loss: 27.8725 -> 0.5741   acc: 23.23% -> 87.10%            
client [48] (test)  loss: 2.6809 -> 0.2502   acc: 0.62% -> 98.75%              
client [34] (test)  loss: 1.2169 -> 0.8285   acc: 73.53% -> 73.53%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.8163 -> 0.2275   acc: 34.67% -> 94.40%             
client [99] (test)  loss: 2.7189 -> 0.2387   acc: 8.81% -> 98.30%              
client [67] (test)  loss: 1.5187 -> 0.6535   acc: 32.14% -> 86.61%             
client [0] (test)  loss: 1.4189 -> 0.7723   acc: 59.81% -> 81.31%              
client [76] (test)  loss: 0.9701 -> 0.6322   acc: 71.05% -> 86.84%             
client [41] (test)  loss: 0.5838 -> 0.3005   acc: 86.53% -> 89.25%             
client [62] (test)  loss: 59.1905 -> 1.1190   acc: 26.19% -> 76.19%            
client [2] (test)  loss: 18.5718 -> 1.1902   acc: 56.96% -> 69.28%             
client [14] (test)  loss: 2.8761 -> 1.6376   acc: 2.82% -> 15.57%              
client [46] (test)  loss: 1.6186 -> 0.4065   acc: 26.87% -> 91.19%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.2251 -> 0.5250   acc: 50.78% -> 82.64%             
client [68] (test)  loss: 1.2896 -> 0.2710   acc: 51.92% -> 94.43%             
client [57] (test)  loss: 0.8993 -> 0.6968   acc: 70.11% -> 78.57%             
client [17] (test)  loss: 2.1664 -> 1.1642   acc: 27.62% -> 57.46%             
client [54] (test)  loss: 1.0104 -> 0.7454   acc: 58.55% -> 70.47%             
client [23] (test)  loss: 24.5606 -> 0.2731   acc: 67.29% -> 94.36%            
client [35] (test)  loss: 1.4726 -> 0.6374   acc: 31.52% -> 79.39%             
client [59] (test)  loss: 1.3038 -> 0.4259   acc: 34.52% -> 88.06%             
client [31] (test)  loss: 0.7589 -> 0.3516   acc: 60.56% -> 88.89%             
client [9] (test)  loss: 0.7035 -> 0.5060   acc: 81.74% -> 87.34%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.5677 -> 0.3619   acc: 84.41% -> 90.00%             
client [33] (test)  loss: 0.4763 -> 0.3179   acc: 81.96% -> 88.13%             
client [16] (test)  loss: 0.9318 -> 0.4067   acc: 51.40% -> 93.36%             
client [44] (test)  loss: 0.8053 -> 0.4100   acc: 75.46% -> 86.45%             
client [8] (test)  loss: 1.2469 -> 1.5113   acc: 59.91% -> 54.05%              
client [31] (test)  loss: 0.4982 -> 0.3604   acc: 87.22% -> 89.44%             
client [47] (test)  loss: 0.6660 -> 0.3663   acc: 74.08% -> 87.50%             
client [36] (test)  loss: 0.3264 -> 0.2222   acc: 92.87% -> 93.61%             
client [20] (test)  loss: 0.7434 -> 0.4082   acc: 77.83% -> 89.67%             
client [56] (test)  loss: 1.0703 -> 0.3969   acc: 66.67% -> 88.21%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3615 -> 0.2339   acc: 88.58% -> 93.77%              
client [60] (test)  loss: 1.3393 -> 0.8391   acc: 36.17% -> 75.63%             
client [28] (test)  loss: 0.6741 -> 0.4418   acc: 81.25% -> 88.39%             
client [25] (test)  loss: 0.6426 -> 0.1575   acc: 84.67% -> 95.47%             
client [58] (test)  loss: 0.5595 -> 0.1326   acc: 84.67% -> 96.17%             
client [44] (test)  loss: 0.6004 -> 0.3720   acc: 81.68% -> 86.45%             
client [39] (test)  loss: 0.2759 -> 0.2289   acc: 94.44% -> 91.67%             
client [29] (test)  loss: 0.8620 -> 0.4798   acc: 76.71% -> 86.30%             
client [3] (test)  loss: 0.5944 -> 0.3167   acc: 74.28% -> 88.95%              
client [84] (test)  loss: 0.7215 -> 0.7102   acc: 73.85% -> 73.85%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 0.7223 -> 0.2862   acc: 69.32% -> 89.86%             
client [84] (test)  loss: 0.9188 -> 0.8543   acc: 57.80% -> 60.55%             
client [10] (test)  loss: 0.9736 -> 0.2367   acc: 76.09% -> 93.48%             
client [36] (test)  loss: 0.2472 -> 0.2087   acc: 94.35% -> 94.72%             
client [65] (test)  loss: 1.2834 -> 0.8356   acc: 36.90% -> 65.48%             
client [81] (test)  loss: 0.6075 -> 0.5232   acc: 83.64% -> 86.36%             
client [79] (test)  loss: 0.9368 -> 1.0580   acc: 68.55% -> 67.08%             
client [42] (test)  loss: 0.7102 -> 0.2386   acc: 75.25% -> 94.77%             
client [11] (test)  loss: 1.1326 -> 0.6446   acc: 61.78% -> 82.22%             
client [96] (test)  loss: 0.5560 -> 0.2795   acc: 83.43% -> 90.73%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.8952 -> 0.8522   acc: 77.93% -> 76.35%              
client [53] (test)  loss: 0.2007 -> 0.0921   acc: 94.34% -> 97.67%             
client [52] (test)  loss: 1.2180 -> 0.7631   acc: 48.06% -> 66.67%             
client [42] (test)  loss: 0.3125 -> 0.1610   acc: 91.14% -> 96.55%             
client [69] (test)  loss: 0.7914 -> 0.1613   acc: 73.07% -> 94.40%             
client [59] (test)  loss: 0.7252 -> 0.2826   acc: 75.81% -> 90.97%             
client [7] (test)  loss: 0.9984 -> 0.4064   acc: 64.83% -> 82.50%              
client [26] (test)  loss: 1.2332 -> 0.4545   acc: 61.37% -> 87.58%             
client [49] (test)  loss: 1.4071 -> 1.3879   acc: 48.41% -> 49.89%             
client [98] (test)  loss: 0.8026 -> 0.9929   acc: 75.00% -> 73.00%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.8298 -> 0.9160   acc: 68.00% -> 71.00%             
client [47] (test)  loss: 0.8306 -> 0.5566   acc: 67.65% -> 76.65%             
client [21] (test)  loss: 0.6325 -> 0.2255   acc: 75.36% -> 91.55%             
client [77] (test)  loss: 0.6395 -> 0.5292   acc: 83.94% -> 85.92%             
client [95] (test)  loss: 0.4416 -> 0.2545   acc: 84.96% -> 90.98%             
client [91] (test)  loss: 1.0008 -> 0.9877   acc: 56.25% -> 59.38%             
client [14] (test)  loss: 1.2522 -> 0.8964   acc: 54.77% -> 67.65%             
client [99] (test)  loss: 1.2377 -> 0.1316   acc: 50.28% -> 98.30%             
client [20] (test)  loss: 0.7305 -> 0.4565   acc: 75.33% -> 86.67%             
client [39] (test)  loss: 0.3641 -> 0.1932   acc: 94.44% -> 94.44%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.2402 -> 0.8929   acc: 48.84% -> 60.47%             
client [62] (test)  loss: 1.1053 -> 0.6270   acc: 66.67% -> 80.95%             
client [71] (test)  loss: 0.2555 -> 0.2146   acc: 90.60% -> 92.95%             
client [97] (test)  loss: 0.3170 -> 0.1435   acc: 90.97% -> 95.89%             
client [30] (test)  loss: 0.2140 -> 0.1616   acc: 92.51% -> 95.51%             
client [88] (test)  loss: 1.0654 -> 0.9834   acc: 58.56% -> 56.35%             
client [60] (test)  loss: 1.7013 -> 1.0364   acc: 41.97% -> 62.28%             
client [82] (test)  loss: 2.3038 -> 0.2674   acc: 20.03% -> 89.58%             
client [91] (test)  loss: 0.9543 -> 0.8234   acc: 62.50% -> 65.62%             
client [57] (test)  loss: 1.5877 -> 1.3392   acc: 33.46% -> 47.93%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.4237 -> 0.3360   acc: 87.78% -> 88.33%             
client [15] (test)  loss: 0.6791 -> 0.3785   acc: 70.91% -> 86.20%             
client [71] (test)  loss: 0.1669 -> 0.1591   acc: 94.58% -> 94.03%             
client [97] (test)  loss: 0.3038 -> 0.1567   acc: 91.63% -> 95.07%             
client [53] (test)  loss: 0.2026 -> 0.1148   acc: 93.93% -> 96.97%             
client [77] (test)  loss: 0.4972 -> 0.2469   acc: 87.04% -> 93.52%             
client [76] (test)  loss: 0.3224 -> 0.2907   acc: 84.21% -> 86.84%             
client [79] (test)  loss: 0.9810 -> 0.6727   acc: 58.48% -> 77.89%             
client [28] (test)  loss: 0.5866 -> 0.4702   acc: 77.68% -> 83.93%             
client [99] (test)  loss: 1.2050 -> 0.1103   acc: 49.72% -> 98.30%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.4300 -> 0.1418   acc: 87.36% -> 95.73%             
client [86] (test)  loss: 0.1362 -> 0.1761   acc: 98.25% -> 94.74%             
client [34] (test)  loss: 0.3442 -> 0.2953   acc: 92.65% -> 92.65%             
client [73] (test)  loss: 1.0905 -> 0.5401   acc: 60.71% -> 81.79%             
client [5] (test)  loss: 0.6797 -> 0.4618   acc: 74.45% -> 84.50%              
client [96] (test)  loss: 0.5413 -> 0.2513   acc: 84.27% -> 93.54%             
client [22] (test)  loss: 1.4134 -> 0.3764   acc: 49.53% -> 88.21%             
client [60] (test)  loss: 1.3904 -> 1.0167   acc: 50.68% -> 65.38%             
client [66] (test)  loss: 1.6757 -> 1.5138   acc: 55.08% -> 60.16%             
client [83] (test)  loss: 0.3060 -> 0.0539   acc: 90.49% -> 98.52%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.2153 -> 0.2219   acc: 94.74% -> 94.74%             
client [65] (test)  loss: 0.8488 -> 0.6179   acc: 65.48% -> 78.57%             
client [95] (test)  loss: 0.3649 -> 0.2179   acc: 86.47% -> 93.98%             
client [17] (test)  loss: 0.7059 -> 0.4682   acc: 78.45% -> 88.12%             
client [8] (test)  loss: 1.2075 -> 1.0983   acc: 67.57% -> 70.50%              
client [35] (test)  loss: 0.9162 -> 0.4163   acc: 69.09% -> 88.48%             
client [98] (test)  loss: 0.8019 -> 1.1623   acc: 74.00% -> 60.00%             
client [53] (test)  loss: 0.1645 -> 0.0857   acc: 94.24% -> 97.88%             
client [43] (test)  loss: 0.7626 -> 0.2624   acc: 74.07% -> 91.11%             
client [64] (test)  loss: 0.3937 -> 0.2583   acc: 88.24% -> 92.06%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.5962 -> 0.2042   acc: 77.05% -> 91.06%             
client [88] (test)  loss: 0.8374 -> 0.8231   acc: 67.96% -> 64.09%             
client [38] (test)  loss: 0.9391 -> 0.8711   acc: 65.45% -> 69.09%             
client [3] (test)  loss: 0.7847 -> 0.5107   acc: 72.46% -> 80.43%              
client [5] (test)  loss: 1.0879 -> 0.6399   acc: 58.52% -> 75.76%              
client [41] (test)  loss: 0.3847 -> 0.2122   acc: 88.99% -> 93.01%             
client [7] (test)  loss: 0.8207 -> 0.4384   acc: 70.35% -> 81.58%              
client [37] (test)  loss: 0.4203 -> 0.2939   acc: 86.60% -> 90.72%             
client [45] (test)  loss: 0.4498 -> 0.5614   acc: 78.21% -> 80.77%             
client [47] (test)  loss: 1.3100 -> 0.6470   acc: 53.12% -> 71.69%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.9893 -> 0.5764   acc: 54.55% -> 73.08%             
client [11] (test)  loss: 1.7647 -> 0.5788   acc: 32.89% -> 80.22%             
client [37] (test)  loss: 0.7408 -> 0.4470   acc: 65.46% -> 83.51%             
client [41] (test)  loss: 0.5160 -> 0.1963   acc: 83.68% -> 93.01%             
client [95] (test)  loss: 0.5240 -> 0.2724   acc: 84.21% -> 89.47%             
client [53] (test)  loss: 0.3686 -> 0.1029   acc: 89.18% -> 97.07%             
client [22] (test)  loss: 1.1962 -> 0.5724   acc: 47.17% -> 73.58%             
client [25] (test)  loss: 0.2634 -> 0.1225   acc: 91.64% -> 95.47%             
client [69] (test)  loss: 0.8396 -> 0.1535   acc: 69.87% -> 93.60%             
client [46] (test)  loss: 0.4781 -> 0.2966   acc: 80.62% -> 91.19%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.8859 -> 0.4964   acc: 65.99% -> 80.33%             
client [69] (test)  loss: 0.9505 -> 0.1538   acc: 68.00% -> 93.60%             
client [82] (test)  loss: 0.7851 -> 0.0914   acc: 67.63% -> 97.76%             
client [45] (test)  loss: 0.4580 -> 0.4289   acc: 87.18% -> 83.33%             
client [7] (test)  loss: 0.6722 -> 0.3864   acc: 77.16% -> 84.16%              
client [50] (test)  loss: 1.2662 -> 1.5590   acc: 52.47% -> 45.07%             
client [35] (test)  loss: 1.0332 -> 0.6532   acc: 63.03% -> 76.36%             
client [24] (test)  loss: 0.6799 -> 0.4829   acc: 74.87% -> 84.46%             
client [15] (test)  loss: 1.1303 -> 0.4905   acc: 54.56% -> 80.89%             
client [58] (test)  loss: 0.3218 -> 0.1071   acc: 88.50% -> 97.08%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.9699 -> 0.2086   acc: 66.88% -> 93.75%             
client [76] (test)  loss: 0.3224 -> 0.2698   acc: 89.47% -> 94.74%             
client [67] (test)  loss: 1.0481 -> 0.7086   acc: 63.24% -> 75.74%             
client [37] (test)  loss: 0.5114 -> 0.3426   acc: 84.54% -> 90.21%             
client [58] (test)  loss: 0.1653 -> 0.1016   acc: 94.53% -> 97.08%             
client [64] (test)  loss: 0.3511 -> 0.3007   acc: 89.12% -> 91.18%             
client [77] (test)  loss: 0.4675 -> 0.4748   acc: 87.32% -> 87.61%             
client [55] (test)  loss: 0.1298 -> 0.0334   acc: 96.27% -> 99.04%             
client [12] (test)  loss: 2.6784 -> 0.8606   acc: 26.79% -> 73.04%             
client [89] (test)  loss: 0.9300 -> 0.4850   acc: 71.43% -> 92.86%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.3697 -> 0.4024   acc: 85.32% -> 85.32%             
client [51] (test)  loss: 0.7363 -> 0.6979   acc: 73.59% -> 72.31%             
client [8] (test)  loss: 1.3075 -> 1.2677   acc: 66.22% -> 64.19%              
client [18] (test)  loss: 0.3526 -> 0.3594   acc: 86.17% -> 85.92%             
client [94] (test)  loss: 0.4534 -> 0.3035   acc: 85.46% -> 89.36%             
client [81] (test)  loss: 0.8274 -> 0.9953   acc: 73.64% -> 62.73%             
client [3] (test)  loss: 0.5399 -> 0.4730   acc: 79.17% -> 81.16%              
client [11] (test)  loss: 1.3560 -> 0.5755   acc: 52.00% -> 80.00%             
client [95] (test)  loss: 0.4563 -> 0.2980   acc: 90.23% -> 89.47%             
client [67] (test)  loss: 0.7858 -> 0.4723   acc: 71.13% -> 84.52%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.6533 -> 0.2150   acc: 75.36% -> 91.30%             
client [79] (test)  loss: 0.9802 -> 0.8353   acc: 64.86% -> 73.22%             
client [58] (test)  loss: 0.1573 -> 0.0984   acc: 95.07% -> 97.26%             
client [88] (test)  loss: 1.0144 -> 0.8108   acc: 62.98% -> 69.06%             
client [46] (test)  loss: 1.0872 -> 0.2909   acc: 57.71% -> 89.87%             
client [11] (test)  loss: 1.3156 -> 0.6263   acc: 55.78% -> 79.11%             
client [55] (test)  loss: 0.0856 -> 0.0328   acc: 97.32% -> 99.04%             
client [13] (test)  loss: 1.3070 -> 1.3037   acc: 61.75% -> 63.93%             
client [31] (test)  loss: 0.4415 -> 0.1969   acc: 84.44% -> 92.22%             
client [75] (test)  loss: 0.9902 -> 1.0689   acc: 68.04% -> 67.31%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.5292 -> 0.3321   acc: 81.89% -> 85.04%             
client [7] (test)  loss: 0.5843 -> 0.3863   acc: 80.29% -> 84.71%              
client [57] (test)  loss: 0.6262 -> 0.5975   acc: 73.31% -> 76.50%             
client [13] (test)  loss: 1.5366 -> 1.3476   acc: 48.63% -> 57.10%             
client [43] (test)  loss: 0.6336 -> 0.3374   acc: 78.52% -> 88.89%             
client [91] (test)  loss: 1.1600 -> 1.0605   acc: 53.12% -> 53.12%             
client [10] (test)  loss: 0.3060 -> 0.2262   acc: 92.75% -> 93.48%             
client [64] (test)  loss: 0.4232 -> 0.3729   acc: 86.18% -> 88.24%             
client [82] (test)  loss: 0.8230 -> 0.1649   acc: 67.47% -> 93.43%             
client [22] (test)  loss: 1.3183 -> 0.3676   acc: 53.77% -> 86.32%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.0934 -> 0.3051   acc: 58.67% -> 90.00%             
client [23] (test)  loss: 0.2814 -> 0.2120   acc: 90.98% -> 92.48%             
client [88] (test)  loss: 1.2566 -> 0.8416   acc: 55.80% -> 70.72%             
client [98] (test)  loss: 1.3651 -> 1.5447   acc: 57.00% -> 52.00%             
client [79] (test)  loss: 1.0284 -> 0.5930   acc: 59.95% -> 79.36%             
client [21] (test)  loss: 0.3394 -> 0.1873   acc: 85.27% -> 92.03%             
client [92] (test)  loss: 0.2163 -> 0.1417   acc: 92.81% -> 95.21%             
client [56] (test)  loss: 0.7588 -> 0.3421   acc: 75.61% -> 90.24%             
client [5] (test)  loss: 0.5519 -> 0.5628   acc: 79.04% -> 79.48%              
client [52] (test)  loss: 0.5895 -> 0.5478   acc: 76.74% -> 78.29%             
Training... ---------------------------------------- 100% 0:08:41
==================== FedLC TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '0.7280 -> 0.0000', 'accuracy': '73.61% -> 0.00%'},          
    200: {'loss': '0.6447 -> 0.0000', 'accuracy': '78.04% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedLC achieved 10.0%(11.19%) at epoch: 0                                       
FedLC achieved 20.0%(22.35%) at epoch: 4                                       
FedLC achieved 30.0%(31.34%) at epoch: 7                                       
FedLC achieved 50.0%(55.74%) at epoch: 10                                      
FedLC achieved 70.0%(70.64%) at epoch: 17                                      
FedLC achieved 80.0%(84.48%) at epoch: 61                                      
Convergence (test_after):                                                      
FedLC achieved 60.0%(68.65%) at epoch: 0                                       
FedLC achieved 70.0%(78.96%) at epoch: 1                                       
FedLC achieved 80.0%(82.10%) at epoch: 2                                       
FedLC achieved 90.0%(92.10%) at epoch: 5                                       
