Setting up a new session...
==================== ALGORITHM: FedLC ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'tau': 1.0,                                                                
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.8204 -> 2.1364   acc: 4.43% -> 12.66%              
client [81] (test)  loss: 3.1007 -> 2.4867   acc: 0.00% -> 0.00%               
client [21] (test)  loss: 2.2977 -> 1.3749   acc: 0.00% -> 49.30%              
client [68] (test)  loss: 2.3467 -> 1.8153   acc: 0.00% -> 5.94%               
client [93] (test)  loss: 1.6804 -> 1.0120   acc: 78.31% -> 77.11%             
client [31] (test)  loss: 2.5944 -> 2.1611   acc: 0.00% -> 0.00%               
client [20] (test)  loss: 1.2866 -> 1.0573   acc: 73.19% -> 70.29%             
client [59] (test)  loss: 2.3248 -> 1.0741   acc: 3.53% -> 54.49%              
client [48] (test)  loss: 2.9469 -> 1.2845   acc: 0.00% -> 21.50%              
client [34] (test)  loss: 1.8193 -> 1.2249   acc: 53.22% -> 69.96%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 1.8227 -> 0.6288   acc: 35.54% -> 88.15%             
client [99] (test)  loss: 2.1623 -> 1.0472   acc: 2.78% -> 73.15%              
client [67] (test)  loss: 2.1582 -> 1.7961   acc: 13.79% -> 75.86%             
client [0] (test)  loss: 2.6479 -> 0.7196   acc: 1.26% -> 81.17%               
client [76] (test)  loss: 1.9694 -> 1.8524   acc: 25.16% -> 20.13%             
client [41] (test)  loss: 2.3543 -> 1.3088   acc: 0.00% -> 40.68%              
client [62] (test)  loss: 2.1583 -> 0.9084   acc: 31.33% -> 73.67%             
client [2] (test)  loss: 2.4593 -> 0.5310   acc: 3.16% -> 85.06%               
client [14] (test)  loss: 1.4194 -> 1.1119   acc: 48.00% -> 63.20%             
client [46] (test)  loss: 2.3961 -> 0.9973   acc: 13.08% -> 69.43%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.1915 -> 0.2853   acc: 34.67% -> 96.33%             
client [68] (test)  loss: 1.4996 -> 0.7630   acc: 37.29% -> 75.58%             
client [57] (test)  loss: 1.8405 -> 1.1273   acc: 17.02% -> 48.94%             
client [17] (test)  loss: 0.6400 -> 0.4526   acc: 92.04% -> 92.04%             
client [54] (test)  loss: 2.4486 -> 1.4507   acc: 5.41% -> 36.17%              
client [23] (test)  loss: 2.5562 -> 1.1120   acc: 25.61% -> 70.73%             
client [35] (test)  loss: 1.2121 -> 0.6051   acc: 66.07% -> 83.93%             
client [59] (test)  loss: 2.1088 -> 0.6521   acc: 15.38% -> 83.33%             
client [31] (test)  loss: 2.2014 -> 1.4500   acc: 9.09% -> 40.26%              
client [9] (test)  loss: 0.8746 -> 0.1139   acc: 75.66% -> 98.36%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.3459 -> 0.7774   acc: 4.92% -> 84.76%              
client [33] (test)  loss: 1.7548 -> 1.5436   acc: 53.37% -> 52.40%             
client [16] (test)  loss: 1.6204 -> 1.5750   acc: 47.06% -> 50.98%             
client [44] (test)  loss: 2.0707 -> 0.4380   acc: 16.53% -> 84.00%             
client [8] (test)  loss: 1.3683 -> 0.7733   acc: 51.68% -> 72.48%              
client [31] (test)  loss: 2.6509 -> 2.1405   acc: 9.09% -> 25.97%              
client [47] (test)  loss: 1.0953 -> 0.6200   acc: 64.33% -> 87.13%             
client [36] (test)  loss: 0.7808 -> 0.3754   acc: 84.77% -> 92.05%             
client [20] (test)  loss: 1.0204 -> 0.3286   acc: 66.67% -> 91.30%             
client [56] (test)  loss: 0.8059 -> 0.7462   acc: 81.40% -> 79.07%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.5887 -> 0.2189   acc: 79.82% -> 95.61%              
client [60] (test)  loss: 1.2795 -> 0.6802   acc: 55.88% -> 78.48%             
client [28] (test)  loss: 2.4503 -> 0.5746   acc: 19.18% -> 83.56%             
client [25] (test)  loss: 0.4251 -> 0.2659   acc: 86.18% -> 89.84%             
client [58] (test)  loss: 0.7561 -> 0.6536   acc: 73.95% -> 75.63%             
client [44] (test)  loss: 1.6918 -> 0.5611   acc: 45.76% -> 82.63%             
client [39] (test)  loss: 1.6732 -> 1.8181   acc: 37.50% -> 39.58%             
client [29] (test)  loss: 1.7016 -> 1.2011   acc: 43.84% -> 54.43%             
client [3] (test)  loss: 1.3914 -> 0.4626   acc: 37.76% -> 89.80%              
client [84] (test)  loss: 2.0709 -> 0.3816   acc: 23.29% -> 90.41%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.4873 -> 0.6913   acc: 37.40% -> 72.64%             
client [84] (test)  loss: 2.3096 -> 0.8529   acc: 16.44% -> 61.64%             
client [10] (test)  loss: 0.9832 -> 0.4153   acc: 66.23% -> 90.91%             
client [36] (test)  loss: 0.3727 -> 0.2010   acc: 92.05% -> 96.69%             
client [65] (test)  loss: 1.8743 -> 1.1236   acc: 15.43% -> 29.69%             
client [81] (test)  loss: 3.1075 -> 1.3916   acc: 7.41% -> 16.67%              
client [79] (test)  loss: 1.6886 -> 0.6328   acc: 35.37% -> 83.54%             
client [42] (test)  loss: 1.0391 -> 0.3865   acc: 63.71% -> 87.26%             
client [11] (test)  loss: 1.3579 -> 0.7340   acc: 55.82% -> 71.04%             
client [96] (test)  loss: 3.9248 -> 2.1263   acc: 17.39% -> 48.49%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.9460 -> 0.5178   acc: 71.14% -> 80.54%              
client [53] (test)  loss: 0.4384 -> 0.1398   acc: 83.33% -> 95.87%             
client [52] (test)  loss: 2.2581 -> 0.3764   acc: 29.35% -> 90.22%             
client [42] (test)  loss: 1.6360 -> 0.3426   acc: 48.26% -> 90.35%             
client [69] (test)  loss: 0.6555 -> 0.4839   acc: 79.92% -> 85.54%             
client [59] (test)  loss: 2.6224 -> 0.8425   acc: 19.55% -> 68.91%             
client [7] (test)  loss: 0.8984 -> 0.2108   acc: 62.97% -> 93.83%              
client [26] (test)  loss: 0.6135 -> 0.3169   acc: 79.37% -> 86.51%             
client [49] (test)  loss: 1.7757 -> 1.6038   acc: 43.18% -> 24.43%             
client [98] (test)  loss: 1.0832 -> 0.3094   acc: 62.05% -> 88.87%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.5897 -> 0.3380   acc: 82.60% -> 87.02%             
client [47] (test)  loss: 1.3763 -> 0.6793   acc: 59.65% -> 81.29%             
client [21] (test)  loss: 0.8534 -> 0.5431   acc: 71.56% -> 82.07%             
client [77] (test)  loss: 2.0471 -> 0.9970   acc: 33.54% -> 61.39%             
client [95] (test)  loss: 2.0475 -> 0.6179   acc: 28.17% -> 74.88%             
client [91] (test)  loss: 2.3919 -> 0.7025   acc: 11.15% -> 69.43%             
client [14] (test)  loss: 0.6381 -> 0.6252   acc: 76.80% -> 76.80%             
client [99] (test)  loss: 2.0074 -> 0.6936   acc: 25.00% -> 75.93%             
client [20] (test)  loss: 1.1577 -> 0.2024   acc: 61.59% -> 94.20%             
client [39] (test)  loss: 2.3396 -> 1.5040   acc: 39.58% -> 43.75%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.9723 -> 0.4398   acc: 31.25% -> 86.96%             
client [62] (test)  loss: 1.1567 -> 0.5029   acc: 54.67% -> 83.33%             
client [71] (test)  loss: 1.1976 -> 0.8330   acc: 60.22% -> 72.27%             
client [97] (test)  loss: 3.3088 -> 0.7506   acc: 25.71% -> 75.00%             
client [30] (test)  loss: 0.4786 -> 0.4295   acc: 87.50% -> 85.23%             
client [88] (test)  loss: 0.9716 -> 0.3614   acc: 70.62% -> 91.53%             
client [60] (test)  loss: 1.4333 -> 0.4343   acc: 49.85% -> 85.60%             
client [82] (test)  loss: 2.6930 -> 0.8624   acc: 16.79% -> 74.45%             
client [91] (test)  loss: 2.2173 -> 0.6646   acc: 21.97% -> 68.79%             
client [57] (test)  loss: 0.9003 -> 0.6523   acc: 64.89% -> 81.91%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.1162 -> 1.8434   acc: 29.87% -> 45.45%             
client [15] (test)  loss: 1.2604 -> 0.4943   acc: 64.36% -> 84.49%             
client [71] (test)  loss: 0.6111 -> 0.5990   acc: 81.23% -> 78.99%             
client [97] (test)  loss: 4.6310 -> 0.7325   acc: 15.71% -> 76.43%             
client [53] (test)  loss: 3.2346 -> 0.3069   acc: 3.98% -> 88.84%              
client [77] (test)  loss: 2.5934 -> 1.0858   acc: 32.91% -> 64.56%             
client [76] (test)  loss: 1.6027 -> 0.7638   acc: 47.80% -> 74.21%             
client [79] (test)  loss: 1.8112 -> 0.5102   acc: 48.17% -> 87.80%             
client [28] (test)  loss: 2.6278 -> 0.3254   acc: 31.28% -> 91.55%             
client [99] (test)  loss: 2.5745 -> 1.1152   acc: 22.22% -> 62.04%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.4198 -> 0.6827   acc: 35.71% -> 80.00%             
client [86] (test)  loss: 0.6843 -> 0.5269   acc: 77.69% -> 84.30%             
client [34] (test)  loss: 1.0309 -> 0.4855   acc: 64.81% -> 83.69%             
client [73] (test)  loss: 2.1288 -> 0.7032   acc: 33.63% -> 72.12%             
client [5] (test)  loss: 1.9400 -> 0.5511   acc: 21.11% -> 81.41%              
client [96] (test)  loss: 5.3650 -> 2.3127   acc: 13.71% -> 48.16%             
client [22] (test)  loss: 1.1757 -> 0.1221   acc: 60.87% -> 97.10%             
client [60] (test)  loss: 1.7863 -> 0.4079   acc: 44.89% -> 85.91%             
client [66] (test)  loss: 2.4520 -> 0.8158   acc: 25.51% -> 65.17%             
client [83] (test)  loss: 2.9034 -> 2.5550   acc: 0.16% -> 0.31%               
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.1346 -> 0.6042   acc: 62.26% -> 78.62%             
client [65] (test)  loss: 2.4945 -> 1.6826   acc: 17.19% -> 18.75%             
client [95] (test)  loss: 1.4179 -> 0.6407   acc: 56.10% -> 78.64%             
client [17] (test)  loss: 1.1551 -> 0.2422   acc: 56.93% -> 94.10%             
client [8] (test)  loss: 1.1399 -> 0.5326   acc: 67.79% -> 80.54%              
client [35] (test)  loss: 0.9185 -> 0.4798   acc: 73.21% -> 83.93%             
client [98] (test)  loss: 0.8946 -> 0.6073   acc: 65.91% -> 76.32%             
client [53] (test)  loss: 0.8273 -> 0.3236   acc: 72.32% -> 88.84%             
client [43] (test)  loss: 2.0109 -> 0.5601   acc: 51.09% -> 80.35%             
client [64] (test)  loss: 3.3358 -> 1.7280   acc: 4.76% -> 11.59%              
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8172 -> 0.4684   acc: 67.39% -> 84.39%             
client [88] (test)  loss: 0.8465 -> 0.3837   acc: 76.84% -> 90.40%             
client [38] (test)  loss: 0.6644 -> 0.2900   acc: 73.27% -> 93.07%             
client [3] (test)  loss: 1.3355 -> 0.3100   acc: 63.27% -> 90.82%              
client [5] (test)  loss: 1.6746 -> 0.5270   acc: 27.64% -> 81.91%              
client [41] (test)  loss: 2.3285 -> 0.5065   acc: 20.34% -> 81.36%             
client [7] (test)  loss: 2.1642 -> 0.3047   acc: 36.39% -> 89.08%              
client [37] (test)  loss: 0.3638 -> 0.1669   acc: 91.40% -> 96.19%             
client [45] (test)  loss: 2.3819 -> 1.7778   acc: 38.30% -> 51.37%             
client [47] (test)  loss: 0.8687 -> 0.6215   acc: 76.61% -> 86.55%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.6195 -> 0.7605   acc: 78.43% -> 84.31%             
client [11] (test)  loss: 1.0204 -> 0.5023   acc: 63.88% -> 81.49%             
client [37] (test)  loss: 0.3514 -> 0.1644   acc: 92.52% -> 96.47%             
client [41] (test)  loss: 1.7913 -> 0.5761   acc: 33.90% -> 79.66%             
client [95] (test)  loss: 1.2664 -> 0.6430   acc: 57.98% -> 78.17%             
client [53] (test)  loss: 1.5567 -> 0.1841   acc: 53.36% -> 93.88%             
client [22] (test)  loss: 1.5481 -> 0.1168   acc: 55.07% -> 97.10%             
client [25] (test)  loss: 1.1209 -> 0.1591   acc: 68.29% -> 95.12%             
client [69] (test)  loss: 1.3343 -> 0.3851   acc: 54.22% -> 89.16%             
client [46] (test)  loss: 1.7562 -> 1.0534   acc: 45.93% -> 67.56%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9484 -> 0.6174   acc: 76.02% -> 86.55%             
client [69] (test)  loss: 0.5769 -> 0.3424   acc: 83.13% -> 90.76%             
client [82] (test)  loss: 3.1921 -> 0.5443   acc: 22.63% -> 81.75%             
client [45] (test)  loss: 2.6625 -> 2.0212   acc: 35.26% -> 49.24%             
client [7] (test)  loss: 1.0959 -> 0.1992   acc: 64.56% -> 93.83%              
client [50] (test)  loss: 3.1991 -> 0.7691   acc: 26.80% -> 75.16%             
client [35] (test)  loss: 0.9327 -> 0.3542   acc: 69.64% -> 89.29%             
client [24] (test)  loss: 0.4008 -> 0.2726   acc: 86.00% -> 91.00%             
client [15] (test)  loss: 0.9321 -> 0.2901   acc: 72.94% -> 91.42%             
client [58] (test)  loss: 0.7526 -> 0.5322   acc: 74.79% -> 77.31%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.9389 -> 0.1424   acc: 65.87% -> 97.27%             
client [76] (test)  loss: 0.8854 -> 0.4778   acc: 72.33% -> 86.16%             
client [67] (test)  loss: 0.5203 -> 0.1262   acc: 82.76% -> 100.00%            
client [37] (test)  loss: 0.4532 -> 0.1654   acc: 86.88% -> 96.19%             
client [58] (test)  loss: 1.3319 -> 0.6530   acc: 68.07% -> 76.47%             
client [64] (test)  loss: 2.1336 -> 0.9775   acc: 19.84% -> 64.13%             
client [77] (test)  loss: 1.3037 -> 0.7145   acc: 44.94% -> 72.15%             
client [55] (test)  loss: 1.2878 -> 0.4162   acc: 57.93% -> 88.15%             
client [12] (test)  loss: 1.9353 -> 0.6445   acc: 48.24% -> 72.94%             
client [89] (test)  loss: 1.0195 -> 0.1822   acc: 60.74% -> 96.13%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 3.9714 -> 1.0118   acc: 4.11% -> 57.53%              
client [51] (test)  loss: 1.4926 -> 0.9099   acc: 42.04% -> 52.87%             
client [8] (test)  loss: 0.6025 -> 0.4231   acc: 85.23% -> 87.25%              
client [18] (test)  loss: 0.6328 -> 0.3667   acc: 79.34% -> 87.79%             
client [94] (test)  loss: 2.9639 -> 0.7870   acc: 34.96% -> 73.17%             
client [81] (test)  loss: 3.5247 -> 1.4230   acc: 16.67% -> 37.96%             
client [3] (test)  loss: 0.4478 -> 0.2777   acc: 83.67% -> 91.84%              
client [11] (test)  loss: 1.0894 -> 0.4896   acc: 71.04% -> 82.99%             
client [95] (test)  loss: 1.5281 -> 0.5414   acc: 48.59% -> 80.05%             
client [67] (test)  loss: 0.4178 -> 0.1577   acc: 89.66% -> 93.10%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.1873 -> 0.8709   acc: 57.03% -> 65.53%             
client [79] (test)  loss: 1.1705 -> 0.5967   acc: 58.54% -> 82.93%             
client [58] (test)  loss: 1.0484 -> 0.7213   acc: 70.59% -> 75.63%             
client [88] (test)  loss: 1.7436 -> 0.6509   acc: 54.80% -> 79.10%             
client [46] (test)  loss: 3.1153 -> 1.3380   acc: 28.30% -> 61.68%             
client [11] (test)  loss: 1.2578 -> 0.5752   acc: 62.09% -> 80.90%             
client [55] (test)  loss: 0.6844 -> 0.3898   acc: 75.91% -> 88.53%             
client [13] (test)  loss: 2.4246 -> 0.2209   acc: 50.37% -> 92.59%             
client [31] (test)  loss: 1.6621 -> 1.4545   acc: 50.65% -> 55.84%             
client [75] (test)  loss: 2.2289 -> 0.5828   acc: 52.83% -> 77.36%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 2.8080 -> 2.9860   acc: 46.68% -> 46.68%             
client [7] (test)  loss: 0.3053 -> 0.2539   acc: 89.40% -> 89.87%              
client [57] (test)  loss: 1.4769 -> 0.7421   acc: 57.45% -> 75.53%             
client [13] (test)  loss: 0.5383 -> 0.2196   acc: 81.48% -> 92.59%             
client [43] (test)  loss: 2.0898 -> 0.6180   acc: 52.40% -> 79.91%             
client [91] (test)  loss: 1.4931 -> 0.4622   acc: 48.09% -> 79.62%             
client [10] (test)  loss: 0.8806 -> 0.3493   acc: 70.13% -> 84.42%             
client [64] (test)  loss: 1.8090 -> 0.8575   acc: 22.54% -> 70.48%             
client [82] (test)  loss: 1.7136 -> 0.5483   acc: 35.04% -> 82.48%             
client [22] (test)  loss: 0.4014 -> 0.1216   acc: 87.68% -> 97.83%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.9572 -> 0.0763   acc: 69.57% -> 97.83%             
client [23] (test)  loss: 1.8830 -> 1.4381   acc: 45.73% -> 62.80%             
client [88] (test)  loss: 1.3865 -> 0.3839   acc: 64.97% -> 90.96%             
client [98] (test)  loss: 0.6249 -> 0.3464   acc: 76.46% -> 87.87%             
client [79] (test)  loss: 1.0394 -> 0.4829   acc: 63.41% -> 85.98%             
client [21] (test)  loss: 0.8002 -> 0.4687   acc: 70.32% -> 83.15%             
client [92] (test)  loss: 0.9539 -> 1.1607   acc: 61.90% -> 80.95%             
client [56] (test)  loss: 0.3729 -> 0.4180   acc: 86.05% -> 86.05%             
client [5] (test)  loss: 1.9424 -> 0.5209   acc: 32.66% -> 82.41%              
client [52] (test)  loss: 2.3311 -> 0.3202   acc: 28.26% -> 89.40%             
Training... ---------------------------------------- 100% 0:07:15
==================== FedLC TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '1.9295 -> 0.0000', 'accuracy': '47.29% -> 0.00%'},          
    200: {'loss': '1.3433 -> 0.0000', 'accuracy': '60.03% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedLC achieved 10.0%(11.13%) at epoch: 2                                       
FedLC achieved 30.0%(39.37%) at epoch: 5                                       
FedLC achieved 40.0%(40.31%) at epoch: 24                                      
FedLC achieved 50.0%(51.68%) at epoch: 25                                      
FedLC achieved 60.0%(62.98%) at epoch: 33                                      
FedLC achieved 70.0%(75.54%) at epoch: 81                                      
Convergence (test_after):                                                      
FedLC achieved 70.0%(75.68%) at epoch: 0                                       
FedLC achieved 80.0%(83.90%) at epoch: 24                                      
FedLC achieved 90.0%(90.22%) at epoch: 56                                      
