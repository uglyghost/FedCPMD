Setting up a new session...
==================== ALGORITHM: Ditto ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistA',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'pers_epoch': 1,                                                           
    'lamda': 1,                                                                
    'dataset_args': {                                                          
        'dataset': 'medmnistA',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.3627 -> 2.3249   acc: 4.43% -> 36.71%              
client [81] (test)  loss: 2.3618 -> 2.3015   acc: 7.41% -> 78.70%              
client [21] (test)  loss: 2.3864 -> 2.1683   acc: 1.70% -> 64.76%              
client [68] (test)  loss: 2.2869 -> 2.0990   acc: 33.99% -> 68.32%             
client [93] (test)  loss: 2.3576 -> 2.3104   acc: 0.00% -> 8.43%               
client [31] (test)  loss: 2.2614 -> 2.2167   acc: 84.42% -> 84.42%             
client [20] (test)  loss: 2.2848 -> 2.2040   acc: 73.19% -> 73.19%             
client [59] (test)  loss: 2.2957 -> 2.1429   acc: 80.77% -> 82.05%             
client [48] (test)  loss: 1.3122 -> 0.7400   acc: 79.86% -> 79.86%             
client [34] (test)  loss: 2.3198 -> 2.2343   acc: 52.79% -> 56.22%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 0.1244 -> 0.1082   acc: 97.39% -> 97.39%             
client [99] (test)  loss: 2.3031 -> 2.2601   acc: 65.74% -> 65.74%             
client [67] (test)  loss: 2.3754 -> 2.3645   acc: 0.00% -> 0.00%               
client [0] (test)  loss: 0.4352 -> 0.4042   acc: 87.45% -> 87.45%              
client [76] (test)  loss: 2.2284 -> 2.0730   acc: 45.28% -> 50.94%             
client [41] (test)  loss: 2.3357 -> 2.2966   acc: 5.08% -> 47.46%              
client [62] (test)  loss: 2.3280 -> 2.2125   acc: 59.33% -> 59.67%             
client [2] (test)  loss: 2.3642 -> 1.2877   acc: 1.27% -> 83.92%               
client [14] (test)  loss: 2.2450 -> 2.1806   acc: 76.00% -> 64.80%             
client [46] (test)  loss: 0.7535 -> 0.6922   acc: 77.44% -> 77.44%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.2885 -> 0.7851   acc: 83.67% -> 88.67%             
client [68] (test)  loss: 0.8734 -> 0.8505   acc: 72.28% -> 75.58%             
client [57] (test)  loss: 2.2189 -> 2.1685   acc: 79.79% -> 79.79%             
client [17] (test)  loss: 1.1186 -> 0.7964   acc: 87.02% -> 87.02%             
client [54] (test)  loss: 0.2584 -> 0.2395   acc: 95.01% -> 95.01%             
client [23] (test)  loss: 2.4432 -> 2.4120   acc: 0.00% -> 0.00%               
client [35] (test)  loss: 2.2477 -> 2.1772   acc: 51.79% -> 51.79%             
client [59] (test)  loss: 0.9310 -> 0.6409   acc: 82.05% -> 82.05%             
client [31] (test)  loss: 1.9476 -> 1.8129   acc: 84.42% -> 84.42%             
client [9] (test)  loss: 0.0676 -> 0.0634   acc: 99.26% -> 99.26%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 0.2796 -> 0.2671   acc: 94.13% -> 94.13%             
client [33] (test)  loss: 1.2149 -> 1.1336   acc: 59.13% -> 60.58%             
client [16] (test)  loss: 2.3082 -> 2.2733   acc: 27.45% -> 68.63%             
client [44] (test)  loss: 0.7285 -> 0.3812   acc: 90.47% -> 90.47%             
client [8] (test)  loss: 1.1068 -> 1.0791   acc: 73.15% -> 73.15%              
client [31] (test)  loss: 1.6027 -> 1.2752   acc: 84.42% -> 84.42%             
client [47] (test)  loss: 2.1993 -> 2.0611   acc: 58.48% -> 58.48%             
client [36] (test)  loss: 2.2834 -> 2.1099   acc: 50.33% -> 56.29%             
client [20] (test)  loss: 1.2267 -> 1.0375   acc: 73.19% -> 73.19%             
client [56] (test)  loss: 2.3074 -> 2.2669   acc: 55.81% -> 60.47%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.3031 -> 0.2661   acc: 92.11% -> 92.11%              
client [60] (test)  loss: 0.4733 -> 0.3534   acc: 89.16% -> 89.94%             
client [28] (test)  loss: 0.4787 -> 0.4679   acc: 90.64% -> 90.64%             
client [25] (test)  loss: 1.6004 -> 0.8462   acc: 82.11% -> 82.11%             
client [58] (test)  loss: 2.0481 -> 1.9103   acc: 29.41% -> 29.41%             
client [44] (test)  loss: 0.3812 -> 0.2964   acc: 90.47% -> 90.47%             
client [39] (test)  loss: 2.3838 -> 2.3670   acc: 8.33% -> 22.92%              
client [29] (test)  loss: 0.9399 -> 0.9365   acc: 66.75% -> 64.04%             
client [3] (test)  loss: 2.2202 -> 2.1459   acc: 71.43% -> 68.37%              
client [84] (test)  loss: 0.1642 -> 0.1547   acc: 97.26% -> 97.26%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.1188 -> 0.9301   acc: 64.76% -> 65.69%             
client [84] (test)  loss: 0.1483 -> 0.1441   acc: 97.26% -> 97.26%             
client [10] (test)  loss: 1.9597 -> 1.7150   acc: 79.22% -> 75.32%             
client [36] (test)  loss: 1.2259 -> 1.0173   acc: 59.60% -> 66.89%             
client [65] (test)  loss: 0.5673 -> 0.5041   acc: 81.05% -> 83.20%             
client [81] (test)  loss: 1.6258 -> 1.2119   acc: 82.41% -> 82.41%             
client [79] (test)  loss: 1.3544 -> 1.1212   acc: 73.78% -> 73.78%             
client [42] (test)  loss: 1.1953 -> 1.1595   acc: 60.62% -> 60.62%             
client [11] (test)  loss: 1.2974 -> 1.1862   acc: 58.21% -> 58.21%             
client [96] (test)  loss: 0.9718 -> 0.8177   acc: 80.60% -> 80.60%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.0091 -> 0.9759   acc: 73.15% -> 73.15%              
client [53] (test)  loss: 0.0307 -> 0.0273   acc: 99.54% -> 99.54%             
client [52] (test)  loss: 0.4895 -> 0.4703   acc: 85.05% -> 86.41%             
client [42] (test)  loss: 1.1170 -> 1.0438   acc: 60.62% -> 60.62%             
client [69] (test)  loss: 0.0584 -> 0.0514   acc: 97.59% -> 97.99%             
client [59] (test)  loss: 0.4648 -> 0.4430   acc: 82.05% -> 82.05%             
client [7] (test)  loss: 0.1948 -> 0.1705   acc: 92.72% -> 94.15%              
client [26] (test)  loss: 1.5225 -> 0.9262   acc: 90.48% -> 90.48%             
client [49] (test)  loss: 0.4450 -> 0.3943   acc: 93.18% -> 93.18%             
client [98] (test)  loss: 0.5342 -> 0.4741   acc: 76.18% -> 81.17%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.4741 -> 0.4126   acc: 81.17% -> 84.17%             
client [47] (test)  loss: 1.8157 -> 1.4927   acc: 58.48% -> 58.48%             
client [21] (test)  loss: 0.8635 -> 0.8299   acc: 67.23% -> 67.08%             
client [77] (test)  loss: 1.6236 -> 1.5945   acc: 47.47% -> 47.47%             
client [95] (test)  loss: 0.3771 -> 0.3720   acc: 85.68% -> 88.97%             
client [91] (test)  loss: 0.2659 -> 0.2469   acc: 92.04% -> 92.68%             
client [14] (test)  loss: 1.3224 -> 1.1284   acc: 52.80% -> 59.20%             
client [99] (test)  loss: 1.9009 -> 1.6646   acc: 65.74% -> 65.74%             
client [20] (test)  loss: 0.6913 -> 0.6233   acc: 73.19% -> 73.19%             
client [39] (test)  loss: 2.3272 -> 2.3010   acc: 35.42% -> 35.42%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 0.4703 -> 0.4555   acc: 86.41% -> 90.49%             
client [62] (test)  loss: 0.7279 -> 0.7111   acc: 65.00% -> 66.00%             
client [71] (test)  loss: 0.4124 -> 0.3618   acc: 84.03% -> 84.03%             
client [97] (test)  loss: 2.0804 -> 1.9046   acc: 48.57% -> 48.57%             
client [30] (test)  loss: 1.3149 -> 1.2757   acc: 53.41% -> 57.95%             
client [88] (test)  loss: 1.8047 -> 1.5943   acc: 30.51% -> 31.07%             
client [60] (test)  loss: 0.1639 -> 0.1477   acc: 95.51% -> 95.98%             
client [82] (test)  loss: 1.2029 -> 1.1061   acc: 69.34% -> 69.34%             
client [91] (test)  loss: 0.2295 -> 0.2161   acc: 94.27% -> 94.27%             
client [57] (test)  loss: 1.9037 -> 1.7291   acc: 79.79% -> 79.79%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6694 -> 0.6591   acc: 84.42% -> 84.42%             
client [15] (test)  loss: 0.8561 -> 0.7984   acc: 71.29% -> 69.97%             
client [71] (test)  loss: 0.3618 -> 0.3173   acc: 84.03% -> 84.31%             
client [97] (test)  loss: 1.4278 -> 1.3157   acc: 48.57% -> 48.57%             
client [53] (test)  loss: 0.0226 -> 0.0218   acc: 99.54% -> 99.54%             
client [77] (test)  loss: 1.5945 -> 1.5662   acc: 47.47% -> 47.47%             
client [76] (test)  loss: 0.9098 -> 0.8315   acc: 73.58% -> 68.55%             
client [79] (test)  loss: 1.0325 -> 0.9892   acc: 73.78% -> 73.78%             
client [28] (test)  loss: 0.4082 -> 0.3970   acc: 90.64% -> 90.64%             
client [99] (test)  loss: 1.3626 -> 1.1580   acc: 65.74% -> 65.74%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.2534 -> 1.2020   acc: 50.71% -> 54.29%             
client [86] (test)  loss: 1.1447 -> 1.1000   acc: 63.64% -> 63.64%             
client [34] (test)  loss: 0.4420 -> 0.4010   acc: 82.83% -> 84.98%             
client [73] (test)  loss: 0.3367 -> 0.3107   acc: 92.04% -> 92.48%             
client [5] (test)  loss: 0.8805 -> 0.8611   acc: 74.87% -> 76.88%              
client [96] (test)  loss: 0.5104 -> 0.4730   acc: 89.63% -> 90.97%             
client [22] (test)  loss: 0.9439 -> 0.8473   acc: 68.84% -> 69.57%             
client [60] (test)  loss: 0.1253 -> 0.1184   acc: 96.59% -> 96.59%             
client [66] (test)  loss: 0.0329 -> 0.0296   acc: 99.25% -> 99.32%             
client [83] (test)  loss: 0.0109 -> 0.0114   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6597 -> 0.6936   acc: 76.10% -> 72.96%             
client [65] (test)  loss: 0.3881 -> 0.3439   acc: 86.13% -> 88.48%             
client [95] (test)  loss: 0.3239 -> 0.3190   acc: 90.85% -> 90.85%             
client [17] (test)  loss: 0.4530 -> 0.3822   acc: 87.02% -> 87.02%             
client [8] (test)  loss: 0.8818 -> 0.8538   acc: 73.15% -> 73.15%              
client [35] (test)  loss: 1.3026 -> 1.2929   acc: 51.79% -> 51.79%             
client [98] (test)  loss: 0.3263 -> 0.2967   acc: 88.59% -> 89.44%             
client [53] (test)  loss: 0.0208 -> 0.0193   acc: 99.54% -> 99.54%             
client [43] (test)  loss: 1.5436 -> 1.4992   acc: 59.39% -> 56.77%             
client [64] (test)  loss: 0.2142 -> 0.2048   acc: 94.13% -> 94.13%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 0.8016 -> 0.8024   acc: 66.92% -> 68.62%             
client [88] (test)  loss: 0.8495 -> 0.7430   acc: 85.31% -> 85.88%             
client [38] (test)  loss: 0.8685 -> 0.8089   acc: 71.78% -> 73.27%             
client [3] (test)  loss: 0.5280 -> 0.4731   acc: 86.73% -> 87.76%              
client [5] (test)  loss: 0.8450 -> 0.8287   acc: 76.38% -> 77.39%              
client [41] (test)  loss: 1.1842 -> 0.8020   acc: 98.31% -> 98.31%             
client [7] (test)  loss: 0.1277 -> 0.1133   acc: 97.47% -> 97.94%              
client [37] (test)  loss: 0.4943 -> 0.4764   acc: 84.91% -> 85.05%             
client [45] (test)  loss: 0.5186 -> 0.4840   acc: 67.48% -> 68.09%             
client [47] (test)  loss: 1.2148 -> 1.1317   acc: 58.48% -> 58.48%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.2892 -> 1.2933   acc: 68.63% -> 68.63%             
client [11] (test)  loss: 0.5788 -> 0.5186   acc: 70.45% -> 74.63%             
client [37] (test)  loss: 0.4252 -> 0.4062   acc: 86.60% -> 87.17%             
client [41] (test)  loss: 0.8020 -> 0.4988   acc: 98.31% -> 98.31%             
client [95] (test)  loss: 0.2736 -> 0.2738   acc: 91.31% -> 91.31%             
client [53] (test)  loss: 0.0193 -> 0.0184   acc: 99.54% -> 99.69%             
client [22] (test)  loss: 0.7792 -> 0.7261   acc: 71.74% -> 73.91%             
client [25] (test)  loss: 0.3601 -> 0.3208   acc: 89.84% -> 90.24%             
client [69] (test)  loss: 0.0242 -> 0.0232   acc: 99.60% -> 99.60%             
client [46] (test)  loss: 0.2371 -> 0.2185   acc: 93.59% -> 93.72%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.9712 -> 0.9384   acc: 62.57% -> 62.57%             
client [69] (test)  loss: 0.0209 -> 0.0201   acc: 99.80% -> 99.80%             
client [82] (test)  loss: 0.8740 -> 0.8397   acc: 71.53% -> 72.26%             
client [45] (test)  loss: 0.4378 -> 0.4160   acc: 74.77% -> 76.29%             
client [7] (test)  loss: 0.1133 -> 0.0982   acc: 97.94% -> 99.21%              
client [50] (test)  loss: 1.6397 -> 1.4442   acc: 60.78% -> 60.78%             
client [35] (test)  loss: 1.2728 -> 1.2621   acc: 51.79% -> 51.79%             
client [24] (test)  loss: 0.2157 -> 0.2012   acc: 92.33% -> 93.00%             
client [15] (test)  loss: 0.6520 -> 0.6259   acc: 81.52% -> 83.17%             
client [58] (test)  loss: 0.9036 -> 0.8697   acc: 79.83% -> 81.51%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.2695 -> 0.2549   acc: 92.49% -> 92.83%             
client [76] (test)  loss: 0.5590 -> 0.5423   acc: 81.13% -> 80.50%             
client [67] (test)  loss: 2.1692 -> 2.1316   acc: 48.28% -> 48.28%             
client [37] (test)  loss: 0.3980 -> 0.3554   acc: 87.31% -> 88.01%             
client [58] (test)  loss: 0.8377 -> 0.8063   acc: 82.35% -> 84.87%             
client [64] (test)  loss: 0.1853 -> 0.1821   acc: 94.29% -> 94.29%             
client [77] (test)  loss: 1.4710 -> 1.4483   acc: 47.47% -> 47.47%             
client [55] (test)  loss: 0.1269 -> 0.1207   acc: 96.94% -> 96.94%             
client [12] (test)  loss: 1.4001 -> 1.3553   acc: 43.53% -> 45.88%             
client [89] (test)  loss: 0.1422 -> 0.1376   acc: 95.94% -> 96.32%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.0952 -> 0.0920   acc: 97.26% -> 98.63%             
client [51] (test)  loss: 0.3152 -> 0.2990   acc: 91.40% -> 91.72%             
client [8] (test)  loss: 0.6965 -> 0.6713   acc: 73.83% -> 75.17%              
client [18] (test)  loss: 0.8274 -> 0.7827   acc: 66.20% -> 69.01%             
client [94] (test)  loss: 1.1646 -> 1.0968   acc: 61.79% -> 71.54%             
client [81] (test)  loss: 0.7868 -> 0.7697   acc: 82.41% -> 82.41%             
client [3] (test)  loss: 0.2985 -> 0.2844   acc: 93.88% -> 93.88%              
client [11] (test)  loss: 0.3910 -> 0.3645   acc: 86.57% -> 87.76%             
client [95] (test)  loss: 0.2425 -> 0.2408   acc: 91.78% -> 91.31%             
client [67] (test)  loss: 2.1316 -> 2.0877   acc: 48.28% -> 48.28%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 0.7339 -> 0.6741   acc: 72.02% -> 74.34%             
client [79] (test)  loss: 0.7240 -> 0.7088   acc: 77.44% -> 77.44%             
client [58] (test)  loss: 0.7141 -> 0.6818   acc: 84.87% -> 84.87%             
client [88] (test)  loss: 0.5178 -> 0.4662   acc: 90.40% -> 90.40%             
client [46] (test)  loss: 0.1888 -> 0.1829   acc: 94.26% -> 94.39%             
client [11] (test)  loss: 0.3645 -> 0.3427   acc: 87.76% -> 88.96%             
client [55] (test)  loss: 0.1014 -> 0.0991   acc: 97.13% -> 97.13%             
client [13] (test)  loss: 0.6306 -> 0.5870   acc: 82.22% -> 82.96%             
client [31] (test)  loss: 0.6352 -> 0.6311   acc: 84.42% -> 84.42%             
client [75] (test)  loss: 1.4972 -> 1.4434   acc: 33.96% -> 35.85%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.1477 -> 0.1429   acc: 96.36% -> 96.36%             
client [7] (test)  loss: 0.0607 -> 0.0577   acc: 99.68% -> 99.68%              
client [57] (test)  loss: 0.6415 -> 0.6265   acc: 87.23% -> 87.23%             
client [13] (test)  loss: 0.5641 -> 0.5528   acc: 82.96% -> 83.70%             
client [43] (test)  loss: 1.2081 -> 1.1589   acc: 55.46% -> 57.64%             
client [91] (test)  loss: 0.1757 -> 0.1648   acc: 95.22% -> 95.54%             
client [10] (test)  loss: 0.3543 -> 0.3481   acc: 87.01% -> 87.01%             
client [64] (test)  loss: 0.1580 -> 0.1556   acc: 94.92% -> 95.08%             
client [82] (test)  loss: 0.6727 -> 0.6504   acc: 78.10% -> 79.56%             
client [22] (test)  loss: 0.5619 -> 0.5383   acc: 81.88% -> 82.61%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.2908 -> 0.2696   acc: 91.30% -> 92.03%             
client [23] (test)  loss: 1.2844 -> 1.2377   acc: 73.17% -> 74.39%             
client [88] (test)  loss: 0.4662 -> 0.4206   acc: 90.40% -> 90.40%             
client [98] (test)  loss: 0.2005 -> 0.1961   acc: 93.30% -> 93.72%             
client [79] (test)  loss: 0.6723 -> 0.6542   acc: 78.66% -> 79.27%             
client [21] (test)  loss: 0.5982 -> 0.5587   acc: 77.43% -> 79.13%             
client [92] (test)  loss: 2.2222 -> 2.1999   acc: 33.33% -> 33.33%             
client [56] (test)  loss: 1.0722 -> 1.0495   acc: 62.79% -> 62.79%             
client [5] (test)  loss: 0.7119 -> 0.6953   acc: 76.88% -> 76.88%              
client [52] (test)  loss: 0.1995 -> 0.1893   acc: 94.29% -> 94.57%             
Training... ---------------------------------------- 100% 0:07:25
==================== Ditto TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '0.5113 -> 0.0000', 'accuracy': '84.57% -> 0.00%'},          
    200: {'loss': '0.3010 -> 0.0000', 'accuracy': '90.46% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Ditto achieved 20.0%(21.34%) at epoch: 1                                       
Ditto achieved 40.0%(45.77%) at epoch: 3                                       
Ditto achieved 50.0%(51.62%) at epoch: 7                                       
Ditto achieved 60.0%(62.87%) at epoch: 16                                      
Ditto achieved 70.0%(72.22%) at epoch: 22                                      
Ditto achieved 80.0%(82.73%) at epoch: 24                                      
Ditto achieved 90.0%(90.38%) at epoch: 63                                      
Convergence (test_after):                                                      
Ditto achieved 50.0%(53.70%) at epoch: 0                                       
Ditto achieved 70.0%(73.95%) at epoch: 1                                       
Ditto achieved 80.0%(85.99%) at epoch: 2                                       
Ditto achieved 90.0%(90.59%) at epoch: 63                                      
