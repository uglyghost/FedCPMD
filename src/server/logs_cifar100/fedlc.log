Setting up a new session...
==================== ALGORITHM: FedLC ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'cifar100',                                                     
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'tau': 1.0,                                                                
    'dataset_args': {                                                          
        'dataset': 'cifar100',                                                 
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'super_class': False,                                                  
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
Files already downloaded and verified
Files already downloaded and verified
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 4.7562 -> 3.1835   acc: 0.00% -> 34.48%              
client [81] (test)  loss: 4.5336 -> 3.4236   acc: 1.27% -> 33.86%              
client [21] (test)  loss: 27.5778 -> 3.3246   acc: 15.27% -> 28.53%            
client [68] (test)  loss: 4.7103 -> 3.7374   acc: 0.00% -> 23.00%              
client [93] (test)  loss: 4.6228 -> 3.6636   acc: 0.00% -> 23.81%              
client [31] (test)  loss: 4.6240 -> 3.5651   acc: 0.00% -> 28.94%              
client [20] (test)  loss: 4.8879 -> 3.6710   acc: 0.00% -> 44.74%              
client [59] (test)  loss: 37.9367 -> 3.2784   acc: 0.00% -> 38.06%             
client [48] (test)  loss: 4.6463 -> 4.1338   acc: 0.00% -> 12.42%              
client [34] (test)  loss: 4.6731 -> 3.9071   acc: 0.00% -> 0.00%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 4.3865 -> 3.0479   acc: 3.68% -> 33.71%              
client [99] (test)  loss: 4.6165 -> 3.3132   acc: 0.96% -> 18.47%              
client [67] (test)  loss: 4.4194 -> 3.2320   acc: 1.88% -> 30.09%              
client [0] (test)  loss: 4.4559 -> 3.4724   acc: 0.90% -> 27.93%               
client [76] (test)  loss: 4.9388 -> 3.4075   acc: 0.00% -> 27.24%              
client [41] (test)  loss: 4.7342 -> 3.4296   acc: 0.00% -> 19.67%              
client [62] (test)  loss: 122.3276 -> 3.3054   acc: 0.00% -> 31.15%            
client [2] (test)  loss: 104.0985 -> 3.2872   acc: 3.08% -> 27.69%             
client [14] (test)  loss: 4.3575 -> 3.5710   acc: 0.00% -> 22.94%              
client [46] (test)  loss: 4.5094 -> 2.8469   acc: 4.00% -> 37.60%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 4.2484 -> 3.2047   acc: 0.76% -> 27.38%              
client [68] (test)  loss: 5.0604 -> 3.0400   acc: 2.56% -> 40.58%              
client [57] (test)  loss: 4.3631 -> 3.2525   acc: 2.31% -> 35.64%              
client [17] (test)  loss: 4.7396 -> 3.1924   acc: 0.63% -> 27.30%              
client [54] (test)  loss: 3.6497 -> 3.1973   acc: 32.34% -> 30.98%             
client [23] (test)  loss: 237.7873 -> 3.1731   acc: 2.73% -> 27.73%            
client [35] (test)  loss: 4.9095 -> 2.9394   acc: 0.33% -> 46.00%              
client [59] (test)  loss: 4.3439 -> 2.8040   acc: 6.77% -> 44.52%              
client [31] (test)  loss: 4.0734 -> 3.1500   acc: 3.86% -> 35.37%              
client [9] (test)  loss: 4.6335 -> 3.1216   acc: 0.91% -> 23.87%               
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 4.3113 -> 2.7940   acc: 9.80% -> 41.18%              
client [33] (test)  loss: 4.1399 -> 2.8374   acc: 11.57% -> 39.18%             
client [16] (test)  loss: 4.1841 -> 3.0907   acc: 10.14% -> 28.17%             
client [44] (test)  loss: 4.8053 -> 3.3012   acc: 1.96% -> 19.61%              
client [8] (test)  loss: 4.2273 -> 2.8415   acc: 4.17% -> 41.03%               
client [31] (test)  loss: 4.2719 -> 3.0221   acc: 4.18% -> 35.69%              
client [47] (test)  loss: 3.8521 -> 3.0946   acc: 4.14% -> 32.71%              
client [36] (test)  loss: 4.4738 -> 3.6762   acc: 4.17% -> 21.53%              
client [20] (test)  loss: 4.0958 -> 3.7470   acc: 5.59% -> 26.64%              
client [56] (test)  loss: 4.4849 -> 3.2787   acc: 0.50% -> 33.17%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 4.6603 -> 3.0030   acc: 5.10% -> 34.71%               
client [60] (test)  loss: 4.4929 -> 3.2960   acc: 8.33% -> 25.64%              
client [28] (test)  loss: 4.9602 -> 3.2445   acc: 2.09% -> 31.71%              
client [25] (test)  loss: 5.5863 -> 2.7194   acc: 4.64% -> 40.93%              
client [58] (test)  loss: 4.3546 -> 3.5377   acc: 3.80% -> 15.82%              
client [44] (test)  loss: 5.3882 -> 3.3768   acc: 0.98% -> 18.95%              
client [39] (test)  loss: 4.4249 -> 3.2738   acc: 9.71% -> 22.01%              
client [29] (test)  loss: 4.6413 -> 3.1633   acc: 8.29% -> 30.57%              
client [3] (test)  loss: 3.8495 -> 3.3290   acc: 10.70% -> 28.13%              
client [84] (test)  loss: 4.4971 -> 3.1603   acc: 4.35% -> 31.99%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 5.2133 -> 2.8481   acc: 4.90% -> 34.29%              
client [84] (test)  loss: 4.2597 -> 3.0402   acc: 13.04% -> 32.92%             
client [10] (test)  loss: 3.9252 -> 2.9758   acc: 13.89% -> 36.51%             
client [36] (test)  loss: 4.3983 -> 3.3556   acc: 3.12% -> 20.14%              
client [65] (test)  loss: 4.3243 -> 3.4510   acc: 3.64% -> 27.13%              
client [81] (test)  loss: 4.0563 -> 2.8619   acc: 7.91% -> 38.92%              
client [79] (test)  loss: 3.7047 -> 2.4718   acc: 7.34% -> 47.46%              
client [42] (test)  loss: 4.2959 -> 2.9789   acc: 4.23% -> 39.41%              
client [11] (test)  loss: 4.1421 -> 2.9197   acc: 5.83% -> 35.28%              
client [96] (test)  loss: 5.0133 -> 2.8827   acc: 2.17% -> 34.06%              
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 4.1274 -> 2.7045   acc: 6.73% -> 45.83%               
client [53] (test)  loss: 4.6780 -> 2.7945   acc: 0.90% -> 39.52%              
client [52] (test)  loss: 4.0043 -> 3.2365   acc: 4.98% -> 28.90%              
client [42] (test)  loss: 4.7420 -> 2.9337   acc: 7.17% -> 38.76%              
client [69] (test)  loss: 4.6137 -> 2.4008   acc: 2.83% -> 57.22%              
client [59] (test)  loss: 4.8918 -> 2.6825   acc: 3.23% -> 44.52%              
client [7] (test)  loss: 4.3691 -> 3.0321   acc: 3.88% -> 30.42%               
client [26] (test)  loss: 4.0647 -> 3.2893   acc: 7.31% -> 25.38%              
client [49] (test)  loss: 3.8412 -> 3.6505   acc: 11.49% -> 24.14%             
client [98] (test)  loss: 4.3453 -> 3.3400   acc: 10.00% -> 25.62%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 4.1179 -> 3.2647   acc: 10.94% -> 27.19%             
client [47] (test)  loss: 4.0705 -> 3.0596   acc: 7.52% -> 27.07%              
client [21] (test)  loss: 4.2707 -> 2.7668   acc: 10.66% -> 38.04%             
client [77] (test)  loss: 4.4171 -> 2.8292   acc: 1.88% -> 40.44%              
client [95] (test)  loss: 4.8471 -> 3.2363   acc: 6.93% -> 30.36%              
client [91] (test)  loss: 4.1369 -> 2.6943   acc: 6.75% -> 35.69%              
client [14] (test)  loss: 3.9808 -> 3.2382   acc: 7.06% -> 31.18%              
client [99] (test)  loss: 4.6340 -> 3.2048   acc: 9.55% -> 25.80%              
client [20] (test)  loss: 4.5716 -> 3.7356   acc: 7.24% -> 22.70%              
client [39] (test)  loss: 4.2488 -> 3.4166   acc: 6.80% -> 18.12%              
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 4.1242 -> 3.0787   acc: 3.32% -> 31.89%              
client [62] (test)  loss: 4.4578 -> 3.1183   acc: 0.33% -> 23.93%              
client [71] (test)  loss: 4.0781 -> 3.4043   acc: 8.12% -> 22.08%              
client [97] (test)  loss: 4.5813 -> 3.0124   acc: 6.47% -> 34.48%              
client [30] (test)  loss: 3.9201 -> 3.6816   acc: 8.54% -> 17.72%              
client [88] (test)  loss: 4.2259 -> 2.9141   acc: 14.24% -> 31.13%             
client [60] (test)  loss: 3.9905 -> 3.0417   acc: 11.54% -> 30.77%             
client [82] (test)  loss: 4.1706 -> 2.6474   acc: 7.61% -> 39.10%              
client [91] (test)  loss: 4.2099 -> 2.7575   acc: 6.11% -> 34.08%              
client [57] (test)  loss: 4.4151 -> 2.8008   acc: 13.20% -> 40.92%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 3.4399 -> 2.8061   acc: 18.01% -> 36.33%             
client [15] (test)  loss: 4.7654 -> 2.8733   acc: 3.48% -> 28.80%              
client [71] (test)  loss: 4.2653 -> 3.2391   acc: 6.17% -> 26.30%              
client [97] (test)  loss: 4.1893 -> 2.9663   acc: 12.50% -> 33.62%             
client [53] (test)  loss: 3.9536 -> 2.8122   acc: 9.58% -> 34.13%              
client [77] (test)  loss: 4.3785 -> 2.8661   acc: 2.82% -> 38.56%              
client [76] (test)  loss: 4.3526 -> 3.1073   acc: 5.32% -> 25.91%              
client [79] (test)  loss: 3.9733 -> 2.2733   acc: 10.73% -> 50.85%             
client [28] (test)  loss: 3.9580 -> 3.1935   acc: 11.50% -> 32.06%             
client [99] (test)  loss: 5.1877 -> 3.1281   acc: 7.01% -> 26.11%              
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 3.7759 -> 2.9336   acc: 17.24% -> 33.19%             
client [86] (test)  loss: 4.7062 -> 2.6535   acc: 11.04% -> 40.30%             
client [34] (test)  loss: 5.5917 -> 3.0880   acc: 2.98% -> 27.81%              
client [73] (test)  loss: 4.1561 -> 3.1923   acc: 12.67% -> 26.00%             
client [5] (test)  loss: 4.3355 -> 2.7424   acc: 4.15% -> 33.87%               
client [96] (test)  loss: 4.3627 -> 2.7091   acc: 7.12% -> 37.15%              
client [22] (test)  loss: 4.1186 -> 2.9958   acc: 6.23% -> 30.22%              
client [60] (test)  loss: 3.9607 -> 3.0623   acc: 7.69% -> 30.77%              
client [66] (test)  loss: 4.0927 -> 2.6980   acc: 7.44% -> 33.66%              
client [83] (test)  loss: 5.1581 -> 2.6692   acc: 2.98% -> 42.05%              
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 4.0220 -> 3.1619   acc: 8.31% -> 21.26%              
client [65] (test)  loss: 3.9043 -> 3.3194   acc: 12.15% -> 24.70%             
client [95] (test)  loss: 4.2112 -> 2.9274   acc: 12.21% -> 33.99%             
client [17] (test)  loss: 4.9097 -> 3.4865   acc: 6.67% -> 20.63%              
client [8] (test)  loss: 4.2067 -> 2.5789   acc: 12.50% -> 45.83%              
client [35] (test)  loss: 6.8981 -> 2.5998   acc: 1.33% -> 39.00%              
client [98] (test)  loss: 4.0156 -> 3.0827   acc: 10.31% -> 26.25%             
client [53] (test)  loss: 3.6639 -> 2.8792   acc: 11.38% -> 33.53%             
client [43] (test)  loss: 6.4673 -> 2.5669   acc: 4.55% -> 35.45%              
client [64] (test)  loss: 4.1939 -> 2.5989   acc: 13.17% -> 41.46%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 5.4235 -> 2.5840   acc: 3.75% -> 37.46%              
client [88] (test)  loss: 3.6997 -> 2.9286   acc: 12.58% -> 33.11%             
client [38] (test)  loss: 5.7950 -> 2.7522   acc: 7.08% -> 36.54%              
client [3] (test)  loss: 3.6973 -> 2.5415   acc: 21.71% -> 40.98%              
client [5] (test)  loss: 3.8126 -> 2.8192   acc: 8.31% -> 34.19%               
client [41] (test)  loss: 4.2781 -> 3.0418   acc: 5.33% -> 26.00%              
client [7] (test)  loss: 4.6279 -> 2.8781   acc: 4.53% -> 35.28%               
client [37] (test)  loss: 3.9936 -> 3.1360   acc: 9.00% -> 24.76%              
client [45] (test)  loss: 4.5814 -> 3.1677   acc: 5.67% -> 28.33%              
client [47] (test)  loss: 4.5505 -> 3.1603   acc: 5.64% -> 27.07%              
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 3.4822 -> 2.7202   acc: 18.59% -> 34.37%             
client [11] (test)  loss: 3.8599 -> 2.6670   acc: 7.36% -> 38.04%              
client [37] (test)  loss: 3.9563 -> 3.0487   acc: 11.58% -> 27.33%             
client [41] (test)  loss: 4.0593 -> 3.0226   acc: 7.00% -> 29.00%              
client [95] (test)  loss: 3.8516 -> 2.6906   acc: 13.20% -> 41.58%             
client [53] (test)  loss: 4.1599 -> 2.7472   acc: 10.48% -> 36.23%             
client [22] (test)  loss: 4.0778 -> 3.0229   acc: 6.23% -> 31.15%              
client [25] (test)  loss: 3.8737 -> 2.5485   acc: 16.46% -> 42.62%             
client [69] (test)  loss: 4.9447 -> 2.4635   acc: 11.05% -> 51.56%             
client [46] (test)  loss: 3.7446 -> 2.3582   acc: 13.20% -> 48.00%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 4.0681 -> 3.0968   acc: 13.53% -> 31.58%             
client [69] (test)  loss: 4.6218 -> 2.4214   acc: 12.18% -> 49.58%             
client [82] (test)  loss: 4.0948 -> 2.5729   acc: 7.61% -> 38.06%              
client [45] (test)  loss: 5.1899 -> 3.1087   acc: 6.00% -> 30.67%              
client [7] (test)  loss: 4.9116 -> 2.8715   acc: 5.18% -> 35.92%               
client [50] (test)  loss: 5.9746 -> 2.4881   acc: 1.79% -> 42.29%              
client [35] (test)  loss: 4.7843 -> 2.4977   acc: 10.67% -> 40.33%             
client [24] (test)  loss: 4.7026 -> 2.7439   acc: 7.60% -> 37.26%              
client [15] (test)  loss: 4.3046 -> 3.2270   acc: 10.44% -> 23.10%             
client [58] (test)  loss: 3.9828 -> 3.0037   acc: 12.66% -> 31.33%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 4.4192 -> 3.4006   acc: 6.21% -> 21.24%              
client [76] (test)  loss: 3.8102 -> 3.0987   acc: 7.64% -> 26.91%              
client [67] (test)  loss: 5.2450 -> 2.6194   acc: 4.08% -> 34.17%              
client [37] (test)  loss: 3.5901 -> 2.9205   acc: 19.29% -> 24.76%             
client [58] (test)  loss: 4.2950 -> 3.0728   acc: 14.24% -> 29.75%             
client [64] (test)  loss: 4.7557 -> 2.7009   acc: 7.56% -> 37.82%              
client [77] (test)  loss: 3.9067 -> 2.9688   acc: 10.97% -> 35.74%             
client [55] (test)  loss: 2.6695 -> 2.6036   acc: 37.58% -> 42.86%             
client [12] (test)  loss: 3.1774 -> 3.2870   acc: 25.66% -> 29.61%             
client [89] (test)  loss: 4.1111 -> 3.1232   acc: 11.93% -> 25.69%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 4.5532 -> 2.8672   acc: 8.07% -> 36.34%              
client [51] (test)  loss: 5.4041 -> 3.0085   acc: 4.25% -> 25.82%              
client [8] (test)  loss: 3.7427 -> 2.6419   acc: 13.14% -> 41.99%              
client [18] (test)  loss: 4.7046 -> 2.1669   acc: 5.21% -> 54.95%              
client [94] (test)  loss: 3.5188 -> 3.1328   acc: 16.35% -> 28.53%             
client [81] (test)  loss: 3.9137 -> 2.8131   acc: 13.92% -> 39.56%             
client [3] (test)  loss: 3.2892 -> 2.5776   acc: 26.61% -> 40.67%              
client [11] (test)  loss: 3.7445 -> 2.7157   acc: 11.96% -> 38.34%             
client [95] (test)  loss: 4.1547 -> 2.7349   acc: 10.56% -> 36.30%             
client [67] (test)  loss: 4.7641 -> 2.6228   acc: 6.58% -> 33.86%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 4.5026 -> 2.7318   acc: 6.05% -> 32.85%              
client [79] (test)  loss: 3.2856 -> 2.4072   acc: 23.45% -> 41.53%             
client [58] (test)  loss: 4.3231 -> 2.9317   acc: 16.14% -> 33.23%             
client [88] (test)  loss: 4.1887 -> 2.8454   acc: 14.24% -> 35.10%             
client [46] (test)  loss: 3.4770 -> 2.4276   acc: 19.20% -> 46.80%             
client [11] (test)  loss: 3.8018 -> 2.7653   acc: 15.34% -> 35.28%             
client [55] (test)  loss: 2.7069 -> 2.6418   acc: 40.06% -> 42.24%             
client [13] (test)  loss: 3.6712 -> 3.1015   acc: 16.41% -> 27.66%             
client [31] (test)  loss: 3.4004 -> 2.9055   acc: 21.86% -> 31.51%             
client [75] (test)  loss: 5.2400 -> 2.6571   acc: 3.99% -> 42.52%              
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 3.9900 -> 2.9822   acc: 17.26% -> 30.94%             
client [7] (test)  loss: 4.3607 -> 2.6132   acc: 10.03% -> 42.07%              
client [57] (test)  loss: 4.2319 -> 2.8769   acc: 20.79% -> 37.29%             
client [13] (test)  loss: 4.1651 -> 2.9804   acc: 6.99% -> 31.31%              
client [43] (test)  loss: 4.8117 -> 2.5776   acc: 8.48% -> 36.36%              
client [91] (test)  loss: 3.9227 -> 2.8358   acc: 14.15% -> 38.59%             
client [10] (test)  loss: 3.6433 -> 2.8009   acc: 16.67% -> 33.33%             
client [64] (test)  loss: 4.3081 -> 2.6841   acc: 12.32% -> 39.78%             
client [82] (test)  loss: 4.3105 -> 2.5500   acc: 17.30% -> 38.41%             
client [22] (test)  loss: 4.7618 -> 3.1434   acc: 3.74% -> 24.92%              
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 5.4834 -> 2.5082   acc: 5.59% -> 40.46%              
client [23] (test)  loss: 5.0230 -> 2.8625   acc: 12.11% -> 32.81%             
client [88] (test)  loss: 3.8776 -> 2.8986   acc: 12.91% -> 35.10%             
client [98] (test)  loss: 4.0619 -> 3.1559   acc: 13.12% -> 25.94%             
client [79] (test)  loss: 3.5213 -> 2.5355   acc: 22.03% -> 40.68%             
client [21] (test)  loss: 4.3437 -> 2.9255   acc: 8.07% -> 29.68%              
client [92] (test)  loss: 3.2525 -> 2.8724   acc: 25.52% -> 30.96%             
client [56] (test)  loss: 3.8472 -> 3.0566   acc: 19.80% -> 39.60%             
client [5] (test)  loss: 4.5634 -> 3.1408   acc: 5.43% -> 30.67%               
client [52] (test)  loss: 3.7784 -> 2.7858   acc: 14.29% -> 37.54%             
Training... ---------------------------------------- 100% 0:08:10
==================== FedLC TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '4.3405 -> 0.0000', 'accuracy': '8.34% -> 0.00%'},           
    200: {'loss': '4.3920 -> 0.0000', 'accuracy': '11.96% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedLC achieved 10.0%(10.02%) at epoch: 72                                      
Convergence (test_after):                                                      
FedLC achieved 10.0%(18.95%) at epoch: 0                                       
FedLC achieved 20.0%(25.97%) at epoch: 1                                       
FedLC achieved 30.0%(33.31%) at epoch: 14                                      
FedLC achieved 40.0%(45.25%) at epoch: 104                                     
