Setting up a new session...
==================== ALGORITHM: FedLC ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'tau': 1.0,                                                                
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
Using downloaded and verified file: E:\FL-bench\data\svhn\raw_data\train_32x32.mat
Using downloaded and verified file: E:\FL-bench\data\svhn\raw_data\test_32x32.mat
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.0111 -> 1.4787   acc: 0.82% -> 56.39%              
client [81] (test)  loss: 1.7186 -> 0.6977   acc: 2.97% -> 91.09%              
client [21] (test)  loss: 15.1089 -> 1.7319   acc: 26.09% -> 52.17%            
client [68] (test)  loss: 2.8086 -> 1.0711   acc: 0.98% -> 88.24%              
client [93] (test)  loss: 2.3375 -> 1.4652   acc: 1.24% -> 66.05%              
client [31] (test)  loss: 2.3472 -> 1.4149   acc: 3.66% -> 76.83%              
client [20] (test)  loss: 1.6249 -> 1.2247   acc: 67.30% -> 66.92%             
client [59] (test)  loss: 5.6718 -> 1.1641   acc: 41.34% -> 67.51%             
client [48] (test)  loss: 2.3296 -> 2.0261   acc: 3.09% -> 24.74%              
client [34] (test)  loss: 2.3234 -> 2.2456   acc: 0.00% -> 4.08%               
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 5.6042 -> 0.8014   acc: 4.80% -> 78.25%              
client [99] (test)  loss: 2.1133 -> 0.4437   acc: 17.67% -> 95.40%             
client [67] (test)  loss: 2.4509 -> 1.9045   acc: 14.08% -> 43.53%             
client [0] (test)  loss: 1.7331 -> 1.0263   acc: 37.75% -> 78.26%              
client [76] (test)  loss: 1.6118 -> 0.2793   acc: 31.53% -> 99.10%             
client [41] (test)  loss: 4.5361 -> 0.5390   acc: 2.38% -> 86.14%              
client [62] (test)  loss: 14.1584 -> 0.9562   acc: 57.00% -> 75.00%            
client [2] (test)  loss: 11.4933 -> 2.2158   acc: 73.52% -> 23.76%             
client [14] (test)  loss: 2.0586 -> 0.5010   acc: 9.86% -> 88.12%              
client [46] (test)  loss: 2.1632 -> 1.3920   acc: 13.33% -> 62.50%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.1881 -> 0.5628   acc: 66.31% -> 87.79%             
client [68] (test)  loss: 1.9046 -> 0.6320   acc: 40.20% -> 84.31%             
client [57] (test)  loss: 1.7834 -> 1.0763   acc: 21.11% -> 63.61%             
client [17] (test)  loss: 2.0099 -> 0.5172   acc: 32.30% -> 90.27%             
client [54] (test)  loss: 1.1075 -> 0.3108   acc: 73.73% -> 93.73%             
client [23] (test)  loss: 27.2621 -> 0.7054   acc: 48.85% -> 83.21%            
client [35] (test)  loss: 1.9024 -> 0.6346   acc: 28.44% -> 87.59%             
client [59] (test)  loss: 1.6556 -> 0.7462   acc: 31.41% -> 78.88%             
client [31] (test)  loss: 1.5548 -> 1.0748   acc: 42.68% -> 60.98%             
client [9] (test)  loss: 1.3978 -> 0.7019   acc: 52.87% -> 77.39%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.2808 -> 0.8933   acc: 56.50% -> 73.41%             
client [33] (test)  loss: 1.5092 -> 0.8461   acc: 56.27% -> 74.92%             
client [16] (test)  loss: 0.9986 -> 0.8314   acc: 58.38% -> 68.11%             
client [44] (test)  loss: 3.3443 -> 1.0412   acc: 27.27% -> 64.88%             
client [8] (test)  loss: 1.7594 -> 0.6574   acc: 28.85% -> 78.85%              
client [31] (test)  loss: 1.6713 -> 0.8476   acc: 42.68% -> 80.49%             
client [47] (test)  loss: 1.1967 -> 1.3286   acc: 66.67% -> 59.24%             
client [36] (test)  loss: 1.1517 -> 1.0240   acc: 70.83% -> 70.83%             
client [20] (test)  loss: 1.5004 -> 1.1013   acc: 35.55% -> 65.97%             
client [56] (test)  loss: 1.1773 -> 0.3412   acc: 68.80% -> 93.50%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.9055 -> 0.3452   acc: 51.22% -> 92.68%              
client [60] (test)  loss: 1.2581 -> 1.2833   acc: 64.15% -> 58.49%             
client [28] (test)  loss: 0.6552 -> 0.3578   acc: 79.07% -> 91.15%             
client [25] (test)  loss: 0.9705 -> 0.3903   acc: 68.91% -> 89.08%             
client [58] (test)  loss: 1.3419 -> 0.9447   acc: 57.71% -> 72.34%             
client [44] (test)  loss: 1.1063 -> 0.8539   acc: 63.64% -> 69.83%             
client [39] (test)  loss: 1.5192 -> 0.8528   acc: 38.24% -> 67.65%             
client [29] (test)  loss: 0.8548 -> 0.1969   acc: 66.35% -> 97.00%             
client [3] (test)  loss: 1.8966 -> 0.9721   acc: 36.78% -> 68.13%              
client [84] (test)  loss: 1.1948 -> 1.2287   acc: 58.75% -> 61.41%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 1.7979 -> 1.1491   acc: 56.52% -> 69.57%             
client [84] (test)  loss: 1.3860 -> 1.3128   acc: 53.42% -> 59.70%             
client [10] (test)  loss: 1.4256 -> 0.3282   acc: 58.82% -> 91.39%             
client [36] (test)  loss: 0.9545 -> 0.7272   acc: 70.83% -> 79.17%             
client [65] (test)  loss: 1.1511 -> 0.2871   acc: 61.98% -> 92.79%             
client [81] (test)  loss: 1.0362 -> 0.4203   acc: 69.31% -> 88.12%             
client [79] (test)  loss: 1.0460 -> 0.2089   acc: 65.47% -> 95.74%             
client [42] (test)  loss: 1.0496 -> 0.6564   acc: 66.10% -> 81.69%             
client [11] (test)  loss: 0.9188 -> 0.7729   acc: 76.84% -> 79.66%             
client [96] (test)  loss: 0.5457 -> 0.3790   acc: 83.94% -> 91.24%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 0.5727 -> 0.3000   acc: 82.69% -> 92.31%              
client [53] (test)  loss: 1.4238 -> 0.3486   acc: 58.18% -> 91.72%             
client [52] (test)  loss: 0.9330 -> 0.6403   acc: 74.10% -> 82.87%             
client [42] (test)  loss: 0.8257 -> 0.5937   acc: 75.25% -> 82.03%             
client [69] (test)  loss: 1.2779 -> 0.5243   acc: 52.82% -> 83.62%             
client [59] (test)  loss: 1.4206 -> 0.6993   acc: 48.92% -> 79.24%             
client [7] (test)  loss: 0.3763 -> 0.4389   acc: 90.08% -> 88.64%              
client [26] (test)  loss: 0.7942 -> 0.4362   acc: 76.31% -> 87.08%             
client [49] (test)  loss: 0.6227 -> 0.2272   acc: 82.11% -> 94.73%             
client [98] (test)  loss: 1.8299 -> 0.3463   acc: 48.84% -> 91.47%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.6827 -> 0.4018   acc: 54.46% -> 89.34%             
client [47] (test)  loss: 1.0545 -> 0.8343   acc: 72.07% -> 74.98%             
client [21] (test)  loss: 1.0202 -> 0.8544   acc: 69.57% -> 76.09%             
client [77] (test)  loss: 1.3546 -> 1.3139   acc: 60.49% -> 60.00%             
client [95] (test)  loss: 1.0707 -> 0.7832   acc: 69.68% -> 76.47%             
client [91] (test)  loss: 0.8894 -> 0.5670   acc: 73.37% -> 84.60%             
client [14] (test)  loss: 1.0915 -> 0.3099   acc: 66.67% -> 93.04%             
client [99] (test)  loss: 1.3897 -> 0.2377   acc: 55.32% -> 92.96%             
client [20] (test)  loss: 1.2728 -> 0.7318   acc: 57.22% -> 78.14%             
client [39] (test)  loss: 1.7842 -> 0.6382   acc: 50.74% -> 79.41%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.3195 -> 0.8755   acc: 63.08% -> 74.96%             
client [62] (test)  loss: 0.8320 -> 0.5970   acc: 76.60% -> 83.60%             
client [71] (test)  loss: 0.6334 -> 0.4706   acc: 80.87% -> 86.56%             
client [97] (test)  loss: 0.9729 -> 0.8119   acc: 68.62% -> 76.19%             
client [30] (test)  loss: 2.0618 -> 0.5398   acc: 37.98% -> 84.50%             
client [88] (test)  loss: 0.6227 -> 0.3751   acc: 78.60% -> 90.40%             
client [60] (test)  loss: 0.9276 -> 0.9092   acc: 75.47% -> 75.47%             
client [82] (test)  loss: 1.6299 -> 1.2347   acc: 58.54% -> 73.17%             
client [91] (test)  loss: 1.2114 -> 0.7163   acc: 58.22% -> 78.07%             
client [57] (test)  loss: 1.0681 -> 0.6846   acc: 64.47% -> 78.89%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 1.3311 -> 0.7680   acc: 56.10% -> 74.39%             
client [15] (test)  loss: 1.9357 -> 0.4721   acc: 45.02% -> 86.62%             
client [71] (test)  loss: 0.8169 -> 0.5889   acc: 74.72% -> 81.32%             
client [97] (test)  loss: 1.3209 -> 1.2714   acc: 62.08% -> 61.29%             
client [53] (test)  loss: 1.6249 -> 0.3943   acc: 55.15% -> 88.69%             
client [77] (test)  loss: 1.9863 -> 1.4984   acc: 42.79% -> 54.92%             
client [76] (test)  loss: 1.0928 -> 0.4478   acc: 64.32% -> 88.11%             
client [79] (test)  loss: 1.5249 -> 0.2897   acc: 42.75% -> 94.00%             
client [28] (test)  loss: 0.8629 -> 0.2887   acc: 76.46% -> 92.76%             
client [99] (test)  loss: 1.7761 -> 0.2014   acc: 47.41% -> 95.26%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.2658 -> 1.2447   acc: 64.11% -> 64.79%             
client [86] (test)  loss: 1.1889 -> 0.4888   acc: 66.25% -> 86.90%             
client [34] (test)  loss: 1.3746 -> 1.6065   acc: 59.18% -> 61.22%             
client [73] (test)  loss: 0.9666 -> 0.1419   acc: 65.59% -> 96.91%             
client [5] (test)  loss: 1.3724 -> 0.4568   acc: 63.29% -> 87.97%              
client [96] (test)  loss: 0.5760 -> 0.4450   acc: 81.02% -> 88.32%             
client [22] (test)  loss: 0.7785 -> 0.6541   acc: 70.27% -> 81.08%             
client [60] (test)  loss: 1.0241 -> 0.9258   acc: 75.47% -> 79.25%             
client [66] (test)  loss: 0.5827 -> 0.5603   acc: 82.25% -> 84.98%             
client [83] (test)  loss: 0.3863 -> 0.3006   acc: 90.00% -> 92.50%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.9067 -> 0.4131   acc: 66.85% -> 88.47%             
client [65] (test)  loss: 1.4204 -> 0.4292   acc: 61.08% -> 87.17%             
client [95] (test)  loss: 1.0380 -> 0.5970   acc: 71.95% -> 82.81%             
client [17] (test)  loss: 2.1821 -> 0.3977   acc: 45.53% -> 89.11%             
client [8] (test)  loss: 0.6053 -> 0.2747   acc: 80.77% -> 92.31%              
client [35] (test)  loss: 1.6139 -> 0.4115   acc: 49.39% -> 87.97%             
client [98] (test)  loss: 1.9477 -> 0.4085   acc: 50.39% -> 89.92%             
client [53] (test)  loss: 1.6283 -> 0.4054   acc: 55.35% -> 89.09%             
client [43] (test)  loss: 1.2807 -> 0.9942   acc: 61.17% -> 70.70%             
client [64] (test)  loss: 1.1666 -> 0.6204   acc: 62.54% -> 83.69%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 1.3420 -> 0.8429   acc: 69.57% -> 81.52%             
client [88] (test)  loss: 0.8929 -> 0.4428   acc: 69.96% -> 87.65%             
client [38] (test)  loss: 2.0604 -> 0.9725   acc: 55.25% -> 77.63%             
client [3] (test)  loss: 0.8682 -> 0.5869   acc: 71.63% -> 82.84%              
client [5] (test)  loss: 1.5981 -> 0.4097   acc: 57.59% -> 88.61%              
client [41] (test)  loss: 1.4591 -> 0.5564   acc: 62.77% -> 86.34%             
client [7] (test)  loss: 1.5889 -> 0.5471   acc: 49.12% -> 81.60%              
client [37] (test)  loss: 1.1486 -> 0.3035   acc: 71.39% -> 92.19%             
client [45] (test)  loss: 0.9405 -> 0.4125   acc: 71.19% -> 85.17%             
client [47] (test)  loss: 1.6537 -> 1.4143   acc: 59.73% -> 61.74%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.8785 -> 0.6357   acc: 75.14% -> 79.46%             
client [11] (test)  loss: 1.4516 -> 0.7363   acc: 63.28% -> 77.40%             
client [37] (test)  loss: 0.5381 -> 0.2350   acc: 86.06% -> 93.27%             
client [41] (test)  loss: 0.7846 -> 0.5442   acc: 80.79% -> 86.93%             
client [95] (test)  loss: 1.1202 -> 0.7269   acc: 69.23% -> 80.54%             
client [53] (test)  loss: 0.6101 -> 0.2850   acc: 82.63% -> 93.54%             
client [22] (test)  loss: 0.8495 -> 0.6941   acc: 62.16% -> 74.32%             
client [25] (test)  loss: 1.0189 -> 0.2425   acc: 64.71% -> 89.92%             
client [69] (test)  loss: 0.7742 -> 0.4279   acc: 76.84% -> 88.42%             
client [46] (test)  loss: 1.2726 -> 0.6691   acc: 65.00% -> 83.33%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 1.2884 -> 1.2465   acc: 64.25% -> 64.89%             
client [69] (test)  loss: 0.9615 -> 0.4143   acc: 68.36% -> 88.98%             
client [82] (test)  loss: 1.2135 -> 1.2411   acc: 73.17% -> 70.73%             
client [45] (test)  loss: 0.9674 -> 0.4052   acc: 66.53% -> 86.02%             
client [7] (test)  loss: 1.1513 -> 0.6165   acc: 61.76% -> 80.48%              
client [50] (test)  loss: 0.6468 -> 0.5704   acc: 77.45% -> 81.37%             
client [35] (test)  loss: 1.1243 -> 0.3749   acc: 61.35% -> 89.33%             
client [24] (test)  loss: 1.2540 -> 0.5767   acc: 64.43% -> 86.44%             
client [15] (test)  loss: 0.9711 -> 0.4076   acc: 71.15% -> 88.01%             
client [58] (test)  loss: 1.4114 -> 0.8759   acc: 56.12% -> 75.36%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.0475 -> 0.9985   acc: 65.98% -> 78.35%             
client [76] (test)  loss: 1.1974 -> 0.2230   acc: 58.56% -> 94.23%             
client [67] (test)  loss: 0.9082 -> 0.4443   acc: 72.98% -> 88.35%             
client [37] (test)  loss: 0.7653 -> 0.2640   acc: 80.53% -> 93.87%             
client [58] (test)  loss: 0.8954 -> 0.7311   acc: 68.68% -> 80.76%             
client [64] (test)  loss: 1.4586 -> 0.7667   acc: 58.61% -> 80.06%             
client [77] (test)  loss: 0.9644 -> 0.9812   acc: 75.57% -> 72.62%             
client [55] (test)  loss: 0.8068 -> 0.2763   acc: 72.03% -> 92.03%             
client [12] (test)  loss: 1.0309 -> 0.9643   acc: 62.50% -> 65.62%             
client [89] (test)  loss: 1.0018 -> 0.2681   acc: 64.13% -> 94.70%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 0.7984 -> 0.6772   acc: 74.33% -> 78.33%             
client [51] (test)  loss: 1.2711 -> 0.4538   acc: 70.02% -> 92.06%             
client [8] (test)  loss: 0.5012 -> 0.2086   acc: 84.62% -> 94.23%              
client [18] (test)  loss: 0.7027 -> 0.4076   acc: 80.38% -> 88.20%             
client [94] (test)  loss: 1.0039 -> 0.2254   acc: 72.41% -> 95.18%             
client [81] (test)  loss: 1.2203 -> 0.4223   acc: 65.35% -> 87.13%             
client [3] (test)  loss: 0.8643 -> 0.5429   acc: 75.31% -> 82.84%              
client [11] (test)  loss: 1.0150 -> 0.7412   acc: 76.27% -> 80.79%             
client [95] (test)  loss: 0.8142 -> 0.5943   acc: 77.83% -> 83.71%             
client [67] (test)  loss: 0.9521 -> 0.4878   acc: 76.05% -> 87.22%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 1.2041 -> 0.9981   acc: 64.13% -> 73.91%             
client [79] (test)  loss: 1.2463 -> 0.3433   acc: 56.77% -> 91.91%             
client [58] (test)  loss: 1.0326 -> 0.7749   acc: 69.63% -> 79.17%             
client [88] (test)  loss: 0.7752 -> 0.4778   acc: 76.13% -> 86.15%             
client [46] (test)  loss: 1.0891 -> 0.6415   acc: 72.50% -> 82.50%             
client [11] (test)  loss: 1.2083 -> 0.7705   acc: 68.93% -> 80.79%             
client [55] (test)  loss: 1.1648 -> 0.4732   acc: 64.35% -> 87.39%             
client [13] (test)  loss: 0.6519 -> 0.2900   acc: 84.83% -> 92.77%             
client [31] (test)  loss: 1.1282 -> 0.5679   acc: 69.51% -> 86.59%             
client [75] (test)  loss: 1.1052 -> 0.7204   acc: 63.43% -> 80.89%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.8669 -> 0.7696   acc: 73.76% -> 74.11%             
client [7] (test)  loss: 1.7492 -> 0.7266   acc: 51.36% -> 79.52%              
client [57] (test)  loss: 1.2298 -> 0.9736   acc: 63.61% -> 69.44%             
client [13] (test)  loss: 0.7279 -> 0.3927   acc: 79.54% -> 89.24%             
client [43] (test)  loss: 1.4274 -> 0.9478   acc: 60.26% -> 74.73%             
client [91] (test)  loss: 1.3576 -> 0.7027   acc: 62.92% -> 80.68%             
client [10] (test)  loss: 1.1309 -> 0.3538   acc: 67.14% -> 90.39%             
client [64] (test)  loss: 0.9913 -> 0.6144   acc: 70.69% -> 84.59%             
client [82] (test)  loss: 1.4323 -> 1.2813   acc: 75.61% -> 68.29%             
client [22] (test)  loss: 0.6553 -> 0.5550   acc: 78.38% -> 81.08%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 1.5652 -> 0.6932   acc: 51.52% -> 81.94%             
client [23] (test)  loss: 0.6097 -> 0.3390   acc: 84.35% -> 90.08%             
client [88] (test)  loss: 0.8671 -> 0.5015   acc: 76.41% -> 86.01%             
client [98] (test)  loss: 1.1807 -> 0.4432   acc: 72.29% -> 90.12%             
client [79] (test)  loss: 0.6587 -> 0.2465   acc: 78.78% -> 94.60%             
client [21] (test)  loss: 0.7508 -> 0.7248   acc: 85.87% -> 84.78%             
client [92] (test)  loss: 0.9317 -> 0.5160   acc: 74.48% -> 87.89%             
client [56] (test)  loss: 1.8787 -> 0.1389   acc: 50.14% -> 96.47%             
client [5] (test)  loss: 1.7003 -> 0.4681   acc: 55.70% -> 87.97%              
client [52] (test)  loss: 1.5422 -> 0.6213   acc: 61.88% -> 83.05%             
Training... ---------------------------------------- 100% 0:12:42
==================== FedLC TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '1.4900 -> 0.0000', 'accuracy': '56.99% -> 0.00%'},          
    200: {'loss': '1.2243 -> 0.0000', 'accuracy': '67.28% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedLC achieved 10.0%(10.14%) at epoch: 0                                       
FedLC achieved 20.0%(23.85%) at epoch: 1                                       
FedLC achieved 30.0%(32.39%) at epoch: 6                                       
FedLC achieved 40.0%(44.05%) at epoch: 13                                      
FedLC achieved 50.0%(50.69%) at epoch: 24                                      
FedLC achieved 60.0%(60.73%) at epoch: 26                                      
FedLC achieved 70.0%(72.56%) at epoch: 71                                      
Convergence (test_after):                                                      
FedLC achieved 80.0%(82.11%) at epoch: 0                                       
FedLC achieved 90.0%(90.16%) at epoch: 7                                       
