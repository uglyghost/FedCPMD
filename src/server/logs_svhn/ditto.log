Setting up a new session...
==================== ALGORITHM: Ditto ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'svhn',                                                         
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'pers_epoch': 1,                                                           
    'lamda': 1,                                                                
    'dataset_args': {                                                          
        'dataset': 'svhn',                                                     
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
Using downloaded and verified file: E:\FL-bench\data\svhn\raw_data\train_32x32.mat
Using downloaded and verified file: E:\FL-bench\data\svhn\raw_data\test_32x32.mat
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: nan -> nan   acc: 25.08% -> 25.08%                   
client [81] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [21] (test)  loss: 36.2203 -> nan   acc: 1.09% -> 0.00%                 
client [68] (test)  loss: 21607474669742469414912.0000 -> nan   acc: 93.14% -> 
0.00%                                                                          
client [93] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [31] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [20] (test)  loss: nan -> nan   acc: 8.37% -> 8.37%                     
client [59] (test)  loss: 43.2234 -> nan   acc: 1.99% -> 7.04%                 
client [48] (test)  loss: nan -> nan   acc: 6.19% -> 6.19%                     
client [34] (test)  loss: 48320815.0204 -> nan   acc: 36.73% -> 30.61%         
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: nan -> nan   acc: 15.25% -> 15.25%                   
client [99] (test)  loss: nan -> nan   acc: 0.14% -> 0.14%                     
client [67] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [0] (test)  loss: nan -> nan   acc: 52.57% -> 52.57%                    
client [76] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [41] (test)  loss: nan -> nan   acc: 9.90% -> 9.90%                     
client [62] (test)  loss: 6.6323 -> 1.9482   acc: 20.80% -> 51.40%             
client [2] (test)  loss: 8.4904 -> 0.1009   acc: 9.11% -> 99.96%               
client [14] (test)  loss: nan -> nan   acc: 86.96% -> 86.96%                   
client [46] (test)  loss: nan -> nan   acc: 5.00% -> 5.00%                     
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 0.8560 -> 0.7879   acc: 84.43% -> 84.43%             
client [68] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [57] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [17] (test)  loss: nan -> nan   acc: 91.83% -> 91.83%                   
client [54] (test)  loss: nan -> nan   acc: 1.19% -> 1.19%                     
client [23] (test)  loss: 19.7033 -> nan   acc: 1.91% -> 4.58%                 
client [35] (test)  loss: nan -> nan   acc: 0.23% -> 0.23%                     
client [59] (test)  loss: nan -> nan   acc: 7.04% -> 7.04%                     
client [31] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [9] (test)  loss: 2.1337 -> 2.0905   acc: 24.20% -> 24.20%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: nan -> nan   acc: 1.21% -> 1.21%                     
client [33] (test)  loss: 0.2850 -> 0.2314   acc: 97.12% -> 97.12%             
client [16] (test)  loss: 0.7637 -> 0.7708   acc: 58.38% -> 58.38%             
client [44] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [8] (test)  loss: nan -> nan   acc: 13.46% -> 13.46%                    
client [31] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [47] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [36] (test)  loss: 261.8489 -> 457088640.0000   acc: 50.00% -> 41.67%   
client [20] (test)  loss: nan -> nan   acc: 8.37% -> 8.37%                     
client [56] (test)  loss: nan -> nan   acc: 0.37% -> 0.37%                     
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 0.0231 -> 0.0245   acc: 100.00% -> 100.00%            
client [60] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [28] (test)  loss: 0.8989 -> 0.8822   acc: 61.77% -> 61.77%             
client [25] (test)  loss: 0.1981 -> 0.1860   acc: 98.32% -> 98.32%             
client [58] (test)  loss: nan -> nan   acc: 2.07% -> 2.07%                     
client [44] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [39] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [29] (test)  loss: nan -> nan   acc: 5.69% -> 5.69%                     
client [3] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                      
client [84] (test)  loss: nan -> nan   acc: 19.96% -> 19.96%                   
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: nan -> nan   acc: 45.65% -> 45.65%                   
client [84] (test)  loss: nan -> nan   acc: 19.96% -> 19.96%                   
client [10] (test)  loss: nan -> nan   acc: 0.14% -> 0.14%                     
client [36] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [65] (test)  loss: 0.1251 -> 0.0527   acc: 99.59% -> 99.66%             
client [81] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [79] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [42] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [11] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [96] (test)  loss: nan -> nan   acc: 0.73% -> 0.73%                     
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: nan -> nan   acc: 13.46% -> 13.46%                    
client [53] (test)  loss: nan -> nan   acc: 0.81% -> 0.81%                     
client [52] (test)  loss: nan -> nan   acc: 27.54% -> 27.54%                   
client [42] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [69] (test)  loss: nan -> nan   acc: 15.25% -> 15.25%                   
client [59] (test)  loss: nan -> nan   acc: 7.04% -> 7.04%                     
client [7] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                      
client [26] (test)  loss: nan -> nan   acc: 92.92% -> 92.92%                   
client [49] (test)  loss: nan -> nan   acc: 0.16% -> 0.16%                     
client [98] (test)  loss: nan -> nan   acc: 86.63% -> 86.63%                   
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: nan -> nan   acc: 86.63% -> 86.63%                   
client [47] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [21] (test)  loss: nan -> nan   acc: 45.65% -> 45.65%                   
client [77] (test)  loss: nan -> nan   acc: 25.08% -> 25.08%                   
client [95] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [91] (test)  loss: nan -> nan   acc: 9.66% -> 9.66%                     
client [14] (test)  loss: nan -> nan   acc: 86.96% -> 86.96%                   
client [99] (test)  loss: nan -> nan   acc: 0.14% -> 0.14%                     
client [20] (test)  loss: nan -> nan   acc: 8.37% -> 8.37%                     
client [39] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: nan -> nan   acc: 27.54% -> 27.54%                   
client [62] (test)  loss: 1.5149 -> 1.4285   acc: 51.40% -> 51.40%             
client [71] (test)  loss: nan -> nan   acc: 1.14% -> 1.14%                     
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [30] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [88] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [60] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [82] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [91] (test)  loss: nan -> nan   acc: 9.66% -> 9.66%                     
client [57] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [15] (test)  loss: 0.8629 -> 0.5866   acc: 79.86% -> 80.28%             
client [71] (test)  loss: nan -> nan   acc: 1.14% -> 1.14%                     
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [53] (test)  loss: nan -> nan   acc: 0.81% -> 0.81%                     
client [77] (test)  loss: nan -> nan   acc: 25.08% -> 25.08%                   
client [76] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [79] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [28] (test)  loss: 3.7339 -> 0.8480   acc: 35.81% -> 61.57%             
client [99] (test)  loss: nan -> nan   acc: 0.14% -> 0.14%                     
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [86] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [34] (test)  loss: nan -> nan   acc: 30.61% -> 30.61%                   
client [73] (test)  loss: 0.0666 -> 0.0632   acc: 99.56% -> 99.56%             
client [5] (test)  loss: 1.3434 -> 1.2354   acc: 73.42% -> 73.42%              
client [96] (test)  loss: nan -> nan   acc: 0.73% -> 0.73%                     
client [22] (test)  loss: nan -> nan   acc: 1.35% -> 1.35%                     
client [60] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [66] (test)  loss: 1.9282 -> 1.8971   acc: 47.78% -> 47.78%             
client [83] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [65] (test)  loss: 0.0529 -> 0.0492   acc: 99.66% -> 99.66%             
client [95] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [17] (test)  loss: nan -> nan   acc: 91.83% -> 91.83%                   
client [8] (test)  loss: nan -> nan   acc: 13.46% -> 13.46%                    
client [35] (test)  loss: nan -> nan   acc: 0.23% -> 0.23%                     
client [98] (test)  loss: nan -> nan   acc: 86.63% -> 86.63%                   
client [53] (test)  loss: nan -> nan   acc: 0.81% -> 0.81%                     
client [43] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [64] (test)  loss: nan -> nan   acc: 1.21% -> 1.21%                     
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: nan -> nan   acc: 45.65% -> 45.65%                   
client [88] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [38] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [3] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                      
client [5] (test)  loss: 1.1518 -> 1.0978   acc: 73.42% -> 73.42%              
client [41] (test)  loss: nan -> nan   acc: 9.90% -> 9.90%                     
client [7] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                      
client [37] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [45] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [47] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 0.7966 -> 1.0447   acc: 58.38% -> 58.38%             
client [11] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [37] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [41] (test)  loss: nan -> nan   acc: 9.90% -> 9.90%                     
client [95] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [53] (test)  loss: nan -> nan   acc: 0.81% -> 0.81%                     
client [22] (test)  loss: nan -> nan   acc: 1.35% -> 1.35%                     
client [25] (test)  loss: 0.1604 -> 0.1677   acc: 98.32% -> 98.32%             
client [69] (test)  loss: nan -> nan   acc: 15.25% -> 15.25%                   
client [46] (test)  loss: nan -> nan   acc: 5.00% -> 5.00%                     
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.0000 -> 0.0000   acc: 100.00% -> 100.00%           
client [69] (test)  loss: nan -> nan   acc: 15.25% -> 15.25%                   
client [82] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [45] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [7] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                      
client [50] (test)  loss: 1223245551144076.5000 -> nan   acc: 64.71% -> 0.00%  
client [35] (test)  loss: nan -> nan   acc: 0.23% -> 0.23%                     
client [24] (test)  loss: 0.7119 -> 0.8966   acc: 84.43% -> 84.30%             
client [15] (test)  loss: 0.6004 -> 1.1724   acc: 80.14% -> 79.30%             
client [58] (test)  loss: nan -> nan   acc: 2.07% -> 2.07%                     
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: nan -> nan   acc: 6.19% -> 6.19%                     
client [76] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [67] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [37] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [58] (test)  loss: nan -> nan   acc: 2.07% -> 2.07%                     
client [64] (test)  loss: nan -> nan   acc: 1.21% -> 1.21%                     
client [77] (test)  loss: nan -> nan   acc: 25.08% -> 25.08%                   
client [55] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [12] (test)  loss: 1401.4830 -> 1361.0684   acc: 93.75% -> 93.75%       
client [89] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: nan -> nan   acc: 19.96% -> 19.96%                   
client [51] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [8] (test)  loss: nan -> nan   acc: 13.46% -> 13.46%                    
client [18] (test)  loss: nan -> nan   acc: 1.18% -> 1.18%                     
client [94] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [81] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [3] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                      
client [11] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [95] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [67] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: nan -> nan   acc: 45.65% -> 45.65%                   
client [79] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [58] (test)  loss: nan -> nan   acc: 2.07% -> 2.07%                     
client [88] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [46] (test)  loss: nan -> nan   acc: 5.00% -> 5.00%                     
client [11] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [55] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [13] (test)  loss: 1.9540 -> 1.7853   acc: 92.24% -> 92.42%             
client [31] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [75] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 0.6620 -> 0.6491   acc: 71.81% -> 71.81%             
client [7] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                      
client [57] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [13] (test)  loss: 1.8124 -> 1.2281   acc: 92.06% -> 92.42%             
client [43] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [91] (test)  loss: nan -> nan   acc: 9.66% -> 9.66%                     
client [10] (test)  loss: nan -> nan   acc: 0.14% -> 0.14%                     
client [64] (test)  loss: nan -> nan   acc: 1.21% -> 1.21%                     
client [82] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [22] (test)  loss: nan -> nan   acc: 1.35% -> 1.35%                     
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: nan -> nan   acc: 8.37% -> 8.37%                     
client [23] (test)  loss: nan -> nan   acc: 4.58% -> 4.58%                     
client [88] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [98] (test)  loss: nan -> nan   acc: 86.63% -> 86.63%                   
client [79] (test)  loss: nan -> nan   acc: 0.00% -> 0.00%                     
client [21] (test)  loss: nan -> nan   acc: 45.65% -> 45.65%                   
client [92] (test)  loss: 1.4661 -> 1.4314   acc: 30.41% -> 30.41%             
client [56] (test)  loss: nan -> nan   acc: 0.37% -> 0.37%                     
client [5] (test)  loss: 0.9439 -> 0.9294   acc: 73.42% -> 73.42%              
client [52] (test)  loss: nan -> nan   acc: 27.54% -> 27.54%                   
Training... ---------------------------------------- 100% 0:12:36
==================== Ditto TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': 'nan -> 0.0000', 'accuracy': '34.42% -> 0.00%'},             
    200: {'loss': 'nan -> 0.0000', 'accuracy': '33.31% -> 0.00%'}              
}                                                                              
Convergence (test_before):                                                     
Ditto achieved 10.0%(10.14%) at epoch: 0                                       
Ditto achieved 30.0%(30.85%) at epoch: 3                                       
Ditto achieved 40.0%(44.42%) at epoch: 4                                       
Ditto achieved 50.0%(56.69%) at epoch: 18                                      
Ditto achieved 60.0%(60.90%) at epoch: 42                                      
Ditto achieved 70.0%(70.12%) at epoch: 70                                      
Convergence (test_after):                                                      
Ditto achieved 50.0%(55.64%) at epoch: 0                                       
Ditto achieved 60.0%(63.21%) at epoch: 8                                       
Ditto achieved 70.0%(70.12%) at epoch: 70                                      
