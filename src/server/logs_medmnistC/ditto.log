Setting up a new session...
==================== ALGORITHM: Ditto ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'pers_epoch': 1,                                                           
    'lamda': 1,                                                                
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.2874 -> 2.2236   acc: 43.48% -> 75.65%             
client [81] (test)  loss: 2.3316 -> 2.3275   acc: 47.83% -> 47.83%             
client [21] (test)  loss: 2.4906 -> 2.4802   acc: 3.45% -> 3.45%               
client [68] (test)  loss: 2.2333 -> 2.0837   acc: 88.78% -> 89.80%             
client [93] (test)  loss: 2.3732 -> 2.3405   acc: 5.49% -> 7.69%               
client [31] (test)  loss: 2.3456 -> 2.3015   acc: 5.56% -> 75.56%              
client [20] (test)  loss: 2.3560 -> 2.3037   acc: 24.35% -> 68.70%             
client [59] (test)  loss: 2.3649 -> 2.1173   acc: 6.56% -> 96.72%              
client [48] (test)  loss: 2.2808 -> 2.2223   acc: 52.99% -> 80.34%             
client [34] (test)  loss: 2.3655 -> 2.3329   acc: 1.63% -> 23.58%              
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.0136 -> 1.0366   acc: 84.65% -> 84.65%             
client [99] (test)  loss: 2.2730 -> 2.1915   acc: 83.59% -> 95.31%             
client [67] (test)  loss: 2.4647 -> 2.3705   acc: 0.00% -> 0.00%               
client [0] (test)  loss: 2.3519 -> 2.3377   acc: 15.25% -> 15.25%              
client [76] (test)  loss: 2.3427 -> 2.3130   acc: 36.11% -> 36.11%             
client [41] (test)  loss: 2.2434 -> 2.1846   acc: 85.44% -> 85.44%             
client [62] (test)  loss: 2.4201 -> 2.3295   acc: 0.00% -> 2.01%               
client [2] (test)  loss: 2.3714 -> 2.3069   acc: 2.05% -> 40.41%               
client [14] (test)  loss: 2.3418 -> 2.3110   acc: 33.80% -> 60.56%             
client [46] (test)  loss: 2.3293 -> 2.2899   acc: 50.63% -> 51.90%             
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 2.1455 -> 2.0139   acc: 75.81% -> 75.81%             
client [68] (test)  loss: 0.5574 -> 0.4893   acc: 89.80% -> 89.80%             
client [57] (test)  loss: 2.2588 -> 2.1915   acc: 72.03% -> 72.03%             
client [17] (test)  loss: 2.2231 -> 2.1299   acc: 48.94% -> 48.94%             
client [54] (test)  loss: 2.3142 -> 2.2802   acc: 43.48% -> 47.83%             
client [23] (test)  loss: 2.3968 -> 2.3756   acc: 1.85% -> 1.85%               
client [35] (test)  loss: 2.3853 -> 2.3690   acc: 35.71% -> 42.86%             
client [59] (test)  loss: 0.4200 -> 0.2389   acc: 93.44% -> 93.44%             
client [31] (test)  loss: 2.0299 -> 1.8977   acc: 86.67% -> 86.67%             
client [9] (test)  loss: 2.3134 -> 2.2845   acc: 21.43% -> 40.48%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.1706 -> 2.1082   acc: 87.72% -> 84.21%             
client [33] (test)  loss: 2.2112 -> 2.1660   acc: 79.66% -> 77.97%             
client [16] (test)  loss: 2.3153 -> 2.2849   acc: 70.27% -> 72.97%             
client [44] (test)  loss: 2.2712 -> 2.1398   acc: 79.23% -> 79.23%             
client [8] (test)  loss: 2.1349 -> 2.0839   acc: 46.58% -> 46.58%              
client [31] (test)  loss: 1.7009 -> 1.4142   acc: 86.67% -> 86.67%             
client [47] (test)  loss: 2.2708 -> 2.2131   acc: 74.67% -> 77.33%             
client [36] (test)  loss: 2.2901 -> 2.1960   acc: 43.43% -> 72.00%             
client [20] (test)  loss: 1.8820 -> 1.6142   acc: 68.70% -> 68.70%             
client [56] (test)  loss: 2.4105 -> 2.3866   acc: 0.00% -> 0.00%               
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.3937 -> 2.3784   acc: 3.85% -> 7.69%                
client [60] (test)  loss: 2.3435 -> 2.3187   acc: 4.44% -> 33.33%              
client [28] (test)  loss: 2.3672 -> 2.3602   acc: 4.00% -> 12.00%              
client [25] (test)  loss: 2.2791 -> 2.2397   acc: 64.37% -> 65.52%             
client [58] (test)  loss: 2.1449 -> 2.1218   acc: 96.30% -> 96.30%             
client [44] (test)  loss: 2.1398 -> 1.8659   acc: 79.23% -> 79.23%             
client [39] (test)  loss: 2.3053 -> 2.2595   acc: 37.60% -> 35.20%             
client [29] (test)  loss: 2.3332 -> 2.3120   acc: 37.50% -> 55.36%             
client [3] (test)  loss: 1.4254 -> 0.5721   acc: 94.31% -> 94.31%              
client [84] (test)  loss: 2.3370 -> 2.3209   acc: 17.07% -> 34.15%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.4607 -> 2.4515   acc: 3.45% -> 3.45%               
client [84] (test)  loss: 2.3033 -> 2.2851   acc: 70.73% -> 68.29%             
client [10] (test)  loss: 1.7272 -> 1.5296   acc: 40.00% -> 40.00%             
client [36] (test)  loss: 1.7871 -> 1.4097   acc: 72.00% -> 72.00%             
client [65] (test)  loss: 1.1430 -> 1.0616   acc: 76.67% -> 76.67%             
client [81] (test)  loss: 2.3088 -> 2.3036   acc: 47.83% -> 47.83%             
client [79] (test)  loss: 0.6359 -> 0.5750   acc: 73.15% -> 73.15%             
client [42] (test)  loss: 0.8730 -> 0.8137   acc: 77.36% -> 77.36%             
client [11] (test)  loss: 2.2644 -> 2.2422   acc: 63.83% -> 65.96%             
client [96] (test)  loss: 0.5106 -> 0.4815   acc: 85.29% -> 85.29%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.9277 -> 1.8025   acc: 46.58% -> 46.58%              
client [53] (test)  loss: 2.0251 -> 1.7333   acc: 34.78% -> 34.78%             
client [52] (test)  loss: 2.1599 -> 2.0698   acc: 64.10% -> 64.10%             
client [42] (test)  loss: 0.7525 -> 0.7052   acc: 78.11% -> 82.64%             
client [69] (test)  loss: 0.3182 -> 0.2821   acc: 92.84% -> 93.35%             
client [59] (test)  loss: 0.1999 -> 0.1945   acc: 93.44% -> 93.44%             
client [7] (test)  loss: 2.2021 -> 2.1419   acc: 51.72% -> 49.43%              
client [26] (test)  loss: 1.7740 -> 1.3521   acc: 60.00% -> 60.00%             
client [49] (test)  loss: 0.3101 -> 0.2827   acc: 88.76% -> 89.96%             
client [98] (test)  loss: 1.0230 -> 0.9852   acc: 60.81% -> 60.81%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 0.9852 -> 0.9494   acc: 60.81% -> 60.81%             
client [47] (test)  loss: 2.1363 -> 2.0270   acc: 77.33% -> 77.33%             
client [21] (test)  loss: 2.4421 -> 2.4328   acc: 3.45% -> 3.45%               
client [77] (test)  loss: 0.9705 -> 0.9006   acc: 75.65% -> 75.65%             
client [95] (test)  loss: 0.7570 -> 0.5973   acc: 90.48% -> 90.48%             
client [91] (test)  loss: 1.9727 -> 1.8979   acc: 32.64% -> 38.89%             
client [14] (test)  loss: 1.9659 -> 1.8099   acc: 60.56% -> 60.56%             
client [99] (test)  loss: 0.8626 -> 0.4409   acc: 95.31% -> 95.31%             
client [20] (test)  loss: 0.8057 -> 0.7530   acc: 68.70% -> 74.78%             
client [39] (test)  loss: 2.0905 -> 1.9581   acc: 34.40% -> 34.40%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.0698 -> 1.9520   acc: 64.10% -> 66.67%             
client [62] (test)  loss: 0.0504 -> 0.0427   acc: 100.00% -> 100.00%           
client [71] (test)  loss: 0.1592 -> 0.1452   acc: 98.37% -> 98.37%             
client [97] (test)  loss: 2.0755 -> 1.9234   acc: 47.17% -> 45.28%             
client [30] (test)  loss: 0.4084 -> 0.3971   acc: 92.51% -> 92.51%             
client [88] (test)  loss: 2.2680 -> 2.2425   acc: 46.88% -> 46.88%             
client [60] (test)  loss: 2.1319 -> 2.0693   acc: 44.44% -> 40.00%             
client [82] (test)  loss: 0.5554 -> 0.5163   acc: 81.61% -> 92.53%             
client [91] (test)  loss: 1.8158 -> 1.7369   acc: 40.28% -> 43.06%             
client [57] (test)  loss: 1.6801 -> 1.3512   acc: 72.03% -> 72.03%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 0.6699 -> 0.6545   acc: 86.67% -> 86.67%             
client [15] (test)  loss: 0.6281 -> 0.6232   acc: 77.91% -> 77.91%             
client [71] (test)  loss: 0.1452 -> 0.1386   acc: 98.37% -> 98.37%             
client [97] (test)  loss: 1.5761 -> 1.4729   acc: 46.54% -> 49.06%             
client [53] (test)  loss: 1.3100 -> 1.1871   acc: 34.78% -> 37.68%             
client [77] (test)  loss: 0.9006 -> 0.8445   acc: 75.65% -> 75.65%             
client [76] (test)  loss: 1.7851 -> 1.6744   acc: 36.11% -> 36.11%             
client [79] (test)  loss: 0.4345 -> 0.3496   acc: 73.83% -> 81.21%             
client [28] (test)  loss: 2.3107 -> 2.3010   acc: 40.00% -> 48.00%             
client [99] (test)  loss: 0.3446 -> 0.3188   acc: 95.31% -> 95.31%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 1.3974 -> 1.3335   acc: 49.69% -> 53.46%             
client [86] (test)  loss: 0.7079 -> 0.6604   acc: 74.71% -> 77.59%             
client [34] (test)  loss: 1.3084 -> 1.2666   acc: 41.46% -> 50.41%             
client [73] (test)  loss: 2.1682 -> 2.1252   acc: 58.73% -> 57.14%             
client [5] (test)  loss: 2.0234 -> 1.9375   acc: 48.57% -> 48.57%              
client [96] (test)  loss: 0.4648 -> 0.4687   acc: 85.29% -> 85.29%             
client [22] (test)  loss: 2.1200 -> 2.0503   acc: 62.71% -> 62.71%             
client [60] (test)  loss: 1.7621 -> 1.6148   acc: 37.78% -> 37.78%             
client [66] (test)  loss: 2.1148 -> 2.0437   acc: 54.29% -> 54.29%             
client [83] (test)  loss: 0.0223 -> 0.0202   acc: 100.00% -> 100.00%           
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.5328 -> 1.4982   acc: 38.89% -> 38.89%             
client [65] (test)  loss: 0.8184 -> 0.6959   acc: 80.83% -> 82.50%             
client [95] (test)  loss: 0.5116 -> 0.5004   acc: 90.48% -> 90.48%             
client [17] (test)  loss: 1.3494 -> 1.2901   acc: 48.94% -> 48.94%             
client [8] (test)  loss: 1.2493 -> 1.1417   acc: 46.58% -> 46.58%              
client [35] (test)  loss: 2.1090 -> 2.0673   acc: 78.57% -> 92.86%             
client [98] (test)  loss: 0.8815 -> 0.8478   acc: 64.86% -> 68.92%             
client [53] (test)  loss: 1.0711 -> 0.9736   acc: 56.52% -> 66.67%             
client [43] (test)  loss: 2.1208 -> 2.0840   acc: 90.00% -> 90.00%             
client [64] (test)  loss: 1.3832 -> 1.2752   acc: 52.63% -> 50.88%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.4226 -> 2.4128   acc: 3.45% -> 3.45%               
client [88] (test)  loss: 1.8950 -> 1.7809   acc: 51.04% -> 52.08%             
client [38] (test)  loss: 0.2685 -> 0.2399   acc: 95.16% -> 95.97%             
client [3] (test)  loss: 0.2290 -> 0.2252   acc: 94.31% -> 94.31%              
client [5] (test)  loss: 1.8275 -> 1.6977   acc: 48.57% -> 48.57%              
client [41] (test)  loss: 0.7776 -> 0.7358   acc: 85.44% -> 85.44%             
client [7] (test)  loss: 1.9414 -> 1.7878   acc: 42.53% -> 40.23%              
client [37] (test)  loss: 0.1976 -> 0.1855   acc: 95.22% -> 95.22%             
client [45] (test)  loss: 0.9285 -> 0.8487   acc: 76.65% -> 75.77%             
client [47] (test)  loss: 1.6161 -> 1.2758   acc: 77.33% -> 77.33%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.4297 -> 1.3780   acc: 72.97% -> 72.97%             
client [11] (test)  loss: 1.8782 -> 1.7563   acc: 63.83% -> 63.83%             
client [37] (test)  loss: 0.1601 -> 0.1518   acc: 95.22% -> 95.22%             
client [41] (test)  loss: 0.7358 -> 0.6965   acc: 85.44% -> 85.44%             
client [95] (test)  loss: 0.4708 -> 0.4613   acc: 90.48% -> 90.48%             
client [53] (test)  loss: 0.9736 -> 0.8892   acc: 66.67% -> 68.12%             
client [22] (test)  loss: 1.9591 -> 1.8430   acc: 62.71% -> 62.71%             
client [25] (test)  loss: 1.6330 -> 1.4911   acc: 65.52% -> 65.52%             
client [69] (test)  loss: 0.2175 -> 0.2203   acc: 93.86% -> 93.86%             
client [46] (test)  loss: 1.5753 -> 1.4348   acc: 45.57% -> 45.57%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.6390 -> 0.6016   acc: 77.33% -> 77.33%             
client [69] (test)  loss: 0.2234 -> 0.2242   acc: 93.86% -> 93.86%             
client [82] (test)  loss: 0.3542 -> 0.3043   acc: 95.40% -> 88.51%             
client [45] (test)  loss: 0.7281 -> 0.6727   acc: 76.21% -> 77.09%             
client [7] (test)  loss: 1.7878 -> 1.6268   acc: 40.23% -> 35.63%              
client [50] (test)  loss: 0.9428 -> 0.8836   acc: 80.00% -> 80.00%             
client [35] (test)  loss: 1.9607 -> 1.8916   acc: 96.43% -> 92.86%             
client [24] (test)  loss: 0.2906 -> 0.2758   acc: 92.74% -> 91.94%             
client [15] (test)  loss: 0.6050 -> 0.5997   acc: 77.91% -> 77.91%             
client [58] (test)  loss: 1.1589 -> 0.9765   acc: 96.30% -> 96.30%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 0.5992 -> 0.5571   acc: 84.62% -> 83.76%             
client [76] (test)  loss: 1.4375 -> 1.4100   acc: 41.67% -> 41.67%             
client [67] (test)  loss: 0.2014 -> 0.1840   acc: 97.80% -> 97.80%             
client [37] (test)  loss: 0.1437 -> 0.1350   acc: 95.22% -> 95.22%             
client [58] (test)  loss: 0.7910 -> 0.6215   acc: 96.30% -> 96.30%             
client [64] (test)  loss: 1.0651 -> 1.0026   acc: 61.40% -> 66.67%             
client [77] (test)  loss: 0.7359 -> 0.7226   acc: 75.65% -> 75.65%             
client [55] (test)  loss: 1.0759 -> 1.0512   acc: 73.47% -> 73.47%             
client [12] (test)  loss: 0.0331 -> 0.0324   acc: 100.00% -> 100.00%           
client [89] (test)  loss: 1.0173 -> 0.9751   acc: 56.14% -> 60.53%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.4580 -> 1.4306   acc: 68.29% -> 70.73%             
client [51] (test)  loss: 0.4513 -> 0.3651   acc: 95.24% -> 95.24%             
client [8] (test)  loss: 1.0293 -> 1.0148   acc: 57.53% -> 57.53%              
client [18] (test)  loss: 0.9771 -> 0.9382   acc: 69.84% -> 69.84%             
client [94] (test)  loss: 0.7939 -> 0.7619   acc: 79.17% -> 80.30%             
client [81] (test)  loss: 2.2117 -> 2.2006   acc: 47.83% -> 47.83%             
client [3] (test)  loss: 0.2100 -> 0.2059   acc: 94.31% -> 94.31%              
client [11] (test)  loss: 1.3118 -> 1.2018   acc: 63.83% -> 63.83%             
client [95] (test)  loss: 0.4130 -> 0.4064   acc: 90.48% -> 90.48%             
client [67] (test)  loss: 0.1840 -> 0.1748   acc: 97.80% -> 97.80%             
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.3921 -> 2.3806   acc: 27.59% -> 27.59%             
client [79] (test)  loss: 0.1210 -> 0.1173   acc: 96.98% -> 96.98%             
client [58] (test)  loss: 0.3347 -> 0.2950   acc: 96.30% -> 96.30%             
client [88] (test)  loss: 1.4897 -> 1.4317   acc: 61.46% -> 61.46%             
client [46] (test)  loss: 1.1411 -> 1.0709   acc: 53.16% -> 55.70%             
client [11] (test)  loss: 1.2018 -> 1.1160   acc: 63.83% -> 72.34%             
client [55] (test)  loss: 0.9437 -> 0.9239   acc: 73.47% -> 73.47%             
client [13] (test)  loss: 1.4631 -> 1.3358   acc: 61.70% -> 61.70%             
client [31] (test)  loss: 0.6073 -> 0.5908   acc: 86.67% -> 86.67%             
client [75] (test)  loss: 0.7519 -> 0.7147   acc: 83.51% -> 83.51%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.2149 -> 1.1707   acc: 69.35% -> 69.35%             
client [7] (test)  loss: 1.3097 -> 1.2738   acc: 43.68% -> 45.98%              
client [57] (test)  loss: 0.6171 -> 0.5935   acc: 87.29% -> 87.29%             
client [13] (test)  loss: 1.2192 -> 1.1168   acc: 61.70% -> 65.96%             
client [43] (test)  loss: 1.6759 -> 1.5513   acc: 90.00% -> 90.00%             
client [91] (test)  loss: 1.4673 -> 1.4131   acc: 50.00% -> 52.78%             
client [10] (test)  loss: 0.7987 -> 0.7621   acc: 78.95% -> 78.95%             
client [64] (test)  loss: 0.7666 -> 0.7282   acc: 80.70% -> 80.70%             
client [82] (test)  loss: 0.1594 -> 0.4797   acc: 98.28% -> 85.06%             
client [22] (test)  loss: 1.2523 -> 1.2113   acc: 62.71% -> 62.71%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.5739 -> 0.5518   acc: 80.87% -> 80.87%             
client [23] (test)  loss: 1.7045 -> 1.5801   acc: 51.85% -> 51.85%             
client [88] (test)  loss: 1.4317 -> 1.3837   acc: 61.46% -> 62.50%             
client [98] (test)  loss: 0.5491 -> 0.5182   acc: 81.08% -> 82.43%             
client [79] (test)  loss: 0.1167 -> 0.1152   acc: 97.32% -> 97.32%             
client [21] (test)  loss: 2.3676 -> 2.3531   acc: 27.59% -> 27.59%             
client [92] (test)  loss: 0.0191 -> 0.0185   acc: 100.00% -> 100.00%           
client [56] (test)  loss: 0.6952 -> 0.6827   acc: 83.72% -> 88.37%             
client [5] (test)  loss: 1.4013 -> 1.4242   acc: 48.57% -> 51.43%              
client [52] (test)  loss: 0.8284 -> 0.8219   acc: 69.23% -> 69.23%             
Training... ---------------------------------------- 100% 0:03:18
==================== Ditto TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '0.9218 -> 0.0000', 'accuracy': '75.85% -> 0.00%'},          
    200: {'loss': '0.5351 -> 0.0000', 'accuracy': '83.33% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
Ditto achieved 10.0%(11.82%) at epoch: 0                                       
Ditto achieved 20.0%(21.72%) at epoch: 1                                       
Ditto achieved 30.0%(36.71%) at epoch: 2                                       
Ditto achieved 60.0%(67.59%) at epoch: 7                                       
Ditto achieved 70.0%(76.31%) at epoch: 26                                      
Ditto achieved 80.0%(81.29%) at epoch: 64                                      
Ditto achieved 90.0%(92.53%) at epoch: 192                                     
Convergence (test_after):                                                      
Ditto achieved 30.0%(32.37%) at epoch: 0                                       
Ditto achieved 50.0%(58.69%) at epoch: 1                                       
Ditto achieved 70.0%(70.12%) at epoch: 5                                       
Ditto achieved 80.0%(80.94%) at epoch: 26                                      
Ditto achieved 90.0%(91.03%) at epoch: 191                                     
