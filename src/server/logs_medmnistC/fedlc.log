Setting up a new session...
==================== ALGORITHM: FedLC ====================                     
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'tau': 1.0,                                                                
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 1.8933 -> 1.6367   acc: 0.00% -> 7.83%               
client [81] (test)  loss: 2.2584 -> 2.1613   acc: 13.04% -> 26.09%             
client [21] (test)  loss: 2.5441 -> 2.4803   acc: 0.00% -> 0.00%               
client [68] (test)  loss: 1.1426 -> 1.0680   acc: 89.80% -> 89.80%             
client [93] (test)  loss: 2.6534 -> 1.8190   acc: 1.10% -> 23.08%              
client [31] (test)  loss: 2.3809 -> 0.9431   acc: 0.00% -> 86.67%              
client [20] (test)  loss: 2.0268 -> 1.5858   acc: 0.00% -> 18.26%              
client [59] (test)  loss: 2.3660 -> 1.3258   acc: 0.00% -> 83.61%              
client [48] (test)  loss: 1.9676 -> 1.5533   acc: 5.98% -> 24.79%              
client [34] (test)  loss: 2.1939 -> 1.5366   acc: 33.33% -> 68.29%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 3.4827 -> 1.0998   acc: 8.70% -> 86.45%              
client [99] (test)  loss: 1.2171 -> 0.3692   acc: 93.75% -> 95.31%             
client [67] (test)  loss: 1.9819 -> 2.2434   acc: 65.93% -> 43.96%             
client [0] (test)  loss: 2.1321 -> 1.7982   acc: 10.17% -> 28.81%              
client [76] (test)  loss: 2.0314 -> 1.4254   acc: 27.78% -> 66.67%             
client [41] (test)  loss: 2.5995 -> 1.1760   acc: 3.88% -> 84.47%              
client [62] (test)  loss: 2.3192 -> 2.3221   acc: 28.19% -> 10.07%             
client [2] (test)  loss: 2.3320 -> 1.3075   acc: 10.96% -> 85.62%              
client [14] (test)  loss: 2.0851 -> 2.0044   acc: 11.27% -> 9.86%              
client [46] (test)  loss: 2.8526 -> 1.6340   acc: 5.06% -> 50.63%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.3328 -> 0.6120   acc: 25.00% -> 91.13%             
client [68] (test)  loss: 1.4516 -> 1.0037   acc: 37.76% -> 82.65%             
client [57] (test)  loss: 1.4805 -> 0.6562   acc: 43.22% -> 88.14%             
client [17] (test)  loss: 1.5624 -> 1.0570   acc: 58.51% -> 69.15%             
client [54] (test)  loss: 2.3302 -> 1.3106   acc: 20.87% -> 69.57%             
client [23] (test)  loss: 2.2526 -> 1.7021   acc: 3.70% -> 66.67%              
client [35] (test)  loss: 1.7422 -> 1.7544   acc: 32.14% -> 28.57%             
client [59] (test)  loss: 1.9004 -> 0.4613   acc: 38.52% -> 91.80%             
client [31] (test)  loss: 1.5967 -> 0.4983   acc: 47.78% -> 86.67%             
client [9] (test)  loss: 1.5744 -> 1.0431   acc: 54.76% -> 66.67%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 1.7792 -> 1.0893   acc: 14.04% -> 68.42%             
client [33] (test)  loss: 1.6964 -> 1.1002   acc: 47.46% -> 71.19%             
client [16] (test)  loss: 1.9848 -> 1.9004   acc: 27.03% -> 37.84%             
client [44] (test)  loss: 1.3882 -> 0.6577   acc: 65.22% -> 90.82%             
client [8] (test)  loss: 1.7969 -> 0.9561   acc: 30.14% -> 73.97%              
client [31] (test)  loss: 1.5812 -> 0.4538   acc: 38.89% -> 88.89%             
client [47] (test)  loss: 1.5491 -> 0.9955   acc: 37.33% -> 78.67%             
client [36] (test)  loss: 1.1722 -> 0.6827   acc: 73.14% -> 87.43%             
client [20] (test)  loss: 1.8490 -> 0.8557   acc: 14.78% -> 79.13%             
client [56] (test)  loss: 2.6129 -> 1.1233   acc: 16.28% -> 72.09%             
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 1.1200 -> 1.0567   acc: 61.54% -> 61.54%              
client [60] (test)  loss: 1.4975 -> 1.2069   acc: 40.00% -> 62.22%             
client [28] (test)  loss: 1.8354 -> 1.5808   acc: 48.00% -> 52.00%             
client [25] (test)  loss: 1.5492 -> 0.7933   acc: 32.18% -> 75.86%             
client [58] (test)  loss: 2.7189 -> 0.6717   acc: 0.00% -> 92.59%              
client [44] (test)  loss: 1.5748 -> 0.7447   acc: 4.83% -> 75.36%              
client [39] (test)  loss: 2.1322 -> 1.7242   acc: 20.80% -> 38.40%             
client [29] (test)  loss: 2.9301 -> 1.7050   acc: 12.50% -> 35.71%             
client [3] (test)  loss: 2.7389 -> 1.1704   acc: 8.13% -> 64.23%               
client [84] (test)  loss: 2.1469 -> 1.5616   acc: 34.15% -> 60.98%             
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.6317 -> 2.3834   acc: 10.34% -> 34.48%             
client [84] (test)  loss: 1.6440 -> 1.4742   acc: 51.22% -> 60.98%             
client [10] (test)  loss: 1.1509 -> 0.7455   acc: 68.42% -> 76.84%             
client [36] (test)  loss: 1.0830 -> 0.5329   acc: 63.43% -> 88.00%             
client [65] (test)  loss: 1.7711 -> 1.0012   acc: 47.50% -> 71.67%             
client [81] (test)  loss: 1.4570 -> 1.3329   acc: 47.83% -> 56.52%             
client [79] (test)  loss: 2.8896 -> 1.9025   acc: 15.77% -> 23.15%             
client [42] (test)  loss: 1.3177 -> 0.5691   acc: 45.66% -> 92.08%             
client [11] (test)  loss: 1.1503 -> 1.1488   acc: 59.57% -> 61.70%             
client [96] (test)  loss: 2.0497 -> 0.6385   acc: 26.47% -> 82.35%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 1.7502 -> 0.7039   acc: 32.88% -> 75.34%              
client [53] (test)  loss: 1.7543 -> 1.1442   acc: 26.09% -> 47.83%             
client [52] (test)  loss: 1.3365 -> 1.6534   acc: 53.85% -> 35.90%             
client [42] (test)  loss: 1.4416 -> 0.5064   acc: 40.38% -> 91.70%             
client [69] (test)  loss: 2.4668 -> 1.4444   acc: 10.23% -> 45.27%             
client [59] (test)  loss: 2.1341 -> 0.4255   acc: 13.11% -> 88.52%             
client [7] (test)  loss: 2.4712 -> 0.9612   acc: 22.99% -> 73.56%              
client [26] (test)  loss: 0.9408 -> 0.4991   acc: 60.69% -> 93.10%             
client [49] (test)  loss: 0.4935 -> 0.2794   acc: 88.46% -> 94.90%             
client [98] (test)  loss: 1.6731 -> 0.6014   acc: 28.38% -> 74.32%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 1.2609 -> 0.6242   acc: 48.65% -> 72.97%             
client [47] (test)  loss: 0.6330 -> 0.5201   acc: 86.67% -> 93.33%             
client [21] (test)  loss: 2.6808 -> 2.6819   acc: 10.34% -> 44.83%             
client [77] (test)  loss: 1.5375 -> 0.5360   acc: 44.35% -> 86.96%             
client [95] (test)  loss: 1.0440 -> 0.4459   acc: 64.29% -> 88.10%             
client [91] (test)  loss: 1.0295 -> 0.8999   acc: 70.83% -> 71.53%             
client [14] (test)  loss: 1.4525 -> 1.0418   acc: 46.48% -> 54.93%             
client [99] (test)  loss: 0.6958 -> 0.2096   acc: 73.44% -> 95.31%             
client [20] (test)  loss: 1.2667 -> 0.5119   acc: 51.30% -> 85.22%             
client [39] (test)  loss: 1.8288 -> 1.4037   acc: 33.60% -> 49.60%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 1.1482 -> 1.4527   acc: 56.41% -> 41.03%             
client [62] (test)  loss: 4.5865 -> 4.9543   acc: 7.38% -> 6.04%               
client [71] (test)  loss: 0.7509 -> 0.4626   acc: 79.67% -> 88.62%             
client [97] (test)  loss: 0.8392 -> 0.7329   acc: 72.96% -> 81.13%             
client [30] (test)  loss: 1.7902 -> 0.4444   acc: 42.78% -> 93.58%             
client [88] (test)  loss: 1.4658 -> 0.8449   acc: 55.21% -> 71.88%             
client [60] (test)  loss: 0.9215 -> 0.7531   acc: 75.56% -> 84.44%             
client [82] (test)  loss: 1.3190 -> 1.2066   acc: 63.22% -> 70.11%             
client [91] (test)  loss: 1.0033 -> 0.8350   acc: 71.53% -> 77.08%             
client [57] (test)  loss: 0.6400 -> 0.3315   acc: 83.90% -> 93.22%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.3095 -> 0.2632   acc: 22.22% -> 94.44%             
client [15] (test)  loss: 1.1770 -> 0.4517   acc: 73.26% -> 84.88%             
client [71] (test)  loss: 0.3622 -> 0.3072   acc: 88.62% -> 91.87%             
client [97] (test)  loss: 0.9436 -> 0.6909   acc: 62.26% -> 80.50%             
client [53] (test)  loss: 1.6098 -> 1.1371   acc: 37.68% -> 53.62%             
client [77] (test)  loss: 1.1593 -> 0.6502   acc: 50.43% -> 80.87%             
client [76] (test)  loss: 0.6241 -> 0.5832   acc: 88.89% -> 86.11%             
client [79] (test)  loss: 2.2791 -> 1.4202   acc: 20.81% -> 48.32%             
client [28] (test)  loss: 1.8453 -> 1.8012   acc: 44.00% -> 52.00%             
client [99] (test)  loss: 0.3194 -> 0.1669   acc: 92.19% -> 95.31%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 0.7000 -> 0.6370   acc: 77.99% -> 80.50%             
client [86] (test)  loss: 2.3880 -> 0.8649   acc: 36.78% -> 76.44%             
client [34] (test)  loss: 1.3576 -> 0.6415   acc: 61.79% -> 83.74%             
client [73] (test)  loss: 1.2902 -> 0.7624   acc: 49.21% -> 68.25%             
client [5] (test)  loss: 0.5072 -> 0.9343   acc: 77.14% -> 71.43%              
client [96] (test)  loss: 2.4285 -> 0.5806   acc: 13.24% -> 83.82%             
client [22] (test)  loss: 0.8562 -> 0.7207   acc: 74.58% -> 81.36%             
client [60] (test)  loss: 0.9401 -> 0.5818   acc: 75.56% -> 84.44%             
client [66] (test)  loss: 1.1843 -> 0.4004   acc: 54.29% -> 85.71%             
client [83] (test)  loss: 1.1728 -> 0.9769   acc: 53.85% -> 65.38%             
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 0.6410 -> 0.6367   acc: 80.56% -> 83.33%             
client [65] (test)  loss: 1.3854 -> 0.8350   acc: 45.00% -> 70.00%             
client [95] (test)  loss: 1.2567 -> 0.4972   acc: 52.38% -> 84.52%             
client [17] (test)  loss: 0.9661 -> 0.7805   acc: 65.96% -> 71.28%             
client [8] (test)  loss: 1.1545 -> 0.4227   acc: 63.01% -> 86.30%              
client [35] (test)  loss: 1.0967 -> 1.4938   acc: 57.14% -> 50.00%             
client [98] (test)  loss: 2.0088 -> 0.4853   acc: 20.27% -> 81.08%             
client [53] (test)  loss: 1.9628 -> 1.3245   acc: 33.33% -> 50.72%             
client [43] (test)  loss: 0.4329 -> 0.3819   acc: 80.00% -> 95.00%             
client [64] (test)  loss: 1.8132 -> 1.1504   acc: 42.11% -> 61.40%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.1058 -> 1.9734   acc: 34.48% -> 48.28%             
client [88] (test)  loss: 1.1675 -> 0.8040   acc: 64.58% -> 72.92%             
client [38] (test)  loss: 0.5166 -> 0.2045   acc: 85.48% -> 97.58%             
client [3] (test)  loss: 2.5889 -> 0.6199   acc: 28.46% -> 78.05%              
client [5] (test)  loss: 0.3417 -> 0.8973   acc: 85.71% -> 74.29%              
client [41] (test)  loss: 0.7061 -> 0.2906   acc: 76.70% -> 94.17%             
client [7] (test)  loss: 2.4570 -> 0.6168   acc: 31.03% -> 82.76%              
client [37] (test)  loss: 0.5110 -> 0.1639   acc: 80.06% -> 95.93%             
client [45] (test)  loss: 1.0098 -> 0.4421   acc: 66.96% -> 88.11%             
client [47] (test)  loss: 0.4923 -> 0.3039   acc: 85.33% -> 92.00%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 1.8512 -> 1.3165   acc: 37.84% -> 54.05%             
client [11] (test)  loss: 0.8471 -> 0.9205   acc: 78.72% -> 78.72%             
client [37] (test)  loss: 0.2447 -> 0.1564   acc: 92.42% -> 95.65%             
client [41] (test)  loss: 0.8225 -> 0.4359   acc: 71.84% -> 84.47%             
client [95] (test)  loss: 1.2231 -> 0.3924   acc: 55.95% -> 84.52%             
client [53] (test)  loss: 2.3064 -> 1.3749   acc: 28.99% -> 49.28%             
client [22] (test)  loss: 1.2069 -> 0.9179   acc: 55.93% -> 69.49%             
client [25] (test)  loss: 1.1045 -> 0.4662   acc: 68.97% -> 86.21%             
client [69] (test)  loss: 2.3333 -> 1.1523   acc: 24.81% -> 62.40%             
client [46] (test)  loss: 1.2132 -> 0.7599   acc: 53.16% -> 78.48%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 0.7347 -> 0.4794   acc: 73.33% -> 81.33%             
client [69] (test)  loss: 2.6261 -> 1.0166   acc: 13.55% -> 61.89%             
client [82] (test)  loss: 2.4346 -> 0.9688   acc: 28.16% -> 76.44%             
client [45] (test)  loss: 1.3246 -> 0.5619   acc: 54.63% -> 82.38%             
client [7] (test)  loss: 2.1705 -> 0.6729   acc: 27.59% -> 80.46%              
client [50] (test)  loss: 1.2268 -> 0.6856   acc: 53.33% -> 79.17%             
client [35] (test)  loss: 1.0985 -> 0.8309   acc: 46.43% -> 60.71%             
client [24] (test)  loss: 0.2706 -> 0.1695   acc: 94.35% -> 95.97%             
client [15] (test)  loss: 3.3476 -> 0.3254   acc: 9.30% -> 86.05%              
client [58] (test)  loss: 0.7099 -> 0.4771   acc: 81.48% -> 88.89%             
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 1.0049 -> 0.4753   acc: 69.23% -> 88.03%             
client [76] (test)  loss: 0.4325 -> 0.5058   acc: 77.78% -> 83.33%             
client [67] (test)  loss: 5.3541 -> 4.8556   acc: 4.40% -> 4.40%               
client [37] (test)  loss: 0.4680 -> 0.1200   acc: 83.99% -> 96.49%             
client [58] (test)  loss: 1.6437 -> 0.8733   acc: 48.15% -> 62.96%             
client [64] (test)  loss: 1.0246 -> 1.0565   acc: 59.65% -> 64.91%             
client [77] (test)  loss: 1.0665 -> 0.3869   acc: 66.09% -> 88.70%             
client [55] (test)  loss: 2.4816 -> 0.7374   acc: 24.49% -> 77.55%             
client [12] (test)  loss: 1.3748 -> 1.9624   acc: 51.23% -> 38.89%             
client [89] (test)  loss: 0.4718 -> 0.4124   acc: 83.33% -> 85.96%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 2.2894 -> 1.3087   acc: 46.34% -> 65.85%             
client [51] (test)  loss: 3.0940 -> 2.3053   acc: 28.57% -> 47.62%             
client [8] (test)  loss: 1.3537 -> 0.4673   acc: 58.90% -> 84.93%              
client [18] (test)  loss: 1.0599 -> 0.3649   acc: 68.25% -> 88.10%             
client [94] (test)  loss: 0.7771 -> 0.4183   acc: 77.27% -> 85.61%             
client [81] (test)  loss: 1.1849 -> 1.4156   acc: 60.87% -> 65.22%             
client [3] (test)  loss: 1.7873 -> 0.3634   acc: 50.41% -> 85.37%              
client [11] (test)  loss: 0.9150 -> 0.9026   acc: 74.47% -> 76.60%             
client [95] (test)  loss: 0.5419 -> 0.2337   acc: 79.76% -> 94.05%             
client [67] (test)  loss: 5.7370 -> 5.0499   acc: 3.30% -> 4.40%               
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.7713 -> 4.4949   acc: 13.79% -> 37.93%             
client [79] (test)  loss: 1.6960 -> 1.2852   acc: 38.59% -> 50.67%             
client [58] (test)  loss: 2.3305 -> 0.7272   acc: 51.85% -> 59.26%             
client [88] (test)  loss: 1.3241 -> 0.7896   acc: 62.50% -> 75.00%             
client [46] (test)  loss: 1.2514 -> 0.7250   acc: 54.43% -> 74.68%             
client [11] (test)  loss: 0.6908 -> 0.8519   acc: 80.85% -> 80.85%             
client [55] (test)  loss: 1.3729 -> 0.6950   acc: 46.94% -> 83.67%             
client [13] (test)  loss: 2.2544 -> 1.4014   acc: 53.19% -> 55.32%             
client [31] (test)  loss: 1.2149 -> 0.2402   acc: 54.44% -> 94.44%             
client [75] (test)  loss: 1.1702 -> 0.7629   acc: 67.01% -> 76.29%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.0767 -> 0.6518   acc: 60.48% -> 75.81%             
client [7] (test)  loss: 2.8106 -> 0.7018   acc: 27.59% -> 79.31%              
client [57] (test)  loss: 0.2646 -> 0.2148   acc: 92.37% -> 94.07%             
client [13] (test)  loss: 2.6870 -> 1.3431   acc: 44.68% -> 53.19%             
client [43] (test)  loss: 0.2762 -> 0.2935   acc: 90.00% -> 90.00%             
client [91] (test)  loss: 1.2429 -> 0.7178   acc: 62.50% -> 78.47%             
client [10] (test)  loss: 0.8769 -> 0.4466   acc: 75.79% -> 87.37%             
client [64] (test)  loss: 0.8409 -> 1.1690   acc: 73.68% -> 59.65%             
client [82] (test)  loss: 1.4807 -> 0.9364   acc: 59.77% -> 77.59%             
client [22] (test)  loss: 1.0356 -> 0.7921   acc: 62.71% -> 76.27%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 0.7613 -> 0.3877   acc: 69.57% -> 84.35%             
client [23] (test)  loss: 0.6958 -> 0.3510   acc: 72.22% -> 92.59%             
client [88] (test)  loss: 1.2114 -> 0.7740   acc: 64.58% -> 75.00%             
client [98] (test)  loss: 0.9670 -> 0.3969   acc: 55.41% -> 81.08%             
client [79] (test)  loss: 1.7067 -> 1.1407   acc: 38.26% -> 59.06%             
client [21] (test)  loss: 2.5226 -> 2.8979   acc: 13.79% -> 44.83%             
client [92] (test)  loss: 4.7715 -> 5.0908   acc: 23.60% -> 17.60%             
client [56] (test)  loss: 2.1710 -> 0.7222   acc: 37.21% -> 81.40%             
client [5] (test)  loss: 0.3165 -> 1.0074   acc: 85.71% -> 71.43%              
client [52] (test)  loss: 1.3469 -> 1.2924   acc: 53.85% -> 61.54%             
Training... ---------------------------------------- 100% 0:03:30
==================== FedLC TEST RESULTS: ====================                  
{                                                                              
    100: {'loss': '1.5543 -> 0.0000', 'accuracy': '55.04% -> 0.00%'},          
    200: {'loss': '1.5133 -> 0.0000', 'accuracy': '58.49% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
FedLC achieved 10.0%(11.82%) at epoch: 0                                       
FedLC achieved 20.0%(21.29%) at epoch: 3                                       
FedLC achieved 50.0%(50.18%) at epoch: 7                                       
FedLC achieved 60.0%(63.84%) at epoch: 62                                      
FedLC achieved 70.0%(70.88%) at epoch: 118                                     
FedLC achieved 80.0%(80.79%) at epoch: 135                                     
Convergence (test_after):                                                      
FedLC achieved 50.0%(59.21%) at epoch: 0                                       
FedLC achieved 60.0%(64.44%) at epoch: 1                                       
FedLC achieved 80.0%(81.67%) at epoch: 5                                       
FedLC achieved 90.0%(90.70%) at epoch: 122                                     
