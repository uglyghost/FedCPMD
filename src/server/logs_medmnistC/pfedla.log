Setting up a new session...
==================== ALGORITHM: pFedLA ====================                    
Experiment Arguments:                                                          
{                                                                              
    'model': 'lenet5',                                                         
    'dataset': 'medmnistC',                                                    
    'seed': 42,                                                                
    'join_ratio': 0.1,                                                         
    'global_epoch': 200,                                                       
    'local_epoch': 5,                                                          
    'finetune_epoch': 0,                                                       
    'test_gap': 100,                                                           
    'eval_test': 1,                                                            
    'eval_train': 0,                                                           
    'local_lr': 0.01,                                                          
    'momentum': 0.0,                                                           
    'weight_decay': 0.0,                                                       
    'verbose_gap': 10,                                                         
    'batch_size': 32,                                                          
    'visible': 1,                                                              
    'global_testset': 0,                                                       
    'straggler_ratio': 0,                                                      
    'straggler_min_local_epoch': 1,                                            
    'external_model_params_file': '',                                          
    'use_cuda': 1,                                                             
    'save_log': 1,                                                             
    'save_model': 0,                                                           
    'save_fig': 1,                                                             
    'save_metrics': 1,                                                         
    'viz_win_name': None,                                                      
    'k': 0,                                                                    
    'hn_lr': 0.005,                                                            
    'hn_momentum': 0.0,                                                        
    'embedding_dim': 100,                                                      
    'hidden_dim': 100,                                                         
    'dataset_args': {                                                          
        'dataset': 'medmnistC',                                                
        'client_num': 100,                                                     
        'fraction': 0.5,                                                       
        'seed': 42,                                                            
        'split': 'sample',                                                     
        'alpha': 0.1,                                                          
        'least_samples': 40                                                    
    }                                                                          
}                                                                              
-------------------------- TRAINING EPOCH: 10 --------------------------       
client [77] (test)  loss: 2.3379 -> 1.0227   acc: 0.00% -> 75.65%              
client [81] (test)  loss: 2.3084 -> 2.2272   acc: 17.39% -> 43.48%             
client [21] (test)  loss: 2.5032 -> 2.4463   acc: 3.45% -> 3.45%               
client [68] (test)  loss: 2.0901 -> 0.4019   acc: 89.29% -> 89.80%             
client [93] (test)  loss: 2.4500 -> 1.7650   acc: 2.20% -> 81.32%              
client [31] (test)  loss: 2.4073 -> 1.1026   acc: 0.00% -> 86.67%              
client [20] (test)  loss: 2.4495 -> 1.1552   acc: 0.87% -> 68.70%              
client [59] (test)  loss: 2.3624 -> 0.4641   acc: 4.92% -> 93.44%              
client [48] (test)  loss: 2.4467 -> 1.2543   acc: 0.00% -> 61.54%              
client [34] (test)  loss: 2.4114 -> 1.7264   acc: 10.57% -> 58.54%             
-------------------------- TRAINING EPOCH: 20 --------------------------       
client [69] (test)  loss: 2.6643 -> 0.4279   acc: 0.00% -> 84.65%              
client [99] (test)  loss: 2.0133 -> 0.3117   acc: 95.31% -> 95.31%             
client [67] (test)  loss: 2.6843 -> 0.7123   acc: 0.00% -> 97.80%              
client [0] (test)  loss: 2.3527 -> 2.0222   acc: 0.00% -> 35.59%               
client [76] (test)  loss: 2.3502 -> 1.7642   acc: 0.00% -> 36.11%              
client [41] (test)  loss: 2.2660 -> 0.8297   acc: 1.94% -> 85.44%              
client [62] (test)  loss: 2.4354 -> 0.2693   acc: 0.00% -> 100.00%             
client [2] (test)  loss: 2.3566 -> 0.9444   acc: 1.37% -> 78.08%               
client [14] (test)  loss: 2.3594 -> 1.4615   acc: 1.41% -> 60.56%              
client [46] (test)  loss: 2.5141 -> 1.5950   acc: 0.00% -> 50.63%              
-------------------------- TRAINING EPOCH: 30 --------------------------       
client [24] (test)  loss: 1.7196 -> 0.6386   acc: 75.81% -> 77.42%             
client [68] (test)  loss: 1.7227 -> 0.3502   acc: 89.80% -> 89.80%             
client [57] (test)  loss: 1.8987 -> 0.8881   acc: 72.03% -> 72.03%             
client [17] (test)  loss: 2.1484 -> 1.1911   acc: 7.45% -> 63.83%              
client [54] (test)  loss: 2.6355 -> 1.4416   acc: 0.00% -> 57.39%              
client [23] (test)  loss: 2.3647 -> 1.9140   acc: 5.56% -> 68.52%              
client [35] (test)  loss: 2.4434 -> 1.9277   acc: 0.00% -> 46.43%              
client [59] (test)  loss: 2.1735 -> 0.2094   acc: 0.00% -> 93.44%              
client [31] (test)  loss: 2.4093 -> 0.6698   acc: 0.00% -> 86.67%              
client [9] (test)  loss: 2.1849 -> 1.2733   acc: 47.62% -> 95.24%              
-------------------------- TRAINING EPOCH: 40 --------------------------       
client [64] (test)  loss: 2.1843 -> 0.9712   acc: 0.00% -> 80.70%              
client [33] (test)  loss: 2.5110 -> 1.5192   acc: 0.00% -> 72.88%              
client [16] (test)  loss: 2.3386 -> 1.1709   acc: 0.00% -> 72.97%              
client [44] (test)  loss: 2.0383 -> 0.5637   acc: 71.98% -> 79.23%             
client [8] (test)  loss: 2.2520 -> 1.0570   acc: 1.37% -> 45.21%               
client [31] (test)  loss: 2.3076 -> 0.6384   acc: 0.00% -> 86.67%              
client [47] (test)  loss: 2.2087 -> 0.6922   acc: 1.33% -> 77.33%              
client [36] (test)  loss: 2.1644 -> 0.8157   acc: 0.57% -> 72.00%              
client [20] (test)  loss: 2.3948 -> 0.8225   acc: 0.00% -> 68.70%              
client [56] (test)  loss: 2.5794 -> 1.0756   acc: 0.00% -> 72.09%              
-------------------------- TRAINING EPOCH: 50 --------------------------       
client [4] (test)  loss: 2.3465 -> 1.2113   acc: 11.54% -> 73.08%              
client [60] (test)  loss: 2.3254 -> 1.1756   acc: 2.22% -> 75.56%              
client [28] (test)  loss: 2.3754 -> 1.7959   acc: 4.00% -> 60.00%              
client [25] (test)  loss: 2.0797 -> 1.2183   acc: 17.24% -> 65.52%             
client [58] (test)  loss: 2.2097 -> 0.4983   acc: 0.00% -> 96.30%              
client [44] (test)  loss: 1.9470 -> 0.5229   acc: 72.46% -> 79.23%             
client [39] (test)  loss: 2.4104 -> 1.3094   acc: 2.40% -> 42.40%              
client [29] (test)  loss: 2.4827 -> 1.1901   acc: 8.93% -> 57.14%              
client [3] (test)  loss: 2.5736 -> 0.2711   acc: 0.00% -> 94.31%               
client [84] (test)  loss: 2.4498 -> 1.4797   acc: 0.00% -> 68.29%              
-------------------------- TRAINING EPOCH: 60 --------------------------       
client [21] (test)  loss: 2.5475 -> 2.1175   acc: 0.00% -> 41.38%              
client [84] (test)  loss: 2.3883 -> 1.4175   acc: 0.00% -> 68.29%              
client [10] (test)  loss: 2.1062 -> 0.9577   acc: 32.63% -> 65.26%             
client [36] (test)  loss: 2.0186 -> 0.7266   acc: 10.86% -> 72.00%             
client [65] (test)  loss: 2.1999 -> 0.6540   acc: 25.83% -> 82.50%             
client [81] (test)  loss: 2.1718 -> 1.6151   acc: 13.04% -> 47.83%             
client [79] (test)  loss: 2.6655 -> 0.2945   acc: 0.00% -> 87.92%              
client [42] (test)  loss: 2.1567 -> 0.6583   acc: 13.58% -> 80.75%             
client [11] (test)  loss: 2.0066 -> 0.9177   acc: 63.83% -> 72.34%             
client [96] (test)  loss: 2.0969 -> 0.4552   acc: 44.12% -> 85.29%             
-------------------------- TRAINING EPOCH: 70 --------------------------       
client [8] (test)  loss: 2.1674 -> 0.9857   acc: 5.48% -> 43.84%               
client [53] (test)  loss: 2.3065 -> 0.5809   acc: 28.99% -> 84.06%             
client [52] (test)  loss: 2.1909 -> 1.1228   acc: 33.33% -> 66.67%             
client [42] (test)  loss: 2.1346 -> 0.6378   acc: 17.74% -> 80.75%             
client [69] (test)  loss: 2.6763 -> 0.2683   acc: 0.00% -> 93.09%              
client [59] (test)  loss: 2.2102 -> 0.1536   acc: 10.66% -> 93.44%             
client [7] (test)  loss: 2.3731 -> 1.2611   acc: 1.15% -> 55.17%               
client [26] (test)  loss: 2.0426 -> 0.4949   acc: 53.79% -> 77.93%             
client [49] (test)  loss: 1.9793 -> 0.2287   acc: 69.42% -> 92.80%             
client [98] (test)  loss: 2.1772 -> 0.6560   acc: 39.19% -> 77.03%             
-------------------------- TRAINING EPOCH: 80 --------------------------       
client [98] (test)  loss: 2.1632 -> 0.6033   acc: 41.89% -> 79.73%             
client [47] (test)  loss: 2.2027 -> 0.4678   acc: 6.67% -> 85.33%              
client [21] (test)  loss: 2.5230 -> 1.8365   acc: 0.00% -> 41.38%              
client [77] (test)  loss: 2.1307 -> 0.6804   acc: 14.78% -> 75.65%             
client [95] (test)  loss: 2.2150 -> 0.4334   acc: 8.33% -> 90.48%              
client [91] (test)  loss: 2.0427 -> 1.6111   acc: 43.06% -> 37.50%             
client [14] (test)  loss: 2.2031 -> 1.0752   acc: 12.68% -> 60.56%             
client [99] (test)  loss: 1.7273 -> 0.2513   acc: 92.19% -> 95.31%             
client [20] (test)  loss: 2.3809 -> 0.6095   acc: 3.48% -> 83.48%              
client [39] (test)  loss: 2.2817 -> 1.1155   acc: 13.60% -> 50.40%             
-------------------------- TRAINING EPOCH: 90 --------------------------       
client [52] (test)  loss: 2.0541 -> 0.9860   acc: 41.03% -> 69.23%             
client [62] (test)  loss: 2.3978 -> 0.0219   acc: 0.00% -> 100.00%             
client [71] (test)  loss: 1.8030 -> 0.0954   acc: 90.24% -> 98.37%             
client [97] (test)  loss: 2.1078 -> 1.1936   acc: 25.16% -> 61.01%             
client [30] (test)  loss: 2.1445 -> 0.3586   acc: 14.97% -> 92.51%             
client [88] (test)  loss: 2.0944 -> 1.2704   acc: 30.21% -> 63.54%             
client [60] (test)  loss: 2.2390 -> 0.8616   acc: 13.33% -> 75.56%             
client [82] (test)  loss: 2.2949 -> 0.0968   acc: 31.61% -> 99.43%             
client [91] (test)  loss: 2.0135 -> 1.5712   acc: 45.83% -> 36.81%             
client [57] (test)  loss: 1.8459 -> 0.7029   acc: 81.36% -> 72.03%             
-------------------------- TRAINING EPOCH: 100 --------------------------      
client [31] (test)  loss: 2.1899 -> 0.5317   acc: 13.33% -> 86.67%             
client [15] (test)  loss: 2.0576 -> 0.5992   acc: 66.28% -> 77.91%             
client [71] (test)  loss: 1.7903 -> 0.0933   acc: 89.43% -> 98.37%             
client [97] (test)  loss: 2.0604 -> 1.1461   acc: 28.30% -> 61.01%             
client [53] (test)  loss: 2.2210 -> 0.4348   acc: 31.88% -> 88.41%             
client [77] (test)  loss: 2.1752 -> 0.6575   acc: 15.65% -> 75.65%             
client [76] (test)  loss: 1.9522 -> 0.9509   acc: 55.56% -> 69.44%             
client [79] (test)  loss: 2.3801 -> 0.2442   acc: 1.01% -> 90.27%              
client [28] (test)  loss: 2.0125 -> 1.1526   acc: 32.00% -> 72.00%             
client [99] (test)  loss: 1.7044 -> 0.2498   acc: 90.62% -> 95.31%             
-------------------------- TRAINING EPOCH: 110 --------------------------      
client [97] (test)  loss: 2.0194 -> 1.1000   acc: 28.93% -> 61.64%             
client [86] (test)  loss: 2.0496 -> 0.4659   acc: 32.18% -> 85.06%             
client [34] (test)  loss: 2.1909 -> 0.9336   acc: 18.70% -> 70.73%             
client [73] (test)  loss: 1.9409 -> 0.9421   acc: 49.21% -> 58.73%             
client [5] (test)  loss: 1.9440 -> 1.0491   acc: 48.57% -> 62.86%              
client [96] (test)  loss: 2.0353 -> 0.3980   acc: 63.24% -> 91.18%             
client [22] (test)  loss: 2.1577 -> 1.0098   acc: 13.56% -> 69.49%             
client [60] (test)  loss: 2.2088 -> 0.7995   acc: 15.56% -> 73.33%             
client [66] (test)  loss: 1.8552 -> 1.2231   acc: 57.14% -> 48.57%             
client [83] (test)  loss: 1.6849 -> 0.0132   acc: 90.00% -> 100.00%            
-------------------------- TRAINING EPOCH: 120 --------------------------      
client [76] (test)  loss: 1.8563 -> 0.8674   acc: 63.89% -> 69.44%             
client [65] (test)  loss: 1.9144 -> 0.3860   acc: 68.33% -> 87.50%             
client [95] (test)  loss: 2.2945 -> 0.3863   acc: 5.95% -> 90.48%              
client [17] (test)  loss: 1.8606 -> 0.8157   acc: 57.45% -> 69.15%             
client [8] (test)  loss: 2.1704 -> 0.9364   acc: 15.07% -> 46.58%              
client [35] (test)  loss: 1.9313 -> 0.6444   acc: 35.71% -> 78.57%             
client [98] (test)  loss: 2.1984 -> 0.4530   acc: 37.84% -> 90.54%             
client [53] (test)  loss: 2.2056 -> 0.3720   acc: 31.88% -> 91.30%             
client [43] (test)  loss: 1.8131 -> 0.4529   acc: 80.00% -> 90.00%             
client [64] (test)  loss: 1.9621 -> 0.4522   acc: 49.12% -> 89.47%             
-------------------------- TRAINING EPOCH: 130 --------------------------      
client [21] (test)  loss: 2.3991 -> 1.5281   acc: 3.45% -> 41.38%              
client [88] (test)  loss: 2.0362 -> 1.1529   acc: 37.50% -> 63.54%             
client [38] (test)  loss: 2.0921 -> 0.1086   acc: 47.58% -> 99.19%             
client [3] (test)  loss: 2.2029 -> 0.2063   acc: 35.77% -> 94.31%              
client [5] (test)  loss: 1.9292 -> 0.9981   acc: 48.57% -> 62.86%              
client [41] (test)  loss: 2.0086 -> 0.4986   acc: 22.33% -> 85.44%             
client [7] (test)  loss: 2.1879 -> 1.0192   acc: 27.59% -> 62.07%              
client [37] (test)  loss: 1.7170 -> 0.2080   acc: 84.55% -> 95.22%             
client [45] (test)  loss: 1.9844 -> 0.4723   acc: 39.21% -> 84.14%             
client [47] (test)  loss: 2.1998 -> 0.3381   acc: 17.33% -> 89.33%             
-------------------------- TRAINING EPOCH: 140 --------------------------      
client [16] (test)  loss: 2.2439 -> 0.8784   acc: 5.41% -> 72.97%              
client [11] (test)  loss: 1.8162 -> 0.6482   acc: 74.47% -> 78.72%             
client [37] (test)  loss: 1.6859 -> 0.2048   acc: 84.27% -> 95.22%             
client [41] (test)  loss: 1.9838 -> 0.4888   acc: 25.24% -> 85.44%             
client [95] (test)  loss: 2.3013 -> 0.3655   acc: 9.52% -> 90.48%              
client [53] (test)  loss: 2.1620 -> 0.3347   acc: 31.88% -> 92.75%             
client [22] (test)  loss: 2.1295 -> 0.9473   acc: 18.64% -> 72.88%             
client [25] (test)  loss: 1.9669 -> 1.0377   acc: 39.08% -> 71.26%             
client [69] (test)  loss: 2.4010 -> 0.2132   acc: 0.77% -> 93.09%              
client [46] (test)  loss: 2.1603 -> 0.7675   acc: 16.46% -> 79.75%             
-------------------------- TRAINING EPOCH: 150 --------------------------      
client [47] (test)  loss: 2.0796 -> 0.3011   acc: 33.33% -> 92.00%             
client [69] (test)  loss: 2.3779 -> 0.2112   acc: 0.77% -> 93.35%              
client [82] (test)  loss: 2.2563 -> 0.0711   acc: 33.33% -> 98.85%             
client [45] (test)  loss: 1.8866 -> 0.4352   acc: 54.63% -> 85.02%             
client [7] (test)  loss: 2.1337 -> 0.9687   acc: 33.33% -> 64.37%              
client [50] (test)  loss: 2.3451 -> 0.5005   acc: 14.17% -> 92.50%             
client [35] (test)  loss: 1.7697 -> 0.4190   acc: 35.71% -> 96.43%             
client [24] (test)  loss: 1.6330 -> 0.3207   acc: 87.10% -> 91.13%             
client [15] (test)  loss: 2.0460 -> 0.5321   acc: 61.63% -> 79.07%             
client [58] (test)  loss: 2.1105 -> 0.2769   acc: 7.41% -> 96.30%              
-------------------------- TRAINING EPOCH: 160 --------------------------      
client [48] (test)  loss: 2.2710 -> 0.4044   acc: 17.95% -> 88.03%             
client [76] (test)  loss: 1.6815 -> 0.7318   acc: 63.89% -> 69.44%             
client [67] (test)  loss: 2.5858 -> 0.1903   acc: 0.00% -> 97.80%              
client [37] (test)  loss: 1.6078 -> 0.1991   acc: 85.11% -> 95.22%             
client [58] (test)  loss: 2.1000 -> 0.2760   acc: 11.11% -> 96.30%             
client [64] (test)  loss: 1.9102 -> 0.3693   acc: 45.61% -> 91.23%             
client [77] (test)  loss: 2.1792 -> 0.5881   acc: 16.52% -> 76.52%             
client [55] (test)  loss: 2.4317 -> 0.7560   acc: 20.41% -> 77.55%             
client [12] (test)  loss: 2.3753 -> 0.0093   acc: 29.01% -> 100.00%            
client [89] (test)  loss: 1.9016 -> 1.0015   acc: 43.86% -> 63.16%             
-------------------------- TRAINING EPOCH: 170 --------------------------      
client [84] (test)  loss: 1.7754 -> 1.2314   acc: 60.98% -> 65.85%             
client [51] (test)  loss: 2.4837 -> 0.3145   acc: 23.81% -> 95.24%             
client [8] (test)  loss: 2.1171 -> 0.9967   acc: 21.92% -> 46.58%              
client [18] (test)  loss: 2.1699 -> 0.7672   acc: 19.84% -> 61.11%             
client [94] (test)  loss: 2.1567 -> 0.7173   acc: 19.70% -> 72.35%             
client [81] (test)  loss: 2.0841 -> 1.3019   acc: 34.78% -> 39.13%             
client [3] (test)  loss: 2.1348 -> 0.1790   acc: 39.02% -> 94.31%              
client [11] (test)  loss: 1.7457 -> 0.6187   acc: 74.47% -> 82.98%             
client [95] (test)  loss: 2.3072 -> 0.3422   acc: 11.90% -> 90.48%             
client [67] (test)  loss: 2.5538 -> 0.1880   acc: 0.00% -> 97.80%              
-------------------------- TRAINING EPOCH: 180 --------------------------      
client [21] (test)  loss: 2.4196 -> 1.4113   acc: 3.45% -> 44.83%              
client [79] (test)  loss: 2.1294 -> 0.1992   acc: 18.12% -> 92.95%             
client [58] (test)  loss: 2.0809 -> 0.2754   acc: 22.22% -> 96.30%             
client [88] (test)  loss: 1.9262 -> 1.0419   acc: 42.71% -> 63.54%             
client [46] (test)  loss: 2.0512 -> 0.6908   acc: 25.32% -> 79.75%             
client [11] (test)  loss: 1.7265 -> 0.6111   acc: 70.21% -> 82.98%             
client [55] (test)  loss: 2.3567 -> 0.7224   acc: 22.45% -> 77.55%             
client [13] (test)  loss: 1.9639 -> 0.4287   acc: 51.06% -> 85.11%             
client [31] (test)  loss: 2.0967 -> 0.4309   acc: 15.56% -> 87.78%             
client [75] (test)  loss: 2.0191 -> 0.6214   acc: 32.99% -> 84.54%             
-------------------------- TRAINING EPOCH: 190 --------------------------      
client [19] (test)  loss: 1.7122 -> 0.9655   acc: 46.77% -> 69.35%             
client [7] (test)  loss: 2.0354 -> 0.8839   acc: 40.23% -> 66.67%              
client [57] (test)  loss: 1.6720 -> 0.4855   acc: 70.34% -> 86.44%             
client [13] (test)  loss: 1.9342 -> 0.4200   acc: 51.06% -> 85.11%             
client [43] (test)  loss: 1.7213 -> 0.4424   acc: 65.00% -> 90.00%             
client [91] (test)  loss: 1.7094 -> 1.3157   acc: 60.42% -> 41.67%             
client [10] (test)  loss: 1.8753 -> 0.5850   acc: 41.05% -> 83.16%             
client [64] (test)  loss: 1.8498 -> 0.3411   acc: 40.35% -> 91.23%             
client [82] (test)  loss: 2.2059 -> 0.0678   acc: 37.93% -> 98.85%             
client [22] (test)  loss: 2.0282 -> 0.8592   acc: 25.42% -> 72.88%             
-------------------------- TRAINING EPOCH: 200 --------------------------      
client [20] (test)  loss: 2.2086 -> 0.4271   acc: 6.09% -> 91.30%              
client [23] (test)  loss: 1.6064 -> 0.7370   acc: 51.85% -> 81.48%             
client [88] (test)  loss: 1.8772 -> 1.0064   acc: 42.71% -> 63.54%             
client [98] (test)  loss: 2.3057 -> 0.3316   acc: 18.92% -> 93.24%             
client [79] (test)  loss: 2.0760 -> 0.1896   acc: 23.49% -> 93.62%             
client [21] (test)  loss: 2.4060 -> 1.4056   acc: 10.34% -> 41.38%             
client [92] (test)  loss: 2.4525 -> 0.0048   acc: 20.80% -> 100.00%            
client [56] (test)  loss: 2.1137 -> 0.3329   acc: 20.93% -> 90.70%             
client [5] (test)  loss: 1.7826 -> 0.8675   acc: 51.43% -> 62.86%              
client [52] (test)  loss: 1.4216 -> 0.7091   acc: 58.97% -> 69.23%             
Training... ---------------------------------------- 100% 0:03:47
==================== pFedLA TEST RESULTS: ====================                 
{                                                                              
    100: {'loss': '0.5579 -> 0.0000', 'accuracy': '81.74% -> 0.00%'},          
    200: {'loss': '0.4299 -> 0.0000', 'accuracy': '85.55% -> 0.00%'}           
}                                                                              
Convergence (test_before):                                                     
pFedLA achieved 10.0%(11.82%) at epoch: 0                                      
pFedLA achieved 50.0%(51.78%) at epoch: 7                                      
pFedLA achieved 60.0%(61.99%) at epoch: 103                                    
Convergence (test_after):                                                      
pFedLA achieved 60.0%(64.43%) at epoch: 0                                      
pFedLA achieved 70.0%(75.06%) at epoch: 1                                      
pFedLA achieved 80.0%(82.45%) at epoch: 5                                      
pFedLA achieved 90.0%(90.08%) at epoch: 113                                    
'rm' 不是内部或外部命令，也不是可运行的程序
或批处理文件。
